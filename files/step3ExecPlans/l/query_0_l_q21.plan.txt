                                                                                                                                                                                                                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=305077.40..305092.66 rows=100 width=52) (actual time=828.277..829.414 rows=100 loops=1)
   ->  Finalize GroupAggregate  (cost=305077.40..305290.01 rows=1491 width=52) (actual time=828.276..829.407 rows=100 loops=1)
         Group Key: warehouse.w_warehouse_name, item.i_item_id
         Filter: (((CASE WHEN (sum(CASE WHEN (date_dim.d_date < '1998-03-07'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0) THEN (sum(CASE WHEN (date_dim.d_date >= '1998-03-07'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) / sum(CASE WHEN (date_dim.d_date < '1998-03-07'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END)) ELSE NULL::bigint END)::numeric >= 0.66666666666666666667) AND ((CASE WHEN (sum(CASE WHEN (date_dim.d_date < '1998-03-07'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0) THEN (sum(CASE WHEN (date_dim.d_date >= '1998-03-07'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) / sum(CASE WHEN (date_dim.d_date < '1998-03-07'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END)) ELSE NULL::bigint END)::numeric <= 1.5000000000000000))
         Rows Removed by Filter: 214
         ->  Remote Subquery Scan on all (dn1,dn2,dn3)  (cost=305077.40..305244.05 rows=1242 width=52) (actual time=828.259..829.059 rows=943 loops=1)
 Planning time: 0.529 ms
 Execution time: 836.335 ms
(8 rows)

