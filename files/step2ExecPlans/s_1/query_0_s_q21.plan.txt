                                                                                                                                                                                                                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=128810.86..128826.13 rows=100 width=51) (actual time=884.392..884.913 rows=100 loops=1)
   ->  Finalize GroupAggregate  (cost=128810.86..128887.21 rows=535 width=51) (actual time=884.390..884.895 rows=100 loops=1)
         Group Key: warehouse.w_warehouse_name, item.i_item_id
         Filter: (((CASE WHEN (sum(CASE WHEN (date_dim.d_date < '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0) THEN (sum(CASE WHEN (date_dim.d_date >= '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) / sum(CASE WHEN (date_dim.d_date < '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END)) ELSE NULL::bigint END)::numeric >= 0.66666666666666666667) AND ((CASE WHEN (sum(CASE WHEN (date_dim.d_date < '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0) THEN (sum(CASE WHEN (date_dim.d_date >= '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) / sum(CASE WHEN (date_dim.d_date < '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END)) ELSE NULL::bigint END)::numeric <= 1.5000000000000000))
         Rows Removed by Filter: 79
         ->  Remote Subquery Scan on all (dn1)  (cost=128810.86..128870.71 rows=446 width=51) (actual time=884.358..884.441 rows=180 loops=1)
 Planning time: 1.952 ms
 Execution time: 887.372 ms
(8 rows)

