                                                                                                                                                                                                                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1427560.25..1427575.51 rows=100 width=50) (actual time=2824.798..2827.718 rows=100 loops=1)
   ->  Finalize GroupAggregate  (cost=1427560.25..1428471.25 rows=6387 width=50) (actual time=2824.797..2827.697 rows=100 loops=1)
         Group Key: warehouse.w_warehouse_name, item.i_item_id
         Filter: (((CASE WHEN (sum(CASE WHEN (date_dim.d_date < '2002-05-26'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0) THEN (sum(CASE WHEN (date_dim.d_date >= '2002-05-26'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) / sum(CASE WHEN (date_dim.d_date < '2002-05-26'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END)) ELSE NULL::bigint END)::numeric >= 0.66666666666666666667) AND ((CASE WHEN (sum(CASE WHEN (date_dim.d_date < '2002-05-26'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0) THEN (sum(CASE WHEN (date_dim.d_date >= '2002-05-26'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) / sum(CASE WHEN (date_dim.d_date < '2002-05-26'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END)) ELSE NULL::bigint END)::numeric <= 1.5000000000000000))
         Rows Removed by Filter: 128
         ->  Remote Subquery Scan on all (dn1,dn2,dn3,dn4)  (cost=1427560.25..1428274.33 rows=5322 width=50) (actual time=2824.754..2826.980 rows=913 loops=1)
 Planning time: 0.616 ms
 Execution time: 2831.599 ms
(8 rows)

