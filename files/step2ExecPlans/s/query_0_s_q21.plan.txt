                                                                                                                                                                                                                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=126343.74..126359.01 rows=100 width=51) (actual time=887.387..887.912 rows=100 loops=1)
   ->  Finalize GroupAggregate  (cost=126343.74..126426.93 rows=583 width=51) (actual time=887.385..887.894 rows=100 loops=1)
         Group Key: warehouse.w_warehouse_name, item.i_item_id
         Filter: (((CASE WHEN (sum(CASE WHEN (date_dim.d_date < '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0) THEN (sum(CASE WHEN (date_dim.d_date >= '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) / sum(CASE WHEN (date_dim.d_date < '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END)) ELSE NULL::bigint END)::numeric >= 0.66666666666666666667) AND ((CASE WHEN (sum(CASE WHEN (date_dim.d_date < '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0) THEN (sum(CASE WHEN (date_dim.d_date >= '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END) / sum(CASE WHEN (date_dim.d_date < '1999-06-22'::date) THEN inventory.inv_quantity_on_hand ELSE 0 END)) ELSE NULL::bigint END)::numeric <= 1.5000000000000000))
         Rows Removed by Filter: 79
         ->  Remote Subquery Scan on all (dn1)  (cost=126343.74..126408.95 rows=486 width=51) (actual time=887.354..887.439 rows=180 loops=1)
 Planning time: 2.049 ms
 Execution time: 890.097 ms
(8 rows)

