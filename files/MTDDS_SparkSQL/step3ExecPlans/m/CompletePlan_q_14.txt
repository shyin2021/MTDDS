== Parsed Logical Plan ==
CTE [cross_items, avg_sales]
:  :- 'SubqueryAlias cross_items
:  :  +- 'Project ['i_item_sk AS ss_item_sk#17378]
:  :     +- 'Filter ((('i_brand_id = 'brand_id) AND ('i_class_id = 'class_id)) AND ('i_category_id = 'category_id))
:  :        +- 'Join Inner
:  :           :- 'UnresolvedRelation [item], [], false
:  :           +- 'SubqueryAlias x
:  :              +- 'Intersect false
:  :                 :- 'Intersect false
:  :                 :  :- 'Project ['iss.i_brand_id AS brand_id#17375, 'iss.i_class_id AS class_id#17376, 'iss.i_category_id AS category_id#17377]
:  :                 :  :  +- 'Filter ((('ss_item_sk = 'iss.i_item_sk) AND ('ss_sold_date_sk = 'd1.d_date_sk)) AND (('d1.d_year >= 1998) AND ('d1.d_year <= (1998 + 2))))
:  :                 :  :     +- 'Join Inner
:  :                 :  :        :- 'Join Inner
:  :                 :  :        :  :- 'UnresolvedRelation [store_sales], [], false
:  :                 :  :        :  +- 'SubqueryAlias iss
:  :                 :  :        :     +- 'UnresolvedRelation [item], [], false
:  :                 :  :        +- 'SubqueryAlias d1
:  :                 :  :           +- 'UnresolvedRelation [date_dim], [], false
:  :                 :  +- 'Project ['ics.i_brand_id, 'ics.i_class_id, 'ics.i_category_id]
:  :                 :     +- 'Filter ((('cs_item_sk = 'ics.i_item_sk) AND ('cs_sold_date_sk = 'd2.d_date_sk)) AND (('d2.d_year >= 1998) AND ('d2.d_year <= (1998 + 2))))
:  :                 :        +- 'Join Inner
:  :                 :           :- 'Join Inner
:  :                 :           :  :- 'UnresolvedRelation [catalog_sales], [], false
:  :                 :           :  +- 'SubqueryAlias ics
:  :                 :           :     +- 'UnresolvedRelation [item], [], false
:  :                 :           +- 'SubqueryAlias d2
:  :                 :              +- 'UnresolvedRelation [date_dim], [], false
:  :                 +- 'Project ['iws.i_brand_id, 'iws.i_class_id, 'iws.i_category_id]
:  :                    +- 'Filter ((('ws_item_sk = 'iws.i_item_sk) AND ('ws_sold_date_sk = 'd3.d_date_sk)) AND (('d3.d_year >= 1998) AND ('d3.d_year <= (1998 + 2))))
:  :                       +- 'Join Inner
:  :                          :- 'Join Inner
:  :                          :  :- 'UnresolvedRelation [web_sales], [], false
:  :                          :  +- 'SubqueryAlias iws
:  :                          :     +- 'UnresolvedRelation [item], [], false
:  :                          +- 'SubqueryAlias d3
:  :                             +- 'UnresolvedRelation [date_dim], [], false
:  +- 'SubqueryAlias avg_sales
:     +- 'Project ['avg(('quantity * 'list_price)) AS average_sales#17385]
:        +- 'SubqueryAlias x
:           +- 'Union false, false
:              :- 'Union false, false
:              :  :- 'Project ['ss_quantity AS quantity#17379, 'ss_list_price AS list_price#17380]
:              :  :  +- 'Filter (('ss_sold_date_sk = 'd_date_sk) AND (('d_year >= 1998) AND ('d_year <= (1998 + 2))))
:              :  :     +- 'Join Inner
:              :  :        :- 'UnresolvedRelation [store_sales], [], false
:              :  :        +- 'UnresolvedRelation [date_dim], [], false
:              :  +- 'Project ['cs_quantity AS quantity#17381, 'cs_list_price AS list_price#17382]
:              :     +- 'Filter (('cs_sold_date_sk = 'd_date_sk) AND (('d_year >= 1998) AND ('d_year <= (1998 + 2))))
:              :        +- 'Join Inner
:              :           :- 'UnresolvedRelation [catalog_sales], [], false
:              :           +- 'UnresolvedRelation [date_dim], [], false
:              +- 'Project ['ws_quantity AS quantity#17383, 'ws_list_price AS list_price#17384]
:                 +- 'Filter (('ws_sold_date_sk = 'd_date_sk) AND (('d_year >= 1998) AND ('d_year <= (1998 + 2))))
:                    +- 'Join Inner
:                       :- 'UnresolvedRelation [web_sales], [], false
:                       +- 'UnresolvedRelation [date_dim], [], false
+- 'GlobalLimit 100
   +- 'LocalLimit 100
      +- 'Sort ['this_year.channel ASC NULLS FIRST, 'this_year.i_brand_id ASC NULLS FIRST, 'this_year.i_class_id ASC NULLS FIRST, 'this_year.i_category_id ASC NULLS FIRST], true
         +- 'Project ['this_year.channel AS ty_channel#17363, 'this_year.i_brand_id AS ty_brand#17364, 'this_year.i_class_id AS ty_class#17365, 'this_year.i_category_id AS ty_category#17366, 'this_year.sales AS ty_sales#17367, 'this_year.number_sales AS ty_number_sales#17368, 'last_year.channel AS ly_channel#17369, 'last_year.i_brand_id AS ly_brand#17370, 'last_year.i_class_id AS ly_class#17371, 'last_year.i_category_id AS ly_category#17372, 'last_year.sales AS ly_sales#17373, 'last_year.number_sales AS ly_number_sales#17374]
            +- 'Filter ((('this_year.i_brand_id = 'last_year.i_brand_id) AND ('this_year.i_class_id = 'last_year.i_class_id)) AND ('this_year.i_category_id = 'last_year.i_category_id))
               +- 'Join Inner
                  :- 'SubqueryAlias this_year
                  :  +- 'UnresolvedHaving ('sum(('ss_quantity * 'ss_list_price)) > scalar-subquery#17356 [])
                  :     :  +- 'Project ['average_sales]
                  :     :     +- 'UnresolvedRelation [avg_sales], [], false
                  :     +- 'Aggregate ['i_brand_id, 'i_class_id, 'i_category_id], [store AS channel#17351, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum(('ss_quantity * 'ss_list_price)) AS sales#17352, 'count(1) AS number_sales#17353]
                  :        +- 'Filter (('ss_item_sk IN (list#17354 []) AND ('ss_item_sk = 'i_item_sk)) AND (('ss_sold_date_sk = 'd_date_sk) AND ('d_week_seq = scalar-subquery#17355 [])))
                  :           :  :- 'Project ['ss_item_sk]
                  :           :  :  +- 'UnresolvedRelation [cross_items], [], false
                  :           :  +- 'Project ['d_week_seq]
                  :           :     +- 'Filter ((('d_year = (1998 + 1)) AND ('d_moy = 12)) AND ('d_dom = 20))
                  :           :        +- 'UnresolvedRelation [date_dim], [], false
                  :           +- 'Join Inner
                  :              :- 'Join Inner
                  :              :  :- 'UnresolvedRelation [store_sales], [], false
                  :              :  +- 'UnresolvedRelation [item], [], false
                  :              +- 'UnresolvedRelation [date_dim], [], false
                  +- 'SubqueryAlias last_year
                     +- 'UnresolvedHaving ('sum(('ss_quantity * 'ss_list_price)) > scalar-subquery#17362 [])
                        :  +- 'Project ['average_sales]
                        :     +- 'UnresolvedRelation [avg_sales], [], false
                        +- 'Aggregate ['i_brand_id, 'i_class_id, 'i_category_id], [store AS channel#17357, 'i_brand_id, 'i_class_id, 'i_category_id, 'sum(('ss_quantity * 'ss_list_price)) AS sales#17358, 'count(1) AS number_sales#17359]
                           +- 'Filter (('ss_item_sk IN (list#17360 []) AND ('ss_item_sk = 'i_item_sk)) AND (('ss_sold_date_sk = 'd_date_sk) AND ('d_week_seq = scalar-subquery#17361 [])))
                              :  :- 'Project ['ss_item_sk]
                              :  :  +- 'UnresolvedRelation [cross_items], [], false
                              :  +- 'Project ['d_week_seq]
                              :     +- 'Filter ((('d_year = 1998) AND ('d_moy = 12)) AND ('d_dom = 20))
                              :        +- 'UnresolvedRelation [date_dim], [], false
                              +- 'Join Inner
                                 :- 'Join Inner
                                 :  :- 'UnresolvedRelation [store_sales], [], false
                                 :  +- 'UnresolvedRelation [item], [], false
                                 +- 'UnresolvedRelation [date_dim], [], false

== Analyzed Logical Plan ==
ty_channel: string, ty_brand: int, ty_class: int, ty_category: int, ty_sales: double, ty_number_sales: bigint, ly_channel: string, ly_brand: int, ly_class: int, ly_category: int, ly_sales: double, ly_number_sales: bigint
WithCTE
:- CTERelationDef 20, false
:  +- SubqueryAlias cross_items
:     +- Project [i_item_sk#1271 AS ss_item_sk#17378]
:        +- Filter (((i_brand_id#1278 = brand_id#17375) AND (i_class_id#1280 = class_id#17376)) AND (i_category_id#1282 = category_id#17377))
:           +- Join Inner
:              :- SubqueryAlias spark_catalog.m.item
:              :  +- Relation spark_catalog.m.item[i_item_sk#1271,i_item_id#1272,i_rec_start_date#1273,i_rec_end_date#1274,i_item_desc#1275,i_current_price#1276,i_wholesale_cost#1277,i_brand_id#1278,i_brand#1279,i_class_id#1280,i_class#1281,i_category_id#1282,i_category#1283,i_manufact_id#1284,i_manufact#1285,i_size#1286,i_formulation#1287,i_color#1288,i_units#1289,i_container#1290,i_manager_id#1291,i_product_name#1292] parquet
:              +- SubqueryAlias x
:                 +- Intersect false
:                    :- Intersect false
:                    :  :- Project [i_brand_id#17395 AS brand_id#17375, i_class_id#17397 AS class_id#17376, i_category_id#17399 AS category_id#17377]
:                    :  :  +- Filter (((ss_item_sk#1250 = i_item_sk#17388) AND (ss_sold_date_sk#1248 = d_date_sk#24)) AND ((d_year#30 >= 1998) AND (d_year#30 <= (1998 + 2))))
:                    :  :     +- Join Inner
:                    :  :        :- Join Inner
:                    :  :        :  :- SubqueryAlias spark_catalog.m.store_sales
:                    :  :        :  :  +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#1248,ss_sold_time_sk#1249,ss_item_sk#1250,ss_customer_sk#1251,ss_cdemo_sk#1252,ss_hdemo_sk#1253,ss_addr_sk#1254,ss_store_sk#1255,ss_promo_sk#1256,ss_ticket_number#1257,ss_quantity#1258,ss_wholesale_cost#1259,ss_list_price#1260,ss_sales_price#1261,ss_ext_discount_amt#1262,ss_ext_sales_price#1263,ss_ext_wholesale_cost#1264,ss_ext_list_price#1265,ss_ext_tax#1266,ss_coupon_amt#1267,ss_net_paid#1268,ss_net_paid_inc_tax#1269,ss_net_profit#1270] parquet
:                    :  :        :  +- SubqueryAlias iss
:                    :  :        :     +- SubqueryAlias spark_catalog.m.item
:                    :  :        :        +- Relation spark_catalog.m.item[i_item_sk#17388,i_item_id#17389,i_rec_start_date#17390,i_rec_end_date#17391,i_item_desc#17392,i_current_price#17393,i_wholesale_cost#17394,i_brand_id#17395,i_brand#17396,i_class_id#17397,i_class#17398,i_category_id#17399,i_category#17400,i_manufact_id#17401,i_manufact#17402,i_size#17403,i_formulation#17404,i_color#17405,i_units#17406,i_container#17407,i_manager_id#17408,i_product_name#17409] parquet
:                    :  :        +- SubqueryAlias d1
:                    :  :           +- SubqueryAlias spark_catalog.m.date_dim
:                    :  :              +- Relation spark_catalog.m.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
:                    :  +- Project [i_brand_id#17417, i_class_id#17419, i_category_id#17421]
:                    :     +- Filter (((cs_item_sk#476 = i_item_sk#17410) AND (cs_sold_date_sk#461 = d_date_sk#17432)) AND ((d_year#17438 >= 1998) AND (d_year#17438 <= (1998 + 2))))
:                    :        +- Join Inner
:                    :           :- Join Inner
:                    :           :  :- SubqueryAlias spark_catalog.m.catalog_sales
:                    :           :  :  +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#461,cs_sold_time_sk#462,cs_ship_date_sk#463,cs_bill_customer_sk#464,cs_bill_cdemo_sk#465,cs_bill_hdemo_sk#466,cs_bill_addr_sk#467,cs_ship_customer_sk#468,cs_ship_cdemo_sk#469,cs_ship_hdemo_sk#470,cs_ship_addr_sk#471,cs_call_center_sk#472,cs_catalog_page_sk#473,cs_ship_mode_sk#474,cs_warehouse_sk#475,cs_item_sk#476,cs_promo_sk#477,cs_order_number#478,cs_quantity#479,cs_wholesale_cost#480,cs_list_price#481,cs_sales_price#482,cs_ext_discount_amt#483,cs_ext_sales_price#484,... 10 more fields] parquet
:                    :           :  +- SubqueryAlias ics
:                    :           :     +- SubqueryAlias spark_catalog.m.item
:                    :           :        +- Relation spark_catalog.m.item[i_item_sk#17410,i_item_id#17411,i_rec_start_date#17412,i_rec_end_date#17413,i_item_desc#17414,i_current_price#17415,i_wholesale_cost#17416,i_brand_id#17417,i_brand#17418,i_class_id#17419,i_class#17420,i_category_id#17421,i_category#17422,i_manufact_id#17423,i_manufact#17424,i_size#17425,i_formulation#17426,i_color#17427,i_units#17428,i_container#17429,i_manager_id#17430,i_product_name#17431] parquet
:                    :           +- SubqueryAlias d2
:                    :              +- SubqueryAlias spark_catalog.m.date_dim
:                    :                 +- Relation spark_catalog.m.date_dim[d_date_sk#17432,d_date_id#17433,d_date#17434,d_month_seq#17435,d_week_seq#17436,d_quarter_seq#17437,d_year#17438,d_dow#17439,d_moy#17440,d_dom#17441,d_qoy#17442,d_fy_year#17443,d_fy_quarter_seq#17444,d_fy_week_seq#17445,d_day_name#17446,d_quarter_name#17447,d_holiday#17448,d_weekend#17449,d_following_holiday#17450,d_first_dom#17451,d_last_dom#17452,d_same_day_ly#17453,d_same_day_lq#17454,d_current_day#17455,... 4 more fields] parquet
:                    +- Project [i_brand_id#17467, i_class_id#17469, i_category_id#17471]
:                       +- Filter (((ws_item_sk#430 = i_item_sk#17460) AND (ws_sold_date_sk#427 = d_date_sk#17482)) AND ((d_year#17488 >= 1998) AND (d_year#17488 <= (1998 + 2))))
:                          +- Join Inner
:                             :- Join Inner
:                             :  :- SubqueryAlias spark_catalog.m.web_sales
:                             :  :  +- Relation spark_catalog.m.web_sales[ws_sold_date_sk#427,ws_sold_time_sk#428,ws_ship_date_sk#429,ws_item_sk#430,ws_bill_customer_sk#431,ws_bill_cdemo_sk#432,ws_bill_hdemo_sk#433,ws_bill_addr_sk#434,ws_ship_customer_sk#435,ws_ship_cdemo_sk#436,ws_ship_hdemo_sk#437,ws_ship_addr_sk#438,ws_web_page_sk#439,ws_web_site_sk#440,ws_ship_mode_sk#441,ws_warehouse_sk#442,ws_promo_sk#443,ws_order_number#444,ws_quantity#445,ws_wholesale_cost#446,ws_list_price#447,ws_sales_price#448,ws_ext_discount_amt#449,ws_ext_sales_price#450,... 10 more fields] parquet
:                             :  +- SubqueryAlias iws
:                             :     +- SubqueryAlias spark_catalog.m.item
:                             :        +- Relation spark_catalog.m.item[i_item_sk#17460,i_item_id#17461,i_rec_start_date#17462,i_rec_end_date#17463,i_item_desc#17464,i_current_price#17465,i_wholesale_cost#17466,i_brand_id#17467,i_brand#17468,i_class_id#17469,i_class#17470,i_category_id#17471,i_category#17472,i_manufact_id#17473,i_manufact#17474,i_size#17475,i_formulation#17476,i_color#17477,i_units#17478,i_container#17479,i_manager_id#17480,i_product_name#17481] parquet
:                             +- SubqueryAlias d3
:                                +- SubqueryAlias spark_catalog.m.date_dim
:                                   +- Relation spark_catalog.m.date_dim[d_date_sk#17482,d_date_id#17483,d_date#17484,d_month_seq#17485,d_week_seq#17486,d_quarter_seq#17487,d_year#17488,d_dow#17489,d_moy#17490,d_dom#17491,d_qoy#17492,d_fy_year#17493,d_fy_quarter_seq#17494,d_fy_week_seq#17495,d_day_name#17496,d_quarter_name#17497,d_holiday#17498,d_weekend#17499,d_following_holiday#17500,d_first_dom#17501,d_last_dom#17502,d_same_day_ly#17503,d_same_day_lq#17504,d_current_day#17505,... 4 more fields] parquet
:- CTERelationDef 21, false
:  +- SubqueryAlias avg_sales
:     +- Aggregate [avg((cast(quantity#17379 as double) * list_price#17380)) AS average_sales#17385]
:        +- SubqueryAlias x
:           +- Union false, false
:              :- Union false, false
:              :  :- Project [ss_quantity#17520 AS quantity#17379, ss_list_price#17522 AS list_price#17380]
:              :  :  +- Filter ((ss_sold_date_sk#17510 = d_date_sk#17533) AND ((d_year#17539 >= 1998) AND (d_year#17539 <= (1998 + 2))))
:              :  :     +- Join Inner
:              :  :        :- SubqueryAlias spark_catalog.m.store_sales
:              :  :        :  +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#17510,ss_sold_time_sk#17511,ss_item_sk#17512,ss_customer_sk#17513,ss_cdemo_sk#17514,ss_hdemo_sk#17515,ss_addr_sk#17516,ss_store_sk#17517,ss_promo_sk#17518,ss_ticket_number#17519,ss_quantity#17520,ss_wholesale_cost#17521,ss_list_price#17522,ss_sales_price#17523,ss_ext_discount_amt#17524,ss_ext_sales_price#17525,ss_ext_wholesale_cost#17526,ss_ext_list_price#17527,ss_ext_tax#17528,ss_coupon_amt#17529,ss_net_paid#17530,ss_net_paid_inc_tax#17531,ss_net_profit#17532] parquet
:              :  :        +- SubqueryAlias spark_catalog.m.date_dim
:              :  :           +- Relation spark_catalog.m.date_dim[d_date_sk#17533,d_date_id#17534,d_date#17535,d_month_seq#17536,d_week_seq#17537,d_quarter_seq#17538,d_year#17539,d_dow#17540,d_moy#17541,d_dom#17542,d_qoy#17543,d_fy_year#17544,d_fy_quarter_seq#17545,d_fy_week_seq#17546,d_day_name#17547,d_quarter_name#17548,d_holiday#17549,d_weekend#17550,d_following_holiday#17551,d_first_dom#17552,d_last_dom#17553,d_same_day_ly#17554,d_same_day_lq#17555,d_current_day#17556,... 4 more fields] parquet
:              :  +- Project [cs_quantity#17579 AS quantity#17381, cs_list_price#17581 AS list_price#17382]
:              :     +- Filter ((cs_sold_date_sk#17561 = d_date_sk#17595) AND ((d_year#17601 >= 1998) AND (d_year#17601 <= (1998 + 2))))
:              :        +- Join Inner
:              :           :- SubqueryAlias spark_catalog.m.catalog_sales
:              :           :  +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#17561,cs_sold_time_sk#17562,cs_ship_date_sk#17563,cs_bill_customer_sk#17564,cs_bill_cdemo_sk#17565,cs_bill_hdemo_sk#17566,cs_bill_addr_sk#17567,cs_ship_customer_sk#17568,cs_ship_cdemo_sk#17569,cs_ship_hdemo_sk#17570,cs_ship_addr_sk#17571,cs_call_center_sk#17572,cs_catalog_page_sk#17573,cs_ship_mode_sk#17574,cs_warehouse_sk#17575,cs_item_sk#17576,cs_promo_sk#17577,cs_order_number#17578,cs_quantity#17579,cs_wholesale_cost#17580,cs_list_price#17581,cs_sales_price#17582,cs_ext_discount_amt#17583,cs_ext_sales_price#17584,... 10 more fields] parquet
:              :           +- SubqueryAlias spark_catalog.m.date_dim
:              :              +- Relation spark_catalog.m.date_dim[d_date_sk#17595,d_date_id#17596,d_date#17597,d_month_seq#17598,d_week_seq#17599,d_quarter_seq#17600,d_year#17601,d_dow#17602,d_moy#17603,d_dom#17604,d_qoy#17605,d_fy_year#17606,d_fy_quarter_seq#17607,d_fy_week_seq#17608,d_day_name#17609,d_quarter_name#17610,d_holiday#17611,d_weekend#17612,d_following_holiday#17613,d_first_dom#17614,d_last_dom#17615,d_same_day_ly#17616,d_same_day_lq#17617,d_current_day#17618,... 4 more fields] parquet
:              +- Project [ws_quantity#17641 AS quantity#17383, ws_list_price#17643 AS list_price#17384]
:                 +- Filter ((ws_sold_date_sk#17623 = d_date_sk#17657) AND ((d_year#17663 >= 1998) AND (d_year#17663 <= (1998 + 2))))
:                    +- Join Inner
:                       :- SubqueryAlias spark_catalog.m.web_sales
:                       :  +- Relation spark_catalog.m.web_sales[ws_sold_date_sk#17623,ws_sold_time_sk#17624,ws_ship_date_sk#17625,ws_item_sk#17626,ws_bill_customer_sk#17627,ws_bill_cdemo_sk#17628,ws_bill_hdemo_sk#17629,ws_bill_addr_sk#17630,ws_ship_customer_sk#17631,ws_ship_cdemo_sk#17632,ws_ship_hdemo_sk#17633,ws_ship_addr_sk#17634,ws_web_page_sk#17635,ws_web_site_sk#17636,ws_ship_mode_sk#17637,ws_warehouse_sk#17638,ws_promo_sk#17639,ws_order_number#17640,ws_quantity#17641,ws_wholesale_cost#17642,ws_list_price#17643,ws_sales_price#17644,ws_ext_discount_amt#17645,ws_ext_sales_price#17646,... 10 more fields] parquet
:                       +- SubqueryAlias spark_catalog.m.date_dim
:                          +- Relation spark_catalog.m.date_dim[d_date_sk#17657,d_date_id#17658,d_date#17659,d_month_seq#17660,d_week_seq#17661,d_quarter_seq#17662,d_year#17663,d_dow#17664,d_moy#17665,d_dom#17666,d_qoy#17667,d_fy_year#17668,d_fy_quarter_seq#17669,d_fy_week_seq#17670,d_day_name#17671,d_quarter_name#17672,d_holiday#17673,d_weekend#17674,d_following_holiday#17675,d_first_dom#17676,d_last_dom#17677,d_same_day_ly#17678,d_same_day_lq#17679,d_current_day#17680,... 4 more fields] parquet
+- GlobalLimit 100
   +- LocalLimit 100
      +- Project [ty_channel#17363, ty_brand#17364, ty_class#17365, ty_category#17366, ty_sales#17367, ty_number_sales#17368L, ly_channel#17369, ly_brand#17370, ly_class#17371, ly_category#17372, ly_sales#17373, ly_number_sales#17374L]
         +- Sort [channel#17351 ASC NULLS FIRST, i_brand_id#17715 ASC NULLS FIRST, i_class_id#17717 ASC NULLS FIRST, i_category_id#17719 ASC NULLS FIRST], true
            +- Project [channel#17351 AS ty_channel#17363, i_brand_id#17715 AS ty_brand#17364, i_class_id#17717 AS ty_class#17365, i_category_id#17719 AS ty_category#17366, sales#17352 AS ty_sales#17367, number_sales#17353L AS ty_number_sales#17368L, channel#17357 AS ly_channel#17369, i_brand_id#17788 AS ly_brand#17370, i_class_id#17790 AS ly_class#17371, i_category_id#17792 AS ly_category#17372, sales#17358 AS ly_sales#17373, number_sales#17359L AS ly_number_sales#17374L, channel#17351, i_brand_id#17715, i_class_id#17717, i_category_id#17719]
               +- Filter (((i_brand_id#17715 = i_brand_id#17788) AND (i_class_id#17717 = i_class_id#17790)) AND (i_category_id#17719 = i_category_id#17792))
                  +- Join Inner
                     :- SubqueryAlias this_year
                     :  +- Filter (sales#17352 > scalar-subquery#17356 [])
                     :     :  +- Project [average_sales#17385]
                     :     :     +- SubqueryAlias avg_sales
                     :     :        +- CTERelationRef 21, true, [average_sales#17385], false
                     :     +- Aggregate [i_brand_id#17715, i_class_id#17717, i_category_id#17719], [store AS channel#17351, i_brand_id#17715, i_class_id#17717, i_category_id#17719, sum((cast(ss_quantity#17695 as double) * ss_list_price#17697)) AS sales#17352, count(1) AS number_sales#17353L]
                     :        +- Filter ((ss_item_sk#17687 IN (list#17354 []) AND (ss_item_sk#17687 = i_item_sk#17708)) AND ((ss_sold_date_sk#17685 = d_date_sk#17730) AND (d_week_seq#17734 = scalar-subquery#17355 [])))
                     :           :  :- Project [ss_item_sk#17378]
                     :           :  :  +- SubqueryAlias cross_items
                     :           :  :     +- CTERelationRef 20, true, [ss_item_sk#17378], false
                     :           :  +- Project [d_week_seq#17846]
                     :           :     +- Filter (((d_year#17848 = (1998 + 1)) AND (d_moy#17850 = 12)) AND (d_dom#17851 = 20))
                     :           :        +- SubqueryAlias spark_catalog.m.date_dim
                     :           :           +- Relation spark_catalog.m.date_dim[d_date_sk#17842,d_date_id#17843,d_date#17844,d_month_seq#17845,d_week_seq#17846,d_quarter_seq#17847,d_year#17848,d_dow#17849,d_moy#17850,d_dom#17851,d_qoy#17852,d_fy_year#17853,d_fy_quarter_seq#17854,d_fy_week_seq#17855,d_day_name#17856,d_quarter_name#17857,d_holiday#17858,d_weekend#17859,d_following_holiday#17860,d_first_dom#17861,d_last_dom#17862,d_same_day_ly#17863,d_same_day_lq#17864,d_current_day#17865,... 4 more fields] parquet
                     :           +- Join Inner
                     :              :- Join Inner
                     :              :  :- SubqueryAlias spark_catalog.m.store_sales
                     :              :  :  +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#17685,ss_sold_time_sk#17686,ss_item_sk#17687,ss_customer_sk#17688,ss_cdemo_sk#17689,ss_hdemo_sk#17690,ss_addr_sk#17691,ss_store_sk#17692,ss_promo_sk#17693,ss_ticket_number#17694,ss_quantity#17695,ss_wholesale_cost#17696,ss_list_price#17697,ss_sales_price#17698,ss_ext_discount_amt#17699,ss_ext_sales_price#17700,ss_ext_wholesale_cost#17701,ss_ext_list_price#17702,ss_ext_tax#17703,ss_coupon_amt#17704,ss_net_paid#17705,ss_net_paid_inc_tax#17706,ss_net_profit#17707] parquet
                     :              :  +- SubqueryAlias spark_catalog.m.item
                     :              :     +- Relation spark_catalog.m.item[i_item_sk#17708,i_item_id#17709,i_rec_start_date#17710,i_rec_end_date#17711,i_item_desc#17712,i_current_price#17713,i_wholesale_cost#17714,i_brand_id#17715,i_brand#17716,i_class_id#17717,i_class#17718,i_category_id#17719,i_category#17720,i_manufact_id#17721,i_manufact#17722,i_size#17723,i_formulation#17724,i_color#17725,i_units#17726,i_container#17727,i_manager_id#17728,i_product_name#17729] parquet
                     :              +- SubqueryAlias spark_catalog.m.date_dim
                     :                 +- Relation spark_catalog.m.date_dim[d_date_sk#17730,d_date_id#17731,d_date#17732,d_month_seq#17733,d_week_seq#17734,d_quarter_seq#17735,d_year#17736,d_dow#17737,d_moy#17738,d_dom#17739,d_qoy#17740,d_fy_year#17741,d_fy_quarter_seq#17742,d_fy_week_seq#17743,d_day_name#17744,d_quarter_name#17745,d_holiday#17746,d_weekend#17747,d_following_holiday#17748,d_first_dom#17749,d_last_dom#17750,d_same_day_ly#17751,d_same_day_lq#17752,d_current_day#17753,... 4 more fields] parquet
                     +- SubqueryAlias last_year
                        +- Filter (sales#17358 > scalar-subquery#17362 [])
                           :  +- Project [average_sales#17906]
                           :     +- SubqueryAlias avg_sales
                           :        +- CTERelationRef 21, true, [average_sales#17906], false
                           +- Aggregate [i_brand_id#17788, i_class_id#17790, i_category_id#17792], [store AS channel#17357, i_brand_id#17788, i_class_id#17790, i_category_id#17792, sum((cast(ss_quantity#17768 as double) * ss_list_price#17770)) AS sales#17358, count(1) AS number_sales#17359L]
                              +- Filter ((ss_item_sk#17760 IN (list#17360 []) AND (ss_item_sk#17760 = i_item_sk#17781)) AND ((ss_sold_date_sk#17758 = d_date_sk#17803) AND (d_week_seq#17807 = scalar-subquery#17361 [])))
                                 :  :- Project [ss_item_sk#17870]
                                 :  :  +- SubqueryAlias cross_items
                                 :  :     +- CTERelationRef 20, true, [ss_item_sk#17870], false
                                 :  +- Project [d_week_seq#17875]
                                 :     +- Filter (((d_year#17877 = 1998) AND (d_moy#17879 = 12)) AND (d_dom#17880 = 20))
                                 :        +- SubqueryAlias spark_catalog.m.date_dim
                                 :           +- Relation spark_catalog.m.date_dim[d_date_sk#17871,d_date_id#17872,d_date#17873,d_month_seq#17874,d_week_seq#17875,d_quarter_seq#17876,d_year#17877,d_dow#17878,d_moy#17879,d_dom#17880,d_qoy#17881,d_fy_year#17882,d_fy_quarter_seq#17883,d_fy_week_seq#17884,d_day_name#17885,d_quarter_name#17886,d_holiday#17887,d_weekend#17888,d_following_holiday#17889,d_first_dom#17890,d_last_dom#17891,d_same_day_ly#17892,d_same_day_lq#17893,d_current_day#17894,... 4 more fields] parquet
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias spark_catalog.m.store_sales
                                    :  :  +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#17758,ss_sold_time_sk#17759,ss_item_sk#17760,ss_customer_sk#17761,ss_cdemo_sk#17762,ss_hdemo_sk#17763,ss_addr_sk#17764,ss_store_sk#17765,ss_promo_sk#17766,ss_ticket_number#17767,ss_quantity#17768,ss_wholesale_cost#17769,ss_list_price#17770,ss_sales_price#17771,ss_ext_discount_amt#17772,ss_ext_sales_price#17773,ss_ext_wholesale_cost#17774,ss_ext_list_price#17775,ss_ext_tax#17776,ss_coupon_amt#17777,ss_net_paid#17778,ss_net_paid_inc_tax#17779,ss_net_profit#17780] parquet
                                    :  +- SubqueryAlias spark_catalog.m.item
                                    :     +- Relation spark_catalog.m.item[i_item_sk#17781,i_item_id#17782,i_rec_start_date#17783,i_rec_end_date#17784,i_item_desc#17785,i_current_price#17786,i_wholesale_cost#17787,i_brand_id#17788,i_brand#17789,i_class_id#17790,i_class#17791,i_category_id#17792,i_category#17793,i_manufact_id#17794,i_manufact#17795,i_size#17796,i_formulation#17797,i_color#17798,i_units#17799,i_container#17800,i_manager_id#17801,i_product_name#17802] parquet
                                    +- SubqueryAlias spark_catalog.m.date_dim
                                       +- Relation spark_catalog.m.date_dim[d_date_sk#17803,d_date_id#17804,d_date#17805,d_month_seq#17806,d_week_seq#17807,d_quarter_seq#17808,d_year#17809,d_dow#17810,d_moy#17811,d_dom#17812,d_qoy#17813,d_fy_year#17814,d_fy_quarter_seq#17815,d_fy_week_seq#17816,d_day_name#17817,d_quarter_name#17818,d_holiday#17819,d_weekend#17820,d_following_holiday#17821,d_first_dom#17822,d_last_dom#17823,d_same_day_ly#17824,d_same_day_lq#17825,d_current_day#17826,... 4 more fields] parquet

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [store AS ty_channel#17363, ty_brand#17364, ty_class#17365, ty_category#17366, ty_sales#17367, ty_number_sales#17368L, store AS ly_channel#17369, ly_brand#17370, ly_class#17371, ly_category#17372, ly_sales#17373, ly_number_sales#17374L]
      +- Sort [i_brand_id#17715 ASC NULLS FIRST, i_class_id#17717 ASC NULLS FIRST, i_category_id#17719 ASC NULLS FIRST], true
         +- Project [i_brand_id#17715 AS ty_brand#17364, i_class_id#17717 AS ty_class#17365, i_category_id#17719 AS ty_category#17366, sales#17352 AS ty_sales#17367, number_sales#17353L AS ty_number_sales#17368L, i_brand_id#17788 AS ly_brand#17370, i_class_id#17790 AS ly_class#17371, i_category_id#17792 AS ly_category#17372, sales#17358 AS ly_sales#17373, number_sales#17359L AS ly_number_sales#17374L, i_brand_id#17715, i_class_id#17717, i_category_id#17719]
            +- Join Inner, (((i_brand_id#17715 = i_brand_id#17788) AND (i_class_id#17717 = i_class_id#17790)) AND (i_category_id#17719 = i_category_id#17792))
               :- Filter (isnotnull(sales#17352) AND (sales#17352 > scalar-subquery#17356 []))
               :  :  +- Aggregate [avg((cast(quantity#17379 as double) * list_price#17380)) AS average_sales#17385]
               :  :     +- Union false, false
               :  :        :- Project [ss_quantity#17520 AS quantity#17379, ss_list_price#17522 AS list_price#17380]
               :  :        :  +- Join Inner, (ss_sold_date_sk#17510 = d_date_sk#17533)
               :  :        :     :- Project [ss_sold_date_sk#17510, ss_quantity#17520, ss_list_price#17522]
               :  :        :     :  +- Filter isnotnull(ss_sold_date_sk#17510)
               :  :        :     :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#17510,ss_sold_time_sk#17511,ss_item_sk#17512,ss_customer_sk#17513,ss_cdemo_sk#17514,ss_hdemo_sk#17515,ss_addr_sk#17516,ss_store_sk#17517,ss_promo_sk#17518,ss_ticket_number#17519,ss_quantity#17520,ss_wholesale_cost#17521,ss_list_price#17522,ss_sales_price#17523,ss_ext_discount_amt#17524,ss_ext_sales_price#17525,ss_ext_wholesale_cost#17526,ss_ext_list_price#17527,ss_ext_tax#17528,ss_coupon_amt#17529,ss_net_paid#17530,ss_net_paid_inc_tax#17531,ss_net_profit#17532] parquet
               :  :        :     +- Project [d_date_sk#17533]
               :  :        :        +- Filter ((isnotnull(d_year#17539) AND ((d_year#17539 >= 1998) AND (d_year#17539 <= 2000))) AND isnotnull(d_date_sk#17533))
               :  :        :           +- Relation spark_catalog.m.date_dim[d_date_sk#17533,d_date_id#17534,d_date#17535,d_month_seq#17536,d_week_seq#17537,d_quarter_seq#17538,d_year#17539,d_dow#17540,d_moy#17541,d_dom#17542,d_qoy#17543,d_fy_year#17544,d_fy_quarter_seq#17545,d_fy_week_seq#17546,d_day_name#17547,d_quarter_name#17548,d_holiday#17549,d_weekend#17550,d_following_holiday#17551,d_first_dom#17552,d_last_dom#17553,d_same_day_ly#17554,d_same_day_lq#17555,d_current_day#17556,... 4 more fields] parquet
               :  :        :- Project [cs_quantity#17579 AS quantity#17381, cs_list_price#17581 AS list_price#17382]
               :  :        :  +- Join Inner, (cs_sold_date_sk#17561 = d_date_sk#17595)
               :  :        :     :- Project [cs_sold_date_sk#17561, cs_quantity#17579, cs_list_price#17581]
               :  :        :     :  +- Filter isnotnull(cs_sold_date_sk#17561)
               :  :        :     :     +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#17561,cs_sold_time_sk#17562,cs_ship_date_sk#17563,cs_bill_customer_sk#17564,cs_bill_cdemo_sk#17565,cs_bill_hdemo_sk#17566,cs_bill_addr_sk#17567,cs_ship_customer_sk#17568,cs_ship_cdemo_sk#17569,cs_ship_hdemo_sk#17570,cs_ship_addr_sk#17571,cs_call_center_sk#17572,cs_catalog_page_sk#17573,cs_ship_mode_sk#17574,cs_warehouse_sk#17575,cs_item_sk#17576,cs_promo_sk#17577,cs_order_number#17578,cs_quantity#17579,cs_wholesale_cost#17580,cs_list_price#17581,cs_sales_price#17582,cs_ext_discount_amt#17583,cs_ext_sales_price#17584,... 10 more fields] parquet
               :  :        :     +- Project [d_date_sk#17595]
               :  :        :        +- Filter ((isnotnull(d_year#17601) AND ((d_year#17601 >= 1998) AND (d_year#17601 <= 2000))) AND isnotnull(d_date_sk#17595))
               :  :        :           +- Relation spark_catalog.m.date_dim[d_date_sk#17595,d_date_id#17596,d_date#17597,d_month_seq#17598,d_week_seq#17599,d_quarter_seq#17600,d_year#17601,d_dow#17602,d_moy#17603,d_dom#17604,d_qoy#17605,d_fy_year#17606,d_fy_quarter_seq#17607,d_fy_week_seq#17608,d_day_name#17609,d_quarter_name#17610,d_holiday#17611,d_weekend#17612,d_following_holiday#17613,d_first_dom#17614,d_last_dom#17615,d_same_day_ly#17616,d_same_day_lq#17617,d_current_day#17618,... 4 more fields] parquet
               :  :        +- Project [ws_quantity#17641 AS quantity#17383, ws_list_price#17643 AS list_price#17384]
               :  :           +- Join Inner, (ws_sold_date_sk#17623 = d_date_sk#17657)
               :  :              :- Project [ws_sold_date_sk#17623, ws_quantity#17641, ws_list_price#17643]
               :  :              :  +- Filter isnotnull(ws_sold_date_sk#17623)
               :  :              :     +- Relation spark_catalog.m.web_sales[ws_sold_date_sk#17623,ws_sold_time_sk#17624,ws_ship_date_sk#17625,ws_item_sk#17626,ws_bill_customer_sk#17627,ws_bill_cdemo_sk#17628,ws_bill_hdemo_sk#17629,ws_bill_addr_sk#17630,ws_ship_customer_sk#17631,ws_ship_cdemo_sk#17632,ws_ship_hdemo_sk#17633,ws_ship_addr_sk#17634,ws_web_page_sk#17635,ws_web_site_sk#17636,ws_ship_mode_sk#17637,ws_warehouse_sk#17638,ws_promo_sk#17639,ws_order_number#17640,ws_quantity#17641,ws_wholesale_cost#17642,ws_list_price#17643,ws_sales_price#17644,ws_ext_discount_amt#17645,ws_ext_sales_price#17646,... 10 more fields] parquet
               :  :              +- Project [d_date_sk#17657]
               :  :                 +- Filter ((isnotnull(d_year#17663) AND ((d_year#17663 >= 1998) AND (d_year#17663 <= 2000))) AND isnotnull(d_date_sk#17657))
               :  :                    +- Relation spark_catalog.m.date_dim[d_date_sk#17657,d_date_id#17658,d_date#17659,d_month_seq#17660,d_week_seq#17661,d_quarter_seq#17662,d_year#17663,d_dow#17664,d_moy#17665,d_dom#17666,d_qoy#17667,d_fy_year#17668,d_fy_quarter_seq#17669,d_fy_week_seq#17670,d_day_name#17671,d_quarter_name#17672,d_holiday#17673,d_weekend#17674,d_following_holiday#17675,d_first_dom#17676,d_last_dom#17677,d_same_day_ly#17678,d_same_day_lq#17679,d_current_day#17680,... 4 more fields] parquet
               :  +- Aggregate [i_brand_id#17715, i_class_id#17717, i_category_id#17719], [i_brand_id#17715, i_class_id#17717, i_category_id#17719, sum((cast(ss_quantity#17695 as double) * ss_list_price#17697)) AS sales#17352, count(1) AS number_sales#17353L]
               :     +- Project [ss_quantity#17695, ss_list_price#17697, i_brand_id#17715, i_class_id#17717, i_category_id#17719]
               :        +- Join Inner, (ss_sold_date_sk#17685 = d_date_sk#17730)
               :           :- Project [ss_sold_date_sk#17685, ss_quantity#17695, ss_list_price#17697, i_brand_id#17715, i_class_id#17717, i_category_id#17719]
               :           :  +- Join Inner, (ss_item_sk#17687 = i_item_sk#17708)
               :           :     :- Join LeftSemi, (ss_item_sk#17687 = ss_item_sk#17378)
               :           :     :  :- Project [ss_sold_date_sk#17685, ss_item_sk#17687, ss_quantity#17695, ss_list_price#17697]
               :           :     :  :  +- Filter (isnotnull(ss_item_sk#17687) AND isnotnull(ss_sold_date_sk#17685))
               :           :     :  :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#17685,ss_sold_time_sk#17686,ss_item_sk#17687,ss_customer_sk#17688,ss_cdemo_sk#17689,ss_hdemo_sk#17690,ss_addr_sk#17691,ss_store_sk#17692,ss_promo_sk#17693,ss_ticket_number#17694,ss_quantity#17695,ss_wholesale_cost#17696,ss_list_price#17697,ss_sales_price#17698,ss_ext_discount_amt#17699,ss_ext_sales_price#17700,ss_ext_wholesale_cost#17701,ss_ext_list_price#17702,ss_ext_tax#17703,ss_coupon_amt#17704,ss_net_paid#17705,ss_net_paid_inc_tax#17706,ss_net_profit#17707] parquet
               :           :     :  +- Project [i_item_sk#1271 AS ss_item_sk#17378]
               :           :     :     +- Join Inner, (((i_brand_id#1278 = brand_id#17375) AND (i_class_id#1280 = class_id#17376)) AND (i_category_id#1282 = category_id#17377))
               :           :     :        :- Project [i_item_sk#1271, i_brand_id#1278, i_class_id#1280, i_category_id#1282]
               :           :     :        :  +- Filter ((isnotnull(i_brand_id#1278) AND isnotnull(i_class_id#1280)) AND isnotnull(i_category_id#1282))
               :           :     :        :     +- Relation spark_catalog.m.item[i_item_sk#1271,i_item_id#1272,i_rec_start_date#1273,i_rec_end_date#1274,i_item_desc#1275,i_current_price#1276,i_wholesale_cost#1277,i_brand_id#1278,i_brand#1279,i_class_id#1280,i_class#1281,i_category_id#1282,i_category#1283,i_manufact_id#1284,i_manufact#1285,i_size#1286,i_formulation#1287,i_color#1288,i_units#1289,i_container#1290,i_manager_id#1291,i_product_name#1292] parquet
               :           :     :        +- Join LeftSemi, (((brand_id#17375 <=> i_brand_id#17467) AND (class_id#17376 <=> i_class_id#17469)) AND (category_id#17377 <=> i_category_id#17471))
               :           :     :           :- Aggregate [brand_id#17375, class_id#17376, category_id#17377], [brand_id#17375, class_id#17376, category_id#17377]
               :           :     :           :  +- Project [i_brand_id#17395 AS brand_id#17375, i_class_id#17397 AS class_id#17376, i_category_id#17399 AS category_id#17377]
               :           :     :           :     +- Join Inner, (ss_sold_date_sk#1248 = d_date_sk#24)
               :           :     :           :        :- Project [ss_sold_date_sk#1248, i_brand_id#17395, i_class_id#17397, i_category_id#17399]
               :           :     :           :        :  +- Join Inner, (ss_item_sk#1250 = i_item_sk#17388)
               :           :     :           :        :     :- Project [ss_sold_date_sk#1248, ss_item_sk#1250]
               :           :     :           :        :     :  +- Filter (isnotnull(ss_item_sk#1250) AND isnotnull(ss_sold_date_sk#1248))
               :           :     :           :        :     :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#1248,ss_sold_time_sk#1249,ss_item_sk#1250,ss_customer_sk#1251,ss_cdemo_sk#1252,ss_hdemo_sk#1253,ss_addr_sk#1254,ss_store_sk#1255,ss_promo_sk#1256,ss_ticket_number#1257,ss_quantity#1258,ss_wholesale_cost#1259,ss_list_price#1260,ss_sales_price#1261,ss_ext_discount_amt#1262,ss_ext_sales_price#1263,ss_ext_wholesale_cost#1264,ss_ext_list_price#1265,ss_ext_tax#1266,ss_coupon_amt#1267,ss_net_paid#1268,ss_net_paid_inc_tax#1269,ss_net_profit#1270] parquet
               :           :     :           :        :     +- Join LeftSemi, (((i_brand_id#17395 <=> i_brand_id#17417) AND (i_class_id#17397 <=> i_class_id#17419)) AND (i_category_id#17399 <=> i_category_id#17421))
               :           :     :           :        :        :- Project [i_item_sk#17388, i_brand_id#17395, i_class_id#17397, i_category_id#17399]
               :           :     :           :        :        :  +- Filter (isnotnull(i_item_sk#17388) AND ((isnotnull(i_brand_id#17395) AND isnotnull(i_class_id#17397)) AND isnotnull(i_category_id#17399)))
               :           :     :           :        :        :     +- Relation spark_catalog.m.item[i_item_sk#17388,i_item_id#17389,i_rec_start_date#17390,i_rec_end_date#17391,i_item_desc#17392,i_current_price#17393,i_wholesale_cost#17394,i_brand_id#17395,i_brand#17396,i_class_id#17397,i_class#17398,i_category_id#17399,i_category#17400,i_manufact_id#17401,i_manufact#17402,i_size#17403,i_formulation#17404,i_color#17405,i_units#17406,i_container#17407,i_manager_id#17408,i_product_name#17409] parquet
               :           :     :           :        :        +- Project [i_brand_id#17417, i_class_id#17419, i_category_id#17421]
               :           :     :           :        :           +- Join Inner, (cs_sold_date_sk#461 = d_date_sk#17432)
               :           :     :           :        :              :- Project [cs_sold_date_sk#461, i_brand_id#17417, i_class_id#17419, i_category_id#17421]
               :           :     :           :        :              :  +- Join Inner, (cs_item_sk#476 = i_item_sk#17410)
               :           :     :           :        :              :     :- Project [cs_sold_date_sk#461, cs_item_sk#476]
               :           :     :           :        :              :     :  +- Filter (isnotnull(cs_item_sk#476) AND isnotnull(cs_sold_date_sk#461))
               :           :     :           :        :              :     :     +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#461,cs_sold_time_sk#462,cs_ship_date_sk#463,cs_bill_customer_sk#464,cs_bill_cdemo_sk#465,cs_bill_hdemo_sk#466,cs_bill_addr_sk#467,cs_ship_customer_sk#468,cs_ship_cdemo_sk#469,cs_ship_hdemo_sk#470,cs_ship_addr_sk#471,cs_call_center_sk#472,cs_catalog_page_sk#473,cs_ship_mode_sk#474,cs_warehouse_sk#475,cs_item_sk#476,cs_promo_sk#477,cs_order_number#478,cs_quantity#479,cs_wholesale_cost#480,cs_list_price#481,cs_sales_price#482,cs_ext_discount_amt#483,cs_ext_sales_price#484,... 10 more fields] parquet
               :           :     :           :        :              :     +- Project [i_item_sk#17410, i_brand_id#17417, i_class_id#17419, i_category_id#17421]
               :           :     :           :        :              :        +- Filter isnotnull(i_item_sk#17410)
               :           :     :           :        :              :           +- Relation spark_catalog.m.item[i_item_sk#17410,i_item_id#17411,i_rec_start_date#17412,i_rec_end_date#17413,i_item_desc#17414,i_current_price#17415,i_wholesale_cost#17416,i_brand_id#17417,i_brand#17418,i_class_id#17419,i_class#17420,i_category_id#17421,i_category#17422,i_manufact_id#17423,i_manufact#17424,i_size#17425,i_formulation#17426,i_color#17427,i_units#17428,i_container#17429,i_manager_id#17430,i_product_name#17431] parquet
               :           :     :           :        :              +- Project [d_date_sk#17432]
               :           :     :           :        :                 +- Filter ((isnotnull(d_year#17438) AND ((d_year#17438 >= 1998) AND (d_year#17438 <= 2000))) AND isnotnull(d_date_sk#17432))
               :           :     :           :        :                    +- Relation spark_catalog.m.date_dim[d_date_sk#17432,d_date_id#17433,d_date#17434,d_month_seq#17435,d_week_seq#17436,d_quarter_seq#17437,d_year#17438,d_dow#17439,d_moy#17440,d_dom#17441,d_qoy#17442,d_fy_year#17443,d_fy_quarter_seq#17444,d_fy_week_seq#17445,d_day_name#17446,d_quarter_name#17447,d_holiday#17448,d_weekend#17449,d_following_holiday#17450,d_first_dom#17451,d_last_dom#17452,d_same_day_ly#17453,d_same_day_lq#17454,d_current_day#17455,... 4 more fields] parquet
               :           :     :           :        +- Project [d_date_sk#24]
               :           :     :           :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1998) AND (d_year#30 <= 2000))) AND isnotnull(d_date_sk#24))
               :           :     :           :              +- Relation spark_catalog.m.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :           :     :           +- Project [i_brand_id#17467, i_class_id#17469, i_category_id#17471]
               :           :     :              +- Join Inner, (ws_sold_date_sk#427 = d_date_sk#17482)
               :           :     :                 :- Project [ws_sold_date_sk#427, i_brand_id#17467, i_class_id#17469, i_category_id#17471]
               :           :     :                 :  +- Join Inner, (ws_item_sk#430 = i_item_sk#17460)
               :           :     :                 :     :- Project [ws_sold_date_sk#427, ws_item_sk#430]
               :           :     :                 :     :  +- Filter (isnotnull(ws_item_sk#430) AND isnotnull(ws_sold_date_sk#427))
               :           :     :                 :     :     +- Relation spark_catalog.m.web_sales[ws_sold_date_sk#427,ws_sold_time_sk#428,ws_ship_date_sk#429,ws_item_sk#430,ws_bill_customer_sk#431,ws_bill_cdemo_sk#432,ws_bill_hdemo_sk#433,ws_bill_addr_sk#434,ws_ship_customer_sk#435,ws_ship_cdemo_sk#436,ws_ship_hdemo_sk#437,ws_ship_addr_sk#438,ws_web_page_sk#439,ws_web_site_sk#440,ws_ship_mode_sk#441,ws_warehouse_sk#442,ws_promo_sk#443,ws_order_number#444,ws_quantity#445,ws_wholesale_cost#446,ws_list_price#447,ws_sales_price#448,ws_ext_discount_amt#449,ws_ext_sales_price#450,... 10 more fields] parquet
               :           :     :                 :     +- Project [i_item_sk#17460, i_brand_id#17467, i_class_id#17469, i_category_id#17471]
               :           :     :                 :        +- Filter isnotnull(i_item_sk#17460)
               :           :     :                 :           +- Relation spark_catalog.m.item[i_item_sk#17460,i_item_id#17461,i_rec_start_date#17462,i_rec_end_date#17463,i_item_desc#17464,i_current_price#17465,i_wholesale_cost#17466,i_brand_id#17467,i_brand#17468,i_class_id#17469,i_class#17470,i_category_id#17471,i_category#17472,i_manufact_id#17473,i_manufact#17474,i_size#17475,i_formulation#17476,i_color#17477,i_units#17478,i_container#17479,i_manager_id#17480,i_product_name#17481] parquet
               :           :     :                 +- Project [d_date_sk#17482]
               :           :     :                    +- Filter ((isnotnull(d_year#17488) AND ((d_year#17488 >= 1998) AND (d_year#17488 <= 2000))) AND isnotnull(d_date_sk#17482))
               :           :     :                       +- Relation spark_catalog.m.date_dim[d_date_sk#17482,d_date_id#17483,d_date#17484,d_month_seq#17485,d_week_seq#17486,d_quarter_seq#17487,d_year#17488,d_dow#17489,d_moy#17490,d_dom#17491,d_qoy#17492,d_fy_year#17493,d_fy_quarter_seq#17494,d_fy_week_seq#17495,d_day_name#17496,d_quarter_name#17497,d_holiday#17498,d_weekend#17499,d_following_holiday#17500,d_first_dom#17501,d_last_dom#17502,d_same_day_ly#17503,d_same_day_lq#17504,d_current_day#17505,... 4 more fields] parquet
               :           :     +- Join LeftSemi, (i_item_sk#17708 = ss_item_sk#17378)
               :           :        :- Project [i_item_sk#17708, i_brand_id#17715, i_class_id#17717, i_category_id#17719]
               :           :        :  +- Filter (((isnotnull(i_item_sk#17708) AND isnotnull(i_brand_id#17715)) AND isnotnull(i_class_id#17717)) AND isnotnull(i_category_id#17719))
               :           :        :     +- Relation spark_catalog.m.item[i_item_sk#17708,i_item_id#17709,i_rec_start_date#17710,i_rec_end_date#17711,i_item_desc#17712,i_current_price#17713,i_wholesale_cost#17714,i_brand_id#17715,i_brand#17716,i_class_id#17717,i_class#17718,i_category_id#17719,i_category#17720,i_manufact_id#17721,i_manufact#17722,i_size#17723,i_formulation#17724,i_color#17725,i_units#17726,i_container#17727,i_manager_id#17728,i_product_name#17729] parquet
               :           :        +- Project [i_item_sk#1271 AS ss_item_sk#17378]
               :           :           +- Join Inner, (((i_brand_id#1278 = brand_id#17375) AND (i_class_id#1280 = class_id#17376)) AND (i_category_id#1282 = category_id#17377))
               :           :              :- Project [i_item_sk#1271, i_brand_id#1278, i_class_id#1280, i_category_id#1282]
               :           :              :  +- Filter ((isnotnull(i_brand_id#1278) AND isnotnull(i_class_id#1280)) AND isnotnull(i_category_id#1282))
               :           :              :     +- Relation spark_catalog.m.item[i_item_sk#1271,i_item_id#1272,i_rec_start_date#1273,i_rec_end_date#1274,i_item_desc#1275,i_current_price#1276,i_wholesale_cost#1277,i_brand_id#1278,i_brand#1279,i_class_id#1280,i_class#1281,i_category_id#1282,i_category#1283,i_manufact_id#1284,i_manufact#1285,i_size#1286,i_formulation#1287,i_color#1288,i_units#1289,i_container#1290,i_manager_id#1291,i_product_name#1292] parquet
               :           :              +- Join LeftSemi, (((brand_id#17375 <=> i_brand_id#17467) AND (class_id#17376 <=> i_class_id#17469)) AND (category_id#17377 <=> i_category_id#17471))
               :           :                 :- Aggregate [brand_id#17375, class_id#17376, category_id#17377], [brand_id#17375, class_id#17376, category_id#17377]
               :           :                 :  +- Project [i_brand_id#17395 AS brand_id#17375, i_class_id#17397 AS class_id#17376, i_category_id#17399 AS category_id#17377]
               :           :                 :     +- Join Inner, (ss_sold_date_sk#1248 = d_date_sk#24)
               :           :                 :        :- Project [ss_sold_date_sk#1248, i_brand_id#17395, i_class_id#17397, i_category_id#17399]
               :           :                 :        :  +- Join Inner, (ss_item_sk#1250 = i_item_sk#17388)
               :           :                 :        :     :- Project [ss_sold_date_sk#1248, ss_item_sk#1250]
               :           :                 :        :     :  +- Filter (isnotnull(ss_item_sk#1250) AND isnotnull(ss_sold_date_sk#1248))
               :           :                 :        :     :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#1248,ss_sold_time_sk#1249,ss_item_sk#1250,ss_customer_sk#1251,ss_cdemo_sk#1252,ss_hdemo_sk#1253,ss_addr_sk#1254,ss_store_sk#1255,ss_promo_sk#1256,ss_ticket_number#1257,ss_quantity#1258,ss_wholesale_cost#1259,ss_list_price#1260,ss_sales_price#1261,ss_ext_discount_amt#1262,ss_ext_sales_price#1263,ss_ext_wholesale_cost#1264,ss_ext_list_price#1265,ss_ext_tax#1266,ss_coupon_amt#1267,ss_net_paid#1268,ss_net_paid_inc_tax#1269,ss_net_profit#1270] parquet
               :           :                 :        :     +- Join LeftSemi, (((i_brand_id#17395 <=> i_brand_id#17417) AND (i_class_id#17397 <=> i_class_id#17419)) AND (i_category_id#17399 <=> i_category_id#17421))
               :           :                 :        :        :- Project [i_item_sk#17388, i_brand_id#17395, i_class_id#17397, i_category_id#17399]
               :           :                 :        :        :  +- Filter (isnotnull(i_item_sk#17388) AND ((isnotnull(i_brand_id#17395) AND isnotnull(i_class_id#17397)) AND isnotnull(i_category_id#17399)))
               :           :                 :        :        :     +- Relation spark_catalog.m.item[i_item_sk#17388,i_item_id#17389,i_rec_start_date#17390,i_rec_end_date#17391,i_item_desc#17392,i_current_price#17393,i_wholesale_cost#17394,i_brand_id#17395,i_brand#17396,i_class_id#17397,i_class#17398,i_category_id#17399,i_category#17400,i_manufact_id#17401,i_manufact#17402,i_size#17403,i_formulation#17404,i_color#17405,i_units#17406,i_container#17407,i_manager_id#17408,i_product_name#17409] parquet
               :           :                 :        :        +- Project [i_brand_id#17417, i_class_id#17419, i_category_id#17421]
               :           :                 :        :           +- Join Inner, (cs_sold_date_sk#461 = d_date_sk#17432)
               :           :                 :        :              :- Project [cs_sold_date_sk#461, i_brand_id#17417, i_class_id#17419, i_category_id#17421]
               :           :                 :        :              :  +- Join Inner, (cs_item_sk#476 = i_item_sk#17410)
               :           :                 :        :              :     :- Project [cs_sold_date_sk#461, cs_item_sk#476]
               :           :                 :        :              :     :  +- Filter (isnotnull(cs_item_sk#476) AND isnotnull(cs_sold_date_sk#461))
               :           :                 :        :              :     :     +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#461,cs_sold_time_sk#462,cs_ship_date_sk#463,cs_bill_customer_sk#464,cs_bill_cdemo_sk#465,cs_bill_hdemo_sk#466,cs_bill_addr_sk#467,cs_ship_customer_sk#468,cs_ship_cdemo_sk#469,cs_ship_hdemo_sk#470,cs_ship_addr_sk#471,cs_call_center_sk#472,cs_catalog_page_sk#473,cs_ship_mode_sk#474,cs_warehouse_sk#475,cs_item_sk#476,cs_promo_sk#477,cs_order_number#478,cs_quantity#479,cs_wholesale_cost#480,cs_list_price#481,cs_sales_price#482,cs_ext_discount_amt#483,cs_ext_sales_price#484,... 10 more fields] parquet
               :           :                 :        :              :     +- Project [i_item_sk#17410, i_brand_id#17417, i_class_id#17419, i_category_id#17421]
               :           :                 :        :              :        +- Filter isnotnull(i_item_sk#17410)
               :           :                 :        :              :           +- Relation spark_catalog.m.item[i_item_sk#17410,i_item_id#17411,i_rec_start_date#17412,i_rec_end_date#17413,i_item_desc#17414,i_current_price#17415,i_wholesale_cost#17416,i_brand_id#17417,i_brand#17418,i_class_id#17419,i_class#17420,i_category_id#17421,i_category#17422,i_manufact_id#17423,i_manufact#17424,i_size#17425,i_formulation#17426,i_color#17427,i_units#17428,i_container#17429,i_manager_id#17430,i_product_name#17431] parquet
               :           :                 :        :              +- Project [d_date_sk#17432]
               :           :                 :        :                 +- Filter ((isnotnull(d_year#17438) AND ((d_year#17438 >= 1998) AND (d_year#17438 <= 2000))) AND isnotnull(d_date_sk#17432))
               :           :                 :        :                    +- Relation spark_catalog.m.date_dim[d_date_sk#17432,d_date_id#17433,d_date#17434,d_month_seq#17435,d_week_seq#17436,d_quarter_seq#17437,d_year#17438,d_dow#17439,d_moy#17440,d_dom#17441,d_qoy#17442,d_fy_year#17443,d_fy_quarter_seq#17444,d_fy_week_seq#17445,d_day_name#17446,d_quarter_name#17447,d_holiday#17448,d_weekend#17449,d_following_holiday#17450,d_first_dom#17451,d_last_dom#17452,d_same_day_ly#17453,d_same_day_lq#17454,d_current_day#17455,... 4 more fields] parquet
               :           :                 :        +- Project [d_date_sk#24]
               :           :                 :           +- Filter ((isnotnull(d_year#30) AND ((d_year#30 >= 1998) AND (d_year#30 <= 2000))) AND isnotnull(d_date_sk#24))
               :           :                 :              +- Relation spark_catalog.m.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
               :           :                 +- Project [i_brand_id#17467, i_class_id#17469, i_category_id#17471]
               :           :                    +- Join Inner, (ws_sold_date_sk#427 = d_date_sk#17482)
               :           :                       :- Project [ws_sold_date_sk#427, i_brand_id#17467, i_class_id#17469, i_category_id#17471]
               :           :                       :  +- Join Inner, (ws_item_sk#430 = i_item_sk#17460)
               :           :                       :     :- Project [ws_sold_date_sk#427, ws_item_sk#430]
               :           :                       :     :  +- Filter (isnotnull(ws_item_sk#430) AND isnotnull(ws_sold_date_sk#427))
               :           :                       :     :     +- Relation spark_catalog.m.web_sales[ws_sold_date_sk#427,ws_sold_time_sk#428,ws_ship_date_sk#429,ws_item_sk#430,ws_bill_customer_sk#431,ws_bill_cdemo_sk#432,ws_bill_hdemo_sk#433,ws_bill_addr_sk#434,ws_ship_customer_sk#435,ws_ship_cdemo_sk#436,ws_ship_hdemo_sk#437,ws_ship_addr_sk#438,ws_web_page_sk#439,ws_web_site_sk#440,ws_ship_mode_sk#441,ws_warehouse_sk#442,ws_promo_sk#443,ws_order_number#444,ws_quantity#445,ws_wholesale_cost#446,ws_list_price#447,ws_sales_price#448,ws_ext_discount_amt#449,ws_ext_sales_price#450,... 10 more fields] parquet
               :           :                       :     +- Project [i_item_sk#17460, i_brand_id#17467, i_class_id#17469, i_category_id#17471]
               :           :                       :        +- Filter isnotnull(i_item_sk#17460)
               :           :                       :           +- Relation spark_catalog.m.item[i_item_sk#17460,i_item_id#17461,i_rec_start_date#17462,i_rec_end_date#17463,i_item_desc#17464,i_current_price#17465,i_wholesale_cost#17466,i_brand_id#17467,i_brand#17468,i_class_id#17469,i_class#17470,i_category_id#17471,i_category#17472,i_manufact_id#17473,i_manufact#17474,i_size#17475,i_formulation#17476,i_color#17477,i_units#17478,i_container#17479,i_manager_id#17480,i_product_name#17481] parquet
               :           :                       +- Project [d_date_sk#17482]
               :           :                          +- Filter ((isnotnull(d_year#17488) AND ((d_year#17488 >= 1998) AND (d_year#17488 <= 2000))) AND isnotnull(d_date_sk#17482))
               :           :                             +- Relation spark_catalog.m.date_dim[d_date_sk#17482,d_date_id#17483,d_date#17484,d_month_seq#17485,d_week_seq#17486,d_quarter_seq#17487,d_year#17488,d_dow#17489,d_moy#17490,d_dom#17491,d_qoy#17492,d_fy_year#17493,d_fy_quarter_seq#17494,d_fy_week_seq#17495,d_day_name#17496,d_quarter_name#17497,d_holiday#17498,d_weekend#17499,d_following_holiday#17500,d_first_dom#17501,d_last_dom#17502,d_same_day_ly#17503,d_same_day_lq#17504,d_current_day#17505,... 4 more fields] parquet
               :           +- Project [d_date_sk#17730]
               :              +- Filter ((isnotnull(d_week_seq#17734) AND (d_week_seq#17734 = scalar-subquery#17355 [])) AND isnotnull(d_date_sk#17730))
               :                 :  +- Project [d_week_seq#17846]
               :                 :     +- Filter (((isnotnull(d_year#17848) AND isnotnull(d_moy#17850)) AND isnotnull(d_dom#17851)) AND (((d_year#17848 = 1999) AND (d_moy#17850 = 12)) AND (d_dom#17851 = 20)))
               :                 :        +- Relation spark_catalog.m.date_dim[d_date_sk#17842,d_date_id#17843,d_date#17844,d_month_seq#17845,d_week_seq#17846,d_quarter_seq#17847,d_year#17848,d_dow#17849,d_moy#17850,d_dom#17851,d_qoy#17852,d_fy_year#17853,d_fy_quarter_seq#17854,d_fy_week_seq#17855,d_day_name#17856,d_quarter_name#17857,d_holiday#17858,d_weekend#17859,d_following_holiday#17860,d_first_dom#17861,d_last_dom#17862,d_same_day_ly#17863,d_same_day_lq#17864,d_current_day#17865,... 4 more fields] parquet
               :                 +- Relation spark_catalog.m.date_dim[d_date_sk#17730,d_date_id#17731,d_date#17732,d_month_seq#17733,d_week_seq#17734,d_quarter_seq#17735,d_year#17736,d_dow#17737,d_moy#17738,d_dom#17739,d_qoy#17740,d_fy_year#17741,d_fy_quarter_seq#17742,d_fy_week_seq#17743,d_day_name#17744,d_quarter_name#17745,d_holiday#17746,d_weekend#17747,d_following_holiday#17748,d_first_dom#17749,d_last_dom#17750,d_same_day_ly#17751,d_same_day_lq#17752,d_current_day#17753,... 4 more fields] parquet
               +- Filter (isnotnull(sales#17358) AND (sales#17358 > scalar-subquery#17362 []))
                  :  +- Aggregate [avg((cast(quantity#17379 as double) * list_price#17380)) AS average_sales#17385]
                  :     +- Union false, false
                  :        :- Project [ss_quantity#17520 AS quantity#17379, ss_list_price#17522 AS list_price#17380]
                  :        :  +- Join Inner, (ss_sold_date_sk#17510 = d_date_sk#17533)
                  :        :     :- Project [ss_sold_date_sk#17510, ss_quantity#17520, ss_list_price#17522]
                  :        :     :  +- Filter isnotnull(ss_sold_date_sk#17510)
                  :        :     :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#17510,ss_sold_time_sk#17511,ss_item_sk#17512,ss_customer_sk#17513,ss_cdemo_sk#17514,ss_hdemo_sk#17515,ss_addr_sk#17516,ss_store_sk#17517,ss_promo_sk#17518,ss_ticket_number#17519,ss_quantity#17520,ss_wholesale_cost#17521,ss_list_price#17522,ss_sales_price#17523,ss_ext_discount_amt#17524,ss_ext_sales_price#17525,ss_ext_wholesale_cost#17526,ss_ext_list_price#17527,ss_ext_tax#17528,ss_coupon_amt#17529,ss_net_paid#17530,ss_net_paid_inc_tax#17531,ss_net_profit#17532] parquet
                  :        :     +- Project [d_date_sk#17533]
                  :        :        +- Filter ((isnotnull(d_year#17539) AND ((d_year#17539 >= 1998) AND (d_year#17539 <= 2000))) AND isnotnull(d_date_sk#17533))
                  :        :           +- Relation spark_catalog.m.date_dim[d_date_sk#17533,d_date_id#17534,d_date#17535,d_month_seq#17536,d_week_seq#17537,d_quarter_seq#17538,d_year#17539,d_dow#17540,d_moy#17541,d_dom#17542,d_qoy#17543,d_fy_year#17544,d_fy_quarter_seq#17545,d_fy_week_seq#17546,d_day_name#17547,d_quarter_name#17548,d_holiday#17549,d_weekend#17550,d_following_holiday#17551,d_first_dom#17552,d_last_dom#17553,d_same_day_ly#17554,d_same_day_lq#17555,d_current_day#17556,... 4 more fields] parquet
                  :        :- Project [cs_quantity#17579 AS quantity#17381, cs_list_price#17581 AS list_price#17382]
                  :        :  +- Join Inner, (cs_sold_date_sk#17561 = d_date_sk#17595)
                  :        :     :- Project [cs_sold_date_sk#17561, cs_quantity#17579, cs_list_price#17581]
                  :        :     :  +- Filter isnotnull(cs_sold_date_sk#17561)
                  :        :     :     +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#17561,cs_sold_time_sk#17562,cs_ship_date_sk#17563,cs_bill_customer_sk#17564,cs_bill_cdemo_sk#17565,cs_bill_hdemo_sk#17566,cs_bill_addr_sk#17567,cs_ship_customer_sk#17568,cs_ship_cdemo_sk#17569,cs_ship_hdemo_sk#17570,cs_ship_addr_sk#17571,cs_call_center_sk#17572,cs_catalog_page_sk#17573,cs_ship_mode_sk#17574,cs_warehouse_sk#17575,cs_item_sk#17576,cs_promo_sk#17577,cs_order_number#17578,cs_quantity#17579,cs_wholesale_cost#17580,cs_list_price#17581,cs_sales_price#17582,cs_ext_discount_amt#17583,cs_ext_sales_price#17584,... 10 more fields] parquet
                  :        :     +- Project [d_date_sk#17595]
                  :        :        +- Filter ((isnotnull(d_year#17601) AND ((d_year#17601 >= 1998) AND (d_year#17601 <= 2000))) AND isnotnull(d_date_sk#17595))
                  :        :           +- Relation spark_catalog.m.date_dim[d_date_sk#17595,d_date_id#17596,d_date#17597,d_month_seq#17598,d_week_seq#17599,d_quarter_seq#17600,d_year#17601,d_dow#17602,d_moy#17603,d_dom#17604,d_qoy#17605,d_fy_year#17606,d_fy_quarter_seq#17607,d_fy_week_seq#17608,d_day_name#17609,d_quarter_name#17610,d_holiday#17611,d_weekend#17612,d_following_holiday#17613,d_first_dom#17614,d_last_dom#17615,d_same_day_ly#17616,d_same_day_lq#17617,d_current_day#17618,... 4 more fields] parquet
                  :        +- Project [ws_quantity#17641 AS quantity#17383, ws_list_price#17643 AS list_price#17384]
                  :           +- Join Inner, (ws_sold_date_sk#17623 = d_date_sk#17657)
                  :              :- Project [ws_sold_date_sk#17623, ws_quantity#17641, ws_list_price#17643]
                  :              :  +- Filter isnotnull(ws_sold_date_sk#17623)
                  :              :     +- Relation spark_catalog.m.web_sales[ws_sold_date_sk#17623,ws_sold_time_sk#17624,ws_ship_date_sk#17625,ws_item_sk#17626,ws_bill_customer_sk#17627,ws_bill_cdemo_sk#17628,ws_bill_hdemo_sk#17629,ws_bill_addr_sk#17630,ws_ship_customer_sk#17631,ws_ship_cdemo_sk#17632,ws_ship_hdemo_sk#17633,ws_ship_addr_sk#17634,ws_web_page_sk#17635,ws_web_site_sk#17636,ws_ship_mode_sk#17637,ws_warehouse_sk#17638,ws_promo_sk#17639,ws_order_number#17640,ws_quantity#17641,ws_wholesale_cost#17642,ws_list_price#17643,ws_sales_price#17644,ws_ext_discount_amt#17645,ws_ext_sales_price#17646,... 10 more fields] parquet
                  :              +- Project [d_date_sk#17657]
                  :                 +- Filter ((isnotnull(d_year#17663) AND ((d_year#17663 >= 1998) AND (d_year#17663 <= 2000))) AND isnotnull(d_date_sk#17657))
                  :                    +- Relation spark_catalog.m.date_dim[d_date_sk#17657,d_date_id#17658,d_date#17659,d_month_seq#17660,d_week_seq#17661,d_quarter_seq#17662,d_year#17663,d_dow#17664,d_moy#17665,d_dom#17666,d_qoy#17667,d_fy_year#17668,d_fy_quarter_seq#17669,d_fy_week_seq#17670,d_day_name#17671,d_quarter_name#17672,d_holiday#17673,d_weekend#17674,d_following_holiday#17675,d_first_dom#17676,d_last_dom#17677,d_same_day_ly#17678,d_same_day_lq#17679,d_current_day#17680,... 4 more fields] parquet
                  +- Aggregate [i_brand_id#17788, i_class_id#17790, i_category_id#17792], [i_brand_id#17788, i_class_id#17790, i_category_id#17792, sum((cast(ss_quantity#17768 as double) * ss_list_price#17770)) AS sales#17358, count(1) AS number_sales#17359L]
                     +- Project [ss_quantity#17768, ss_list_price#17770, i_brand_id#17788, i_class_id#17790, i_category_id#17792]
                        +- Join Inner, (ss_sold_date_sk#17758 = d_date_sk#17803)
                           :- Project [ss_sold_date_sk#17758, ss_quantity#17768, ss_list_price#17770, i_brand_id#17788, i_class_id#17790, i_category_id#17792]
                           :  +- Join Inner, (ss_item_sk#17760 = i_item_sk#17781)
                           :     :- Join LeftSemi, (ss_item_sk#17760 = ss_item_sk#17870)
                           :     :  :- Project [ss_sold_date_sk#17758, ss_item_sk#17760, ss_quantity#17768, ss_list_price#17770]
                           :     :  :  +- Filter (isnotnull(ss_item_sk#17760) AND isnotnull(ss_sold_date_sk#17758))
                           :     :  :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#17758,ss_sold_time_sk#17759,ss_item_sk#17760,ss_customer_sk#17761,ss_cdemo_sk#17762,ss_hdemo_sk#17763,ss_addr_sk#17764,ss_store_sk#17765,ss_promo_sk#17766,ss_ticket_number#17767,ss_quantity#17768,ss_wholesale_cost#17769,ss_list_price#17770,ss_sales_price#17771,ss_ext_discount_amt#17772,ss_ext_sales_price#17773,ss_ext_wholesale_cost#17774,ss_ext_list_price#17775,ss_ext_tax#17776,ss_coupon_amt#17777,ss_net_paid#17778,ss_net_paid_inc_tax#17779,ss_net_profit#17780] parquet
                           :     :  +- Project [i_item_sk#19784 AS ss_item_sk#17870]
                           :     :     +- Join Inner, (((i_brand_id#19791 = brand_id#17375) AND (i_class_id#19793 = class_id#17376)) AND (i_category_id#19795 = category_id#17377))
                           :     :        :- Project [i_item_sk#19784, i_brand_id#19791, i_class_id#19793, i_category_id#19795]
                           :     :        :  +- Filter ((isnotnull(i_brand_id#19791) AND isnotnull(i_class_id#19793)) AND isnotnull(i_category_id#19795))
                           :     :        :     +- Relation spark_catalog.m.item[i_item_sk#19784,i_item_id#19785,i_rec_start_date#19786,i_rec_end_date#19787,i_item_desc#19788,i_current_price#19789,i_wholesale_cost#19790,i_brand_id#19791,i_brand#19792,i_class_id#19793,i_class#19794,i_category_id#19795,i_category#19796,i_manufact_id#19797,i_manufact#19798,i_size#19799,i_formulation#19800,i_color#19801,i_units#19802,i_container#19803,i_manager_id#19804,i_product_name#19805] parquet
                           :     :        +- Join LeftSemi, (((brand_id#17375 <=> i_brand_id#20004) AND (class_id#17376 <=> i_class_id#20006)) AND (category_id#17377 <=> i_category_id#20008))
                           :     :           :- Aggregate [brand_id#17375, class_id#17376, category_id#17377], [brand_id#17375, class_id#17376, category_id#17377]
                           :     :           :  +- Project [i_brand_id#19836 AS brand_id#17375, i_class_id#19838 AS class_id#17376, i_category_id#19840 AS category_id#17377]
                           :     :           :     +- Join Inner, (ss_sold_date_sk#19806 = d_date_sk#19851)
                           :     :           :        :- Project [ss_sold_date_sk#19806, i_brand_id#19836, i_class_id#19838, i_category_id#19840]
                           :     :           :        :  +- Join Inner, (ss_item_sk#19808 = i_item_sk#19829)
                           :     :           :        :     :- Project [ss_sold_date_sk#19806, ss_item_sk#19808]
                           :     :           :        :     :  +- Filter (isnotnull(ss_item_sk#19808) AND isnotnull(ss_sold_date_sk#19806))
                           :     :           :        :     :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#19806,ss_sold_time_sk#19807,ss_item_sk#19808,ss_customer_sk#19809,ss_cdemo_sk#19810,ss_hdemo_sk#19811,ss_addr_sk#19812,ss_store_sk#19813,ss_promo_sk#19814,ss_ticket_number#19815,ss_quantity#19816,ss_wholesale_cost#19817,ss_list_price#19818,ss_sales_price#19819,ss_ext_discount_amt#19820,ss_ext_sales_price#19821,ss_ext_wholesale_cost#19822,ss_ext_list_price#19823,ss_ext_tax#19824,ss_coupon_amt#19825,ss_net_paid#19826,ss_net_paid_inc_tax#19827,ss_net_profit#19828] parquet
                           :     :           :        :     +- Join LeftSemi, (((i_brand_id#19836 <=> i_brand_id#19920) AND (i_class_id#19838 <=> i_class_id#19922)) AND (i_category_id#19840 <=> i_category_id#19924))
                           :     :           :        :        :- Project [i_item_sk#19829, i_brand_id#19836, i_class_id#19838, i_category_id#19840]
                           :     :           :        :        :  +- Filter (isnotnull(i_item_sk#19829) AND ((isnotnull(i_brand_id#19836) AND isnotnull(i_class_id#19838)) AND isnotnull(i_category_id#19840)))
                           :     :           :        :        :     +- Relation spark_catalog.m.item[i_item_sk#19829,i_item_id#19830,i_rec_start_date#19831,i_rec_end_date#19832,i_item_desc#19833,i_current_price#19834,i_wholesale_cost#19835,i_brand_id#19836,i_brand#19837,i_class_id#19838,i_class#19839,i_category_id#19840,i_category#19841,i_manufact_id#19842,i_manufact#19843,i_size#19844,i_formulation#19845,i_color#19846,i_units#19847,i_container#19848,i_manager_id#19849,i_product_name#19850] parquet
                           :     :           :        :        +- Project [i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                           :     :           :        :           +- Join Inner, (cs_sold_date_sk#19879 = d_date_sk#19935)
                           :     :           :        :              :- Project [cs_sold_date_sk#19879, i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                           :     :           :        :              :  +- Join Inner, (cs_item_sk#19894 = i_item_sk#19913)
                           :     :           :        :              :     :- Project [cs_sold_date_sk#19879, cs_item_sk#19894]
                           :     :           :        :              :     :  +- Filter (isnotnull(cs_item_sk#19894) AND isnotnull(cs_sold_date_sk#19879))
                           :     :           :        :              :     :     +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#19879,cs_sold_time_sk#19880,cs_ship_date_sk#19881,cs_bill_customer_sk#19882,cs_bill_cdemo_sk#19883,cs_bill_hdemo_sk#19884,cs_bill_addr_sk#19885,cs_ship_customer_sk#19886,cs_ship_cdemo_sk#19887,cs_ship_hdemo_sk#19888,cs_ship_addr_sk#19889,cs_call_center_sk#19890,cs_catalog_page_sk#19891,cs_ship_mode_sk#19892,cs_warehouse_sk#19893,cs_item_sk#19894,cs_promo_sk#19895,cs_order_number#19896,cs_quantity#19897,cs_wholesale_cost#19898,cs_list_price#19899,cs_sales_price#19900,cs_ext_discount_amt#19901,cs_ext_sales_price#19902,... 10 more fields] parquet
                           :     :           :        :              :     +- Project [i_item_sk#19913, i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                           :     :           :        :              :        +- Filter isnotnull(i_item_sk#19913)
                           :     :           :        :              :           +- Relation spark_catalog.m.item[i_item_sk#19913,i_item_id#19914,i_rec_start_date#19915,i_rec_end_date#19916,i_item_desc#19917,i_current_price#19918,i_wholesale_cost#19919,i_brand_id#19920,i_brand#19921,i_class_id#19922,i_class#19923,i_category_id#19924,i_category#19925,i_manufact_id#19926,i_manufact#19927,i_size#19928,i_formulation#19929,i_color#19930,i_units#19931,i_container#19932,i_manager_id#19933,i_product_name#19934] parquet
                           :     :           :        :              +- Project [d_date_sk#19935]
                           :     :           :        :                 +- Filter ((isnotnull(d_year#19941) AND ((d_year#19941 >= 1998) AND (d_year#19941 <= 2000))) AND isnotnull(d_date_sk#19935))
                           :     :           :        :                    +- Relation spark_catalog.m.date_dim[d_date_sk#19935,d_date_id#19936,d_date#19937,d_month_seq#19938,d_week_seq#19939,d_quarter_seq#19940,d_year#19941,d_dow#19942,d_moy#19943,d_dom#19944,d_qoy#19945,d_fy_year#19946,d_fy_quarter_seq#19947,d_fy_week_seq#19948,d_day_name#19949,d_quarter_name#19950,d_holiday#19951,d_weekend#19952,d_following_holiday#19953,d_first_dom#19954,d_last_dom#19955,d_same_day_ly#19956,d_same_day_lq#19957,d_current_day#19958,... 4 more fields] parquet
                           :     :           :        +- Project [d_date_sk#19851]
                           :     :           :           +- Filter ((isnotnull(d_year#19857) AND ((d_year#19857 >= 1998) AND (d_year#19857 <= 2000))) AND isnotnull(d_date_sk#19851))
                           :     :           :              +- Relation spark_catalog.m.date_dim[d_date_sk#19851,d_date_id#19852,d_date#19853,d_month_seq#19854,d_week_seq#19855,d_quarter_seq#19856,d_year#19857,d_dow#19858,d_moy#19859,d_dom#19860,d_qoy#19861,d_fy_year#19862,d_fy_quarter_seq#19863,d_fy_week_seq#19864,d_day_name#19865,d_quarter_name#19866,d_holiday#19867,d_weekend#19868,d_following_holiday#19869,d_first_dom#19870,d_last_dom#19871,d_same_day_ly#19872,d_same_day_lq#19873,d_current_day#19874,... 4 more fields] parquet
                           :     :           +- Project [i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                           :     :              +- Join Inner, (ws_sold_date_sk#19963 = d_date_sk#20019)
                           :     :                 :- Project [ws_sold_date_sk#19963, i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                           :     :                 :  +- Join Inner, (ws_item_sk#19966 = i_item_sk#19997)
                           :     :                 :     :- Project [ws_sold_date_sk#19963, ws_item_sk#19966]
                           :     :                 :     :  +- Filter (isnotnull(ws_item_sk#19966) AND isnotnull(ws_sold_date_sk#19963))
                           :     :                 :     :     +- Relation spark_catalog.m.web_sales[ws_sold_date_sk#19963,ws_sold_time_sk#19964,ws_ship_date_sk#19965,ws_item_sk#19966,ws_bill_customer_sk#19967,ws_bill_cdemo_sk#19968,ws_bill_hdemo_sk#19969,ws_bill_addr_sk#19970,ws_ship_customer_sk#19971,ws_ship_cdemo_sk#19972,ws_ship_hdemo_sk#19973,ws_ship_addr_sk#19974,ws_web_page_sk#19975,ws_web_site_sk#19976,ws_ship_mode_sk#19977,ws_warehouse_sk#19978,ws_promo_sk#19979,ws_order_number#19980,ws_quantity#19981,ws_wholesale_cost#19982,ws_list_price#19983,ws_sales_price#19984,ws_ext_discount_amt#19985,ws_ext_sales_price#19986,... 10 more fields] parquet
                           :     :                 :     +- Project [i_item_sk#19997, i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                           :     :                 :        +- Filter isnotnull(i_item_sk#19997)
                           :     :                 :           +- Relation spark_catalog.m.item[i_item_sk#19997,i_item_id#19998,i_rec_start_date#19999,i_rec_end_date#20000,i_item_desc#20001,i_current_price#20002,i_wholesale_cost#20003,i_brand_id#20004,i_brand#20005,i_class_id#20006,i_class#20007,i_category_id#20008,i_category#20009,i_manufact_id#20010,i_manufact#20011,i_size#20012,i_formulation#20013,i_color#20014,i_units#20015,i_container#20016,i_manager_id#20017,i_product_name#20018] parquet
                           :     :                 +- Project [d_date_sk#20019]
                           :     :                    +- Filter ((isnotnull(d_year#20025) AND ((d_year#20025 >= 1998) AND (d_year#20025 <= 2000))) AND isnotnull(d_date_sk#20019))
                           :     :                       +- Relation spark_catalog.m.date_dim[d_date_sk#20019,d_date_id#20020,d_date#20021,d_month_seq#20022,d_week_seq#20023,d_quarter_seq#20024,d_year#20025,d_dow#20026,d_moy#20027,d_dom#20028,d_qoy#20029,d_fy_year#20030,d_fy_quarter_seq#20031,d_fy_week_seq#20032,d_day_name#20033,d_quarter_name#20034,d_holiday#20035,d_weekend#20036,d_following_holiday#20037,d_first_dom#20038,d_last_dom#20039,d_same_day_ly#20040,d_same_day_lq#20041,d_current_day#20042,... 4 more fields] parquet
                           :     +- Join LeftSemi, (i_item_sk#17781 = ss_item_sk#17870)
                           :        :- Project [i_item_sk#17781, i_brand_id#17788, i_class_id#17790, i_category_id#17792]
                           :        :  +- Filter (((isnotnull(i_item_sk#17781) AND isnotnull(i_brand_id#17788)) AND isnotnull(i_class_id#17790)) AND isnotnull(i_category_id#17792))
                           :        :     +- Relation spark_catalog.m.item[i_item_sk#17781,i_item_id#17782,i_rec_start_date#17783,i_rec_end_date#17784,i_item_desc#17785,i_current_price#17786,i_wholesale_cost#17787,i_brand_id#17788,i_brand#17789,i_class_id#17790,i_class#17791,i_category_id#17792,i_category#17793,i_manufact_id#17794,i_manufact#17795,i_size#17796,i_formulation#17797,i_color#17798,i_units#17799,i_container#17800,i_manager_id#17801,i_product_name#17802] parquet
                           :        +- Project [i_item_sk#19784 AS ss_item_sk#17870]
                           :           +- Join Inner, (((i_brand_id#19791 = brand_id#17375) AND (i_class_id#19793 = class_id#17376)) AND (i_category_id#19795 = category_id#17377))
                           :              :- Project [i_item_sk#19784, i_brand_id#19791, i_class_id#19793, i_category_id#19795]
                           :              :  +- Filter ((isnotnull(i_brand_id#19791) AND isnotnull(i_class_id#19793)) AND isnotnull(i_category_id#19795))
                           :              :     +- Relation spark_catalog.m.item[i_item_sk#19784,i_item_id#19785,i_rec_start_date#19786,i_rec_end_date#19787,i_item_desc#19788,i_current_price#19789,i_wholesale_cost#19790,i_brand_id#19791,i_brand#19792,i_class_id#19793,i_class#19794,i_category_id#19795,i_category#19796,i_manufact_id#19797,i_manufact#19798,i_size#19799,i_formulation#19800,i_color#19801,i_units#19802,i_container#19803,i_manager_id#19804,i_product_name#19805] parquet
                           :              +- Join LeftSemi, (((brand_id#17375 <=> i_brand_id#20004) AND (class_id#17376 <=> i_class_id#20006)) AND (category_id#17377 <=> i_category_id#20008))
                           :                 :- Aggregate [brand_id#17375, class_id#17376, category_id#17377], [brand_id#17375, class_id#17376, category_id#17377]
                           :                 :  +- Project [i_brand_id#19836 AS brand_id#17375, i_class_id#19838 AS class_id#17376, i_category_id#19840 AS category_id#17377]
                           :                 :     +- Join Inner, (ss_sold_date_sk#19806 = d_date_sk#19851)
                           :                 :        :- Project [ss_sold_date_sk#19806, i_brand_id#19836, i_class_id#19838, i_category_id#19840]
                           :                 :        :  +- Join Inner, (ss_item_sk#19808 = i_item_sk#19829)
                           :                 :        :     :- Project [ss_sold_date_sk#19806, ss_item_sk#19808]
                           :                 :        :     :  +- Filter (isnotnull(ss_item_sk#19808) AND isnotnull(ss_sold_date_sk#19806))
                           :                 :        :     :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#19806,ss_sold_time_sk#19807,ss_item_sk#19808,ss_customer_sk#19809,ss_cdemo_sk#19810,ss_hdemo_sk#19811,ss_addr_sk#19812,ss_store_sk#19813,ss_promo_sk#19814,ss_ticket_number#19815,ss_quantity#19816,ss_wholesale_cost#19817,ss_list_price#19818,ss_sales_price#19819,ss_ext_discount_amt#19820,ss_ext_sales_price#19821,ss_ext_wholesale_cost#19822,ss_ext_list_price#19823,ss_ext_tax#19824,ss_coupon_amt#19825,ss_net_paid#19826,ss_net_paid_inc_tax#19827,ss_net_profit#19828] parquet
                           :                 :        :     +- Join LeftSemi, (((i_brand_id#19836 <=> i_brand_id#19920) AND (i_class_id#19838 <=> i_class_id#19922)) AND (i_category_id#19840 <=> i_category_id#19924))
                           :                 :        :        :- Project [i_item_sk#19829, i_brand_id#19836, i_class_id#19838, i_category_id#19840]
                           :                 :        :        :  +- Filter (isnotnull(i_item_sk#19829) AND ((isnotnull(i_brand_id#19836) AND isnotnull(i_class_id#19838)) AND isnotnull(i_category_id#19840)))
                           :                 :        :        :     +- Relation spark_catalog.m.item[i_item_sk#19829,i_item_id#19830,i_rec_start_date#19831,i_rec_end_date#19832,i_item_desc#19833,i_current_price#19834,i_wholesale_cost#19835,i_brand_id#19836,i_brand#19837,i_class_id#19838,i_class#19839,i_category_id#19840,i_category#19841,i_manufact_id#19842,i_manufact#19843,i_size#19844,i_formulation#19845,i_color#19846,i_units#19847,i_container#19848,i_manager_id#19849,i_product_name#19850] parquet
                           :                 :        :        +- Project [i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                           :                 :        :           +- Join Inner, (cs_sold_date_sk#19879 = d_date_sk#19935)
                           :                 :        :              :- Project [cs_sold_date_sk#19879, i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                           :                 :        :              :  +- Join Inner, (cs_item_sk#19894 = i_item_sk#19913)
                           :                 :        :              :     :- Project [cs_sold_date_sk#19879, cs_item_sk#19894]
                           :                 :        :              :     :  +- Filter (isnotnull(cs_item_sk#19894) AND isnotnull(cs_sold_date_sk#19879))
                           :                 :        :              :     :     +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#19879,cs_sold_time_sk#19880,cs_ship_date_sk#19881,cs_bill_customer_sk#19882,cs_bill_cdemo_sk#19883,cs_bill_hdemo_sk#19884,cs_bill_addr_sk#19885,cs_ship_customer_sk#19886,cs_ship_cdemo_sk#19887,cs_ship_hdemo_sk#19888,cs_ship_addr_sk#19889,cs_call_center_sk#19890,cs_catalog_page_sk#19891,cs_ship_mode_sk#19892,cs_warehouse_sk#19893,cs_item_sk#19894,cs_promo_sk#19895,cs_order_number#19896,cs_quantity#19897,cs_wholesale_cost#19898,cs_list_price#19899,cs_sales_price#19900,cs_ext_discount_amt#19901,cs_ext_sales_price#19902,... 10 more fields] parquet
                           :                 :        :              :     +- Project [i_item_sk#19913, i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                           :                 :        :              :        +- Filter isnotnull(i_item_sk#19913)
                           :                 :        :              :           +- Relation spark_catalog.m.item[i_item_sk#19913,i_item_id#19914,i_rec_start_date#19915,i_rec_end_date#19916,i_item_desc#19917,i_current_price#19918,i_wholesale_cost#19919,i_brand_id#19920,i_brand#19921,i_class_id#19922,i_class#19923,i_category_id#19924,i_category#19925,i_manufact_id#19926,i_manufact#19927,i_size#19928,i_formulation#19929,i_color#19930,i_units#19931,i_container#19932,i_manager_id#19933,i_product_name#19934] parquet
                           :                 :        :              +- Project [d_date_sk#19935]
                           :                 :        :                 +- Filter ((isnotnull(d_year#19941) AND ((d_year#19941 >= 1998) AND (d_year#19941 <= 2000))) AND isnotnull(d_date_sk#19935))
                           :                 :        :                    +- Relation spark_catalog.m.date_dim[d_date_sk#19935,d_date_id#19936,d_date#19937,d_month_seq#19938,d_week_seq#19939,d_quarter_seq#19940,d_year#19941,d_dow#19942,d_moy#19943,d_dom#19944,d_qoy#19945,d_fy_year#19946,d_fy_quarter_seq#19947,d_fy_week_seq#19948,d_day_name#19949,d_quarter_name#19950,d_holiday#19951,d_weekend#19952,d_following_holiday#19953,d_first_dom#19954,d_last_dom#19955,d_same_day_ly#19956,d_same_day_lq#19957,d_current_day#19958,... 4 more fields] parquet
                           :                 :        +- Project [d_date_sk#19851]
                           :                 :           +- Filter ((isnotnull(d_year#19857) AND ((d_year#19857 >= 1998) AND (d_year#19857 <= 2000))) AND isnotnull(d_date_sk#19851))
                           :                 :              +- Relation spark_catalog.m.date_dim[d_date_sk#19851,d_date_id#19852,d_date#19853,d_month_seq#19854,d_week_seq#19855,d_quarter_seq#19856,d_year#19857,d_dow#19858,d_moy#19859,d_dom#19860,d_qoy#19861,d_fy_year#19862,d_fy_quarter_seq#19863,d_fy_week_seq#19864,d_day_name#19865,d_quarter_name#19866,d_holiday#19867,d_weekend#19868,d_following_holiday#19869,d_first_dom#19870,d_last_dom#19871,d_same_day_ly#19872,d_same_day_lq#19873,d_current_day#19874,... 4 more fields] parquet
                           :                 +- Project [i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                           :                    +- Join Inner, (ws_sold_date_sk#19963 = d_date_sk#20019)
                           :                       :- Project [ws_sold_date_sk#19963, i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                           :                       :  +- Join Inner, (ws_item_sk#19966 = i_item_sk#19997)
                           :                       :     :- Project [ws_sold_date_sk#19963, ws_item_sk#19966]
                           :                       :     :  +- Filter (isnotnull(ws_item_sk#19966) AND isnotnull(ws_sold_date_sk#19963))
                           :                       :     :     +- Relation spark_catalog.m.web_sales[ws_sold_date_sk#19963,ws_sold_time_sk#19964,ws_ship_date_sk#19965,ws_item_sk#19966,ws_bill_customer_sk#19967,ws_bill_cdemo_sk#19968,ws_bill_hdemo_sk#19969,ws_bill_addr_sk#19970,ws_ship_customer_sk#19971,ws_ship_cdemo_sk#19972,ws_ship_hdemo_sk#19973,ws_ship_addr_sk#19974,ws_web_page_sk#19975,ws_web_site_sk#19976,ws_ship_mode_sk#19977,ws_warehouse_sk#19978,ws_promo_sk#19979,ws_order_number#19980,ws_quantity#19981,ws_wholesale_cost#19982,ws_list_price#19983,ws_sales_price#19984,ws_ext_discount_amt#19985,ws_ext_sales_price#19986,... 10 more fields] parquet
                           :                       :     +- Project [i_item_sk#19997, i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                           :                       :        +- Filter isnotnull(i_item_sk#19997)
                           :                       :           +- Relation spark_catalog.m.item[i_item_sk#19997,i_item_id#19998,i_rec_start_date#19999,i_rec_end_date#20000,i_item_desc#20001,i_current_price#20002,i_wholesale_cost#20003,i_brand_id#20004,i_brand#20005,i_class_id#20006,i_class#20007,i_category_id#20008,i_category#20009,i_manufact_id#20010,i_manufact#20011,i_size#20012,i_formulation#20013,i_color#20014,i_units#20015,i_container#20016,i_manager_id#20017,i_product_name#20018] parquet
                           :                       +- Project [d_date_sk#20019]
                           :                          +- Filter ((isnotnull(d_year#20025) AND ((d_year#20025 >= 1998) AND (d_year#20025 <= 2000))) AND isnotnull(d_date_sk#20019))
                           :                             +- Relation spark_catalog.m.date_dim[d_date_sk#20019,d_date_id#20020,d_date#20021,d_month_seq#20022,d_week_seq#20023,d_quarter_seq#20024,d_year#20025,d_dow#20026,d_moy#20027,d_dom#20028,d_qoy#20029,d_fy_year#20030,d_fy_quarter_seq#20031,d_fy_week_seq#20032,d_day_name#20033,d_quarter_name#20034,d_holiday#20035,d_weekend#20036,d_following_holiday#20037,d_first_dom#20038,d_last_dom#20039,d_same_day_ly#20040,d_same_day_lq#20041,d_current_day#20042,... 4 more fields] parquet
                           +- Project [d_date_sk#17803]
                              +- Filter ((isnotnull(d_week_seq#17807) AND (d_week_seq#17807 = scalar-subquery#17361 [])) AND isnotnull(d_date_sk#17803))
                                 :  +- Project [d_week_seq#17875]
                                 :     +- Filter (((isnotnull(d_year#17877) AND isnotnull(d_moy#17879)) AND isnotnull(d_dom#17880)) AND (((d_year#17877 = 1998) AND (d_moy#17879 = 12)) AND (d_dom#17880 = 20)))
                                 :        +- Relation spark_catalog.m.date_dim[d_date_sk#17871,d_date_id#17872,d_date#17873,d_month_seq#17874,d_week_seq#17875,d_quarter_seq#17876,d_year#17877,d_dow#17878,d_moy#17879,d_dom#17880,d_qoy#17881,d_fy_year#17882,d_fy_quarter_seq#17883,d_fy_week_seq#17884,d_day_name#17885,d_quarter_name#17886,d_holiday#17887,d_weekend#17888,d_following_holiday#17889,d_first_dom#17890,d_last_dom#17891,d_same_day_ly#17892,d_same_day_lq#17893,d_current_day#17894,... 4 more fields] parquet
                                 +- Relation spark_catalog.m.date_dim[d_date_sk#17803,d_date_id#17804,d_date#17805,d_month_seq#17806,d_week_seq#17807,d_quarter_seq#17808,d_year#17809,d_dow#17810,d_moy#17811,d_dom#17812,d_qoy#17813,d_fy_year#17814,d_fy_quarter_seq#17815,d_fy_week_seq#17816,d_day_name#17817,d_quarter_name#17818,d_holiday#17819,d_weekend#17820,d_following_holiday#17821,d_first_dom#17822,d_last_dom#17823,d_same_day_ly#17824,d_same_day_lq#17825,d_current_day#17826,... 4 more fields] parquet

== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- TakeOrderedAndProject(limit=100, orderBy=[i_brand_id#17715 ASC NULLS FIRST,i_class_id#17717 ASC NULLS FIRST,i_category_id#17719 ASC NULLS FIRST], output=[ty_channel#17363,ty_brand#17364,ty_class#17365,ty_category#17366,ty_sales#17367,ty_number_sales#17368L,ly_channel#17369,ly_brand#17370,ly_class#17371,ly_category#17372,ly_sales#17373,ly_number_sales#17374L])
   +- Project [i_brand_id#17715 AS ty_brand#17364, i_class_id#17717 AS ty_class#17365, i_category_id#17719 AS ty_category#17366, sales#17352 AS ty_sales#17367, number_sales#17353L AS ty_number_sales#17368L, i_brand_id#17788 AS ly_brand#17370, i_class_id#17790 AS ly_class#17371, i_category_id#17792 AS ly_category#17372, sales#17358 AS ly_sales#17373, number_sales#17359L AS ly_number_sales#17374L, i_brand_id#17715, i_class_id#17717, i_category_id#17719]
      +- SortMergeJoin [i_brand_id#17715, i_class_id#17717, i_category_id#17719], [i_brand_id#17788, i_class_id#17790, i_category_id#17792], Inner
         :- Sort [i_brand_id#17715 ASC NULLS FIRST, i_class_id#17717 ASC NULLS FIRST, i_category_id#17719 ASC NULLS FIRST], false, 0
         :  +- Filter (isnotnull(sales#17352) AND (sales#17352 > Subquery subquery#17356, [id=#48081]))
         :     :  +- Subquery subquery#17356, [id=#48081]
         :     :     +- AdaptiveSparkPlan isFinalPlan=false
         :     :        +- HashAggregate(keys=[], functions=[avg((cast(quantity#17379 as double) * list_price#17380))], output=[average_sales#17385])
         :     :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=47990]
         :     :              +- HashAggregate(keys=[], functions=[partial_avg((cast(quantity#17379 as double) * list_price#17380))], output=[sum#19729, count#19730L])
         :     :                 +- Union
         :     :                    :- Project [ss_quantity#17520 AS quantity#17379, ss_list_price#17522 AS list_price#17380]
         :     :                    :  +- BroadcastHashJoin [ss_sold_date_sk#17510], [d_date_sk#17533], Inner, BuildRight, false
         :     :                    :     :- Filter isnotnull(ss_sold_date_sk#17510)
         :     :                    :     :  +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#17510,ss_quantity#17520,ss_list_price#17522] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#17510)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:double>
         :     :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=47978]
         :     :                    :        +- Project [d_date_sk#17533]
         :     :                    :           +- Filter (((isnotnull(d_year#17539) AND (d_year#17539 >= 1998)) AND (d_year#17539 <= 2000)) AND isnotnull(d_date_sk#17533))
         :     :                    :              +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17533,d_year#17539] Batched: true, DataFilters: [isnotnull(d_year#17539), (d_year#17539 >= 1998), (d_year#17539 <= 2000), isnotnull(d_date_sk#175..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     :                    :- Project [cs_quantity#17579 AS quantity#17381, cs_list_price#17581 AS list_price#17382]
         :     :                    :  +- BroadcastHashJoin [cs_sold_date_sk#17561], [d_date_sk#17595], Inner, BuildRight, false
         :     :                    :     :- Filter isnotnull(cs_sold_date_sk#17561)
         :     :                    :     :  +- FileScan parquet spark_catalog.m.catalog_sales[cs_sold_date_sk#17561,cs_quantity#17579,cs_list_price#17581] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#17561)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:double>
         :     :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=47981]
         :     :                    :        +- Project [d_date_sk#17595]
         :     :                    :           +- Filter (((isnotnull(d_year#17601) AND (d_year#17601 >= 1998)) AND (d_year#17601 <= 2000)) AND isnotnull(d_date_sk#17595))
         :     :                    :              +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17595,d_year#17601] Batched: true, DataFilters: [isnotnull(d_year#17601), (d_year#17601 >= 1998), (d_year#17601 <= 2000), isnotnull(d_date_sk#175..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     :                    +- Project [ws_quantity#17641 AS quantity#17383, ws_list_price#17643 AS list_price#17384]
         :     :                       +- BroadcastHashJoin [ws_sold_date_sk#17623], [d_date_sk#17657], Inner, BuildRight, false
         :     :                          :- Filter isnotnull(ws_sold_date_sk#17623)
         :     :                          :  +- FileScan parquet spark_catalog.m.web_sales[ws_sold_date_sk#17623,ws_quantity#17641,ws_list_price#17643] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#17623)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/web_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:double>
         :     :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=47984]
         :     :                             +- Project [d_date_sk#17657]
         :     :                                +- Filter (((isnotnull(d_year#17663) AND (d_year#17663 >= 1998)) AND (d_year#17663 <= 2000)) AND isnotnull(d_date_sk#17657))
         :     :                                   +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17657,d_year#17663] Batched: true, DataFilters: [isnotnull(d_year#17663), (d_year#17663 >= 1998), (d_year#17663 <= 2000), isnotnull(d_date_sk#176..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     +- HashAggregate(keys=[i_brand_id#17715, i_class_id#17717, i_category_id#17719], functions=[sum((cast(ss_quantity#17695 as double) * ss_list_price#17697)), count(1)], output=[i_brand_id#17715, i_class_id#17717, i_category_id#17719, sales#17352, number_sales#17353L])
         :        +- Exchange hashpartitioning(i_brand_id#17715, i_class_id#17717, i_category_id#17719, 200), ENSURE_REQUIREMENTS, [plan_id=48310]
         :           +- HashAggregate(keys=[i_brand_id#17715, i_class_id#17717, i_category_id#17719], functions=[partial_sum((cast(ss_quantity#17695 as double) * ss_list_price#17697)), partial_count(1)], output=[i_brand_id#17715, i_class_id#17717, i_category_id#17719, sum#19721, count#19722L])
         :              +- Project [ss_quantity#17695, ss_list_price#17697, i_brand_id#17715, i_class_id#17717, i_category_id#17719]
         :                 +- BroadcastHashJoin [ss_sold_date_sk#17685], [d_date_sk#17730], Inner, BuildRight, false
         :                    :- Project [ss_sold_date_sk#17685, ss_quantity#17695, ss_list_price#17697, i_brand_id#17715, i_class_id#17717, i_category_id#17719]
         :                    :  +- BroadcastHashJoin [ss_item_sk#17687], [i_item_sk#17708], Inner, BuildRight, false
         :                    :     :- SortMergeJoin [ss_item_sk#17687], [ss_item_sk#17378], LeftSemi
         :                    :     :  :- Sort [ss_item_sk#17687 ASC NULLS FIRST], false, 0
         :                    :     :  :  +- Exchange hashpartitioning(ss_item_sk#17687, 200), ENSURE_REQUIREMENTS, [plan_id=48244]
         :                    :     :  :     +- Filter (isnotnull(ss_item_sk#17687) AND isnotnull(ss_sold_date_sk#17685))
         :                    :     :  :        +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#17685,ss_item_sk#17687,ss_quantity#17695,ss_list_price#17697] Batched: true, DataFilters: [isnotnull(ss_item_sk#17687), isnotnull(ss_sold_date_sk#17685)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:double>
         :                    :     :  +- Sort [ss_item_sk#17378 ASC NULLS FIRST], false, 0
         :                    :     :     +- Exchange hashpartitioning(ss_item_sk#17378, 200), ENSURE_REQUIREMENTS, [plan_id=48245]
         :                    :     :        +- Project [i_item_sk#1271 AS ss_item_sk#17378]
         :                    :     :           +- BroadcastHashJoin [i_brand_id#1278, i_class_id#1280, i_category_id#1282], [brand_id#17375, class_id#17376, category_id#17377], Inner, BuildLeft, false
         :                    :     :              :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [plan_id=48239]
         :                    :     :              :  +- Filter ((isnotnull(i_brand_id#1278) AND isnotnull(i_class_id#1280)) AND isnotnull(i_category_id#1282))
         :                    :     :              :     +- FileScan parquet spark_catalog.m.item[i_item_sk#1271,i_brand_id#1278,i_class_id#1280,i_category_id#1282] Batched: true, DataFilters: [isnotnull(i_brand_id#1278), isnotnull(i_class_id#1280), isnotnull(i_category_id#1282)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :     :              +- SortMergeJoin [coalesce(brand_id#17375, 0), isnull(brand_id#17375), coalesce(class_id#17376, 0), isnull(class_id#17376), coalesce(category_id#17377, 0), isnull(category_id#17377)], [coalesce(i_brand_id#17467, 0), isnull(i_brand_id#17467), coalesce(i_class_id#17469, 0), isnull(i_class_id#17469), coalesce(i_category_id#17471, 0), isnull(i_category_id#17471)], LeftSemi
         :                    :     :                 :- Sort [coalesce(brand_id#17375, 0) ASC NULLS FIRST, isnull(brand_id#17375) ASC NULLS FIRST, coalesce(class_id#17376, 0) ASC NULLS FIRST, isnull(class_id#17376) ASC NULLS FIRST, coalesce(category_id#17377, 0) ASC NULLS FIRST, isnull(category_id#17377) ASC NULLS FIRST], false, 0
         :                    :     :                 :  +- Exchange hashpartitioning(coalesce(brand_id#17375, 0), isnull(brand_id#17375), coalesce(class_id#17376, 0), isnull(class_id#17376), coalesce(category_id#17377, 0), isnull(category_id#17377), 200), ENSURE_REQUIREMENTS, [plan_id=48233]
         :                    :     :                 :     +- HashAggregate(keys=[brand_id#17375, class_id#17376, category_id#17377], functions=[], output=[brand_id#17375, class_id#17376, category_id#17377])
         :                    :     :                 :        +- Exchange hashpartitioning(brand_id#17375, class_id#17376, category_id#17377, 200), ENSURE_REQUIREMENTS, [plan_id=48222]
         :                    :     :                 :           +- HashAggregate(keys=[brand_id#17375, class_id#17376, category_id#17377], functions=[], output=[brand_id#17375, class_id#17376, category_id#17377])
         :                    :     :                 :              +- Project [i_brand_id#17395 AS brand_id#17375, i_class_id#17397 AS class_id#17376, i_category_id#17399 AS category_id#17377]
         :                    :     :                 :                 +- BroadcastHashJoin [ss_sold_date_sk#1248], [d_date_sk#24], Inner, BuildRight, false
         :                    :     :                 :                    :- Project [ss_sold_date_sk#1248, i_brand_id#17395, i_class_id#17397, i_category_id#17399]
         :                    :     :                 :                    :  +- BroadcastHashJoin [ss_item_sk#1250], [i_item_sk#17388], Inner, BuildRight, false
         :                    :     :                 :                    :     :- Filter (isnotnull(ss_item_sk#1250) AND isnotnull(ss_sold_date_sk#1248))
         :                    :     :                 :                    :     :  +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#1248,ss_item_sk#1250] Batched: true, DataFilters: [isnotnull(ss_item_sk#1250), isnotnull(ss_sold_date_sk#1248)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                    :     :                 :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48213]
         :                    :     :                 :                    :        +- SortMergeJoin [coalesce(i_brand_id#17395, 0), isnull(i_brand_id#17395), coalesce(i_class_id#17397, 0), isnull(i_class_id#17397), coalesce(i_category_id#17399, 0), isnull(i_category_id#17399)], [coalesce(i_brand_id#17417, 0), isnull(i_brand_id#17417), coalesce(i_class_id#17419, 0), isnull(i_class_id#17419), coalesce(i_category_id#17421, 0), isnull(i_category_id#17421)], LeftSemi
         :                    :     :                 :                    :           :- Sort [coalesce(i_brand_id#17395, 0) ASC NULLS FIRST, isnull(i_brand_id#17395) ASC NULLS FIRST, coalesce(i_class_id#17397, 0) ASC NULLS FIRST, isnull(i_class_id#17397) ASC NULLS FIRST, coalesce(i_category_id#17399, 0) ASC NULLS FIRST, isnull(i_category_id#17399) ASC NULLS FIRST], false, 0
         :                    :     :                 :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#17395, 0), isnull(i_brand_id#17395), coalesce(i_class_id#17397, 0), isnull(i_class_id#17397), coalesce(i_category_id#17399, 0), isnull(i_category_id#17399), 200), ENSURE_REQUIREMENTS, [plan_id=48207]
         :                    :     :                 :                    :           :     +- Filter (((isnotnull(i_item_sk#17388) AND isnotnull(i_brand_id#17395)) AND isnotnull(i_class_id#17397)) AND isnotnull(i_category_id#17399))
         :                    :     :                 :                    :           :        +- FileScan parquet spark_catalog.m.item[i_item_sk#17388,i_brand_id#17395,i_class_id#17397,i_category_id#17399] Batched: true, DataFilters: [isnotnull(i_item_sk#17388), isnotnull(i_brand_id#17395), isnotnull(i_class_id#17397), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :     :                 :                    :           +- Sort [coalesce(i_brand_id#17417, 0) ASC NULLS FIRST, isnull(i_brand_id#17417) ASC NULLS FIRST, coalesce(i_class_id#17419, 0) ASC NULLS FIRST, isnull(i_class_id#17419) ASC NULLS FIRST, coalesce(i_category_id#17421, 0) ASC NULLS FIRST, isnull(i_category_id#17421) ASC NULLS FIRST], false, 0
         :                    :     :                 :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#17417, 0), isnull(i_brand_id#17417), coalesce(i_class_id#17419, 0), isnull(i_class_id#17419), coalesce(i_category_id#17421, 0), isnull(i_category_id#17421), 200), ENSURE_REQUIREMENTS, [plan_id=48208]
         :                    :     :                 :                    :                 +- Project [i_brand_id#17417, i_class_id#17419, i_category_id#17421]
         :                    :     :                 :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#461], [d_date_sk#17432], Inner, BuildRight, false
         :                    :     :                 :                    :                       :- Project [cs_sold_date_sk#461, i_brand_id#17417, i_class_id#17419, i_category_id#17421]
         :                    :     :                 :                    :                       :  +- BroadcastHashJoin [cs_item_sk#476], [i_item_sk#17410], Inner, BuildRight, false
         :                    :     :                 :                    :                       :     :- Filter (isnotnull(cs_item_sk#476) AND isnotnull(cs_sold_date_sk#461))
         :                    :     :                 :                    :                       :     :  +- FileScan parquet spark_catalog.m.catalog_sales[cs_sold_date_sk#461,cs_item_sk#476] Batched: true, DataFilters: [isnotnull(cs_item_sk#476), isnotnull(cs_sold_date_sk#461)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                    :     :                 :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48198]
         :                    :     :                 :                    :                       :        +- Filter isnotnull(i_item_sk#17410)
         :                    :     :                 :                    :                       :           +- FileScan parquet spark_catalog.m.item[i_item_sk#17410,i_brand_id#17417,i_class_id#17419,i_category_id#17421] Batched: true, DataFilters: [isnotnull(i_item_sk#17410)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :     :                 :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48202]
         :                    :     :                 :                    :                          +- Project [d_date_sk#17432]
         :                    :     :                 :                    :                             +- Filter (((isnotnull(d_year#17438) AND (d_year#17438 >= 1998)) AND (d_year#17438 <= 2000)) AND isnotnull(d_date_sk#17432))
         :                    :     :                 :                    :                                +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17432,d_year#17438] Batched: true, DataFilters: [isnotnull(d_year#17438), (d_year#17438 >= 1998), (d_year#17438 <= 2000), isnotnull(d_date_sk#174..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :     :                 :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48217]
         :                    :     :                 :                       +- Project [d_date_sk#24]
         :                    :     :                 :                          +- Filter (((isnotnull(d_year#30) AND (d_year#30 >= 1998)) AND (d_year#30 <= 2000)) AND isnotnull(d_date_sk#24))
         :                    :     :                 :                             +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#24,d_year#30] Batched: true, DataFilters: [isnotnull(d_year#30), (d_year#30 >= 1998), (d_year#30 <= 2000), isnotnull(d_date_sk#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :     :                 +- Sort [coalesce(i_brand_id#17467, 0) ASC NULLS FIRST, isnull(i_brand_id#17467) ASC NULLS FIRST, coalesce(i_class_id#17469, 0) ASC NULLS FIRST, isnull(i_class_id#17469) ASC NULLS FIRST, coalesce(i_category_id#17471, 0) ASC NULLS FIRST, isnull(i_category_id#17471) ASC NULLS FIRST], false, 0
         :                    :     :                    +- Exchange hashpartitioning(coalesce(i_brand_id#17467, 0), isnull(i_brand_id#17467), coalesce(i_class_id#17469, 0), isnull(i_class_id#17469), coalesce(i_category_id#17471, 0), isnull(i_category_id#17471), 200), ENSURE_REQUIREMENTS, [plan_id=48234]
         :                    :     :                       +- Project [i_brand_id#17467, i_class_id#17469, i_category_id#17471]
         :                    :     :                          +- BroadcastHashJoin [ws_sold_date_sk#427], [d_date_sk#17482], Inner, BuildRight, false
         :                    :     :                             :- Project [ws_sold_date_sk#427, i_brand_id#17467, i_class_id#17469, i_category_id#17471]
         :                    :     :                             :  +- BroadcastHashJoin [ws_item_sk#430], [i_item_sk#17460], Inner, BuildRight, false
         :                    :     :                             :     :- Filter (isnotnull(ws_item_sk#430) AND isnotnull(ws_sold_date_sk#427))
         :                    :     :                             :     :  +- FileScan parquet spark_catalog.m.web_sales[ws_sold_date_sk#427,ws_item_sk#430] Batched: true, DataFilters: [isnotnull(ws_item_sk#430), isnotnull(ws_sold_date_sk#427)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/web_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                    :     :                             :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48224]
         :                    :     :                             :        +- Filter isnotnull(i_item_sk#17460)
         :                    :     :                             :           +- FileScan parquet spark_catalog.m.item[i_item_sk#17460,i_brand_id#17467,i_class_id#17469,i_category_id#17471] Batched: true, DataFilters: [isnotnull(i_item_sk#17460)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48228]
         :                    :     :                                +- Project [d_date_sk#17482]
         :                    :     :                                   +- Filter (((isnotnull(d_year#17488) AND (d_year#17488 >= 1998)) AND (d_year#17488 <= 2000)) AND isnotnull(d_date_sk#17482))
         :                    :     :                                      +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17482,d_year#17488] Batched: true, DataFilters: [isnotnull(d_year#17488), (d_year#17488 >= 1998), (d_year#17488 <= 2000), isnotnull(d_date_sk#174..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48301]
         :                    :        +- SortMergeJoin [i_item_sk#17708], [ss_item_sk#17378], LeftSemi
         :                    :           :- Sort [i_item_sk#17708 ASC NULLS FIRST], false, 0
         :                    :           :  +- Exchange hashpartitioning(i_item_sk#17708, 200), ENSURE_REQUIREMENTS, [plan_id=48295]
         :                    :           :     +- Filter (((isnotnull(i_item_sk#17708) AND isnotnull(i_brand_id#17715)) AND isnotnull(i_class_id#17717)) AND isnotnull(i_category_id#17719))
         :                    :           :        +- FileScan parquet spark_catalog.m.item[i_item_sk#17708,i_brand_id#17715,i_class_id#17717,i_category_id#17719] Batched: true, DataFilters: [isnotnull(i_item_sk#17708), isnotnull(i_brand_id#17715), isnotnull(i_class_id#17717), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           +- Sort [ss_item_sk#17378 ASC NULLS FIRST], false, 0
         :                    :              +- Exchange hashpartitioning(ss_item_sk#17378, 200), ENSURE_REQUIREMENTS, [plan_id=48296]
         :                    :                 +- Project [i_item_sk#1271 AS ss_item_sk#17378]
         :                    :                    +- BroadcastHashJoin [i_brand_id#1278, i_class_id#1280, i_category_id#1282], [brand_id#17375, class_id#17376, category_id#17377], Inner, BuildLeft, false
         :                    :                       :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [plan_id=48290]
         :                    :                       :  +- Filter ((isnotnull(i_brand_id#1278) AND isnotnull(i_class_id#1280)) AND isnotnull(i_category_id#1282))
         :                    :                       :     +- FileScan parquet spark_catalog.m.item[i_item_sk#1271,i_brand_id#1278,i_class_id#1280,i_category_id#1282] Batched: true, DataFilters: [isnotnull(i_brand_id#1278), isnotnull(i_class_id#1280), isnotnull(i_category_id#1282)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                       +- SortMergeJoin [coalesce(brand_id#17375, 0), isnull(brand_id#17375), coalesce(class_id#17376, 0), isnull(class_id#17376), coalesce(category_id#17377, 0), isnull(category_id#17377)], [coalesce(i_brand_id#17467, 0), isnull(i_brand_id#17467), coalesce(i_class_id#17469, 0), isnull(i_class_id#17469), coalesce(i_category_id#17471, 0), isnull(i_category_id#17471)], LeftSemi
         :                    :                          :- Sort [coalesce(brand_id#17375, 0) ASC NULLS FIRST, isnull(brand_id#17375) ASC NULLS FIRST, coalesce(class_id#17376, 0) ASC NULLS FIRST, isnull(class_id#17376) ASC NULLS FIRST, coalesce(category_id#17377, 0) ASC NULLS FIRST, isnull(category_id#17377) ASC NULLS FIRST], false, 0
         :                    :                          :  +- Exchange hashpartitioning(coalesce(brand_id#17375, 0), isnull(brand_id#17375), coalesce(class_id#17376, 0), isnull(class_id#17376), coalesce(category_id#17377, 0), isnull(category_id#17377), 200), ENSURE_REQUIREMENTS, [plan_id=48284]
         :                    :                          :     +- HashAggregate(keys=[brand_id#17375, class_id#17376, category_id#17377], functions=[], output=[brand_id#17375, class_id#17376, category_id#17377])
         :                    :                          :        +- Exchange hashpartitioning(brand_id#17375, class_id#17376, category_id#17377, 200), ENSURE_REQUIREMENTS, [plan_id=48273]
         :                    :                          :           +- HashAggregate(keys=[brand_id#17375, class_id#17376, category_id#17377], functions=[], output=[brand_id#17375, class_id#17376, category_id#17377])
         :                    :                          :              +- Project [i_brand_id#17395 AS brand_id#17375, i_class_id#17397 AS class_id#17376, i_category_id#17399 AS category_id#17377]
         :                    :                          :                 +- BroadcastHashJoin [ss_sold_date_sk#1248], [d_date_sk#24], Inner, BuildRight, false
         :                    :                          :                    :- Project [ss_sold_date_sk#1248, i_brand_id#17395, i_class_id#17397, i_category_id#17399]
         :                    :                          :                    :  +- BroadcastHashJoin [ss_item_sk#1250], [i_item_sk#17388], Inner, BuildRight, false
         :                    :                          :                    :     :- Filter (isnotnull(ss_item_sk#1250) AND isnotnull(ss_sold_date_sk#1248))
         :                    :                          :                    :     :  +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#1248,ss_item_sk#1250] Batched: true, DataFilters: [isnotnull(ss_item_sk#1250), isnotnull(ss_sold_date_sk#1248)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                    :                          :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48264]
         :                    :                          :                    :        +- SortMergeJoin [coalesce(i_brand_id#17395, 0), isnull(i_brand_id#17395), coalesce(i_class_id#17397, 0), isnull(i_class_id#17397), coalesce(i_category_id#17399, 0), isnull(i_category_id#17399)], [coalesce(i_brand_id#17417, 0), isnull(i_brand_id#17417), coalesce(i_class_id#17419, 0), isnull(i_class_id#17419), coalesce(i_category_id#17421, 0), isnull(i_category_id#17421)], LeftSemi
         :                    :                          :                    :           :- Sort [coalesce(i_brand_id#17395, 0) ASC NULLS FIRST, isnull(i_brand_id#17395) ASC NULLS FIRST, coalesce(i_class_id#17397, 0) ASC NULLS FIRST, isnull(i_class_id#17397) ASC NULLS FIRST, coalesce(i_category_id#17399, 0) ASC NULLS FIRST, isnull(i_category_id#17399) ASC NULLS FIRST], false, 0
         :                    :                          :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#17395, 0), isnull(i_brand_id#17395), coalesce(i_class_id#17397, 0), isnull(i_class_id#17397), coalesce(i_category_id#17399, 0), isnull(i_category_id#17399), 200), ENSURE_REQUIREMENTS, [plan_id=48258]
         :                    :                          :                    :           :     +- Filter (((isnotnull(i_item_sk#17388) AND isnotnull(i_brand_id#17395)) AND isnotnull(i_class_id#17397)) AND isnotnull(i_category_id#17399))
         :                    :                          :                    :           :        +- FileScan parquet spark_catalog.m.item[i_item_sk#17388,i_brand_id#17395,i_class_id#17397,i_category_id#17399] Batched: true, DataFilters: [isnotnull(i_item_sk#17388), isnotnull(i_brand_id#17395), isnotnull(i_class_id#17397), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                          :                    :           +- Sort [coalesce(i_brand_id#17417, 0) ASC NULLS FIRST, isnull(i_brand_id#17417) ASC NULLS FIRST, coalesce(i_class_id#17419, 0) ASC NULLS FIRST, isnull(i_class_id#17419) ASC NULLS FIRST, coalesce(i_category_id#17421, 0) ASC NULLS FIRST, isnull(i_category_id#17421) ASC NULLS FIRST], false, 0
         :                    :                          :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#17417, 0), isnull(i_brand_id#17417), coalesce(i_class_id#17419, 0), isnull(i_class_id#17419), coalesce(i_category_id#17421, 0), isnull(i_category_id#17421), 200), ENSURE_REQUIREMENTS, [plan_id=48259]
         :                    :                          :                    :                 +- Project [i_brand_id#17417, i_class_id#17419, i_category_id#17421]
         :                    :                          :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#461], [d_date_sk#17432], Inner, BuildRight, false
         :                    :                          :                    :                       :- Project [cs_sold_date_sk#461, i_brand_id#17417, i_class_id#17419, i_category_id#17421]
         :                    :                          :                    :                       :  +- BroadcastHashJoin [cs_item_sk#476], [i_item_sk#17410], Inner, BuildRight, false
         :                    :                          :                    :                       :     :- Filter (isnotnull(cs_item_sk#476) AND isnotnull(cs_sold_date_sk#461))
         :                    :                          :                    :                       :     :  +- FileScan parquet spark_catalog.m.catalog_sales[cs_sold_date_sk#461,cs_item_sk#476] Batched: true, DataFilters: [isnotnull(cs_item_sk#476), isnotnull(cs_sold_date_sk#461)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                    :                          :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48249]
         :                    :                          :                    :                       :        +- Filter isnotnull(i_item_sk#17410)
         :                    :                          :                    :                       :           +- FileScan parquet spark_catalog.m.item[i_item_sk#17410,i_brand_id#17417,i_class_id#17419,i_category_id#17421] Batched: true, DataFilters: [isnotnull(i_item_sk#17410)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                          :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48253]
         :                    :                          :                    :                          +- Project [d_date_sk#17432]
         :                    :                          :                    :                             +- Filter (((isnotnull(d_year#17438) AND (d_year#17438 >= 1998)) AND (d_year#17438 <= 2000)) AND isnotnull(d_date_sk#17432))
         :                    :                          :                    :                                +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17432,d_year#17438] Batched: true, DataFilters: [isnotnull(d_year#17438), (d_year#17438 >= 1998), (d_year#17438 <= 2000), isnotnull(d_date_sk#174..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :                          :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48268]
         :                    :                          :                       +- Project [d_date_sk#24]
         :                    :                          :                          +- Filter (((isnotnull(d_year#30) AND (d_year#30 >= 1998)) AND (d_year#30 <= 2000)) AND isnotnull(d_date_sk#24))
         :                    :                          :                             +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#24,d_year#30] Batched: true, DataFilters: [isnotnull(d_year#30), (d_year#30 >= 1998), (d_year#30 <= 2000), isnotnull(d_date_sk#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :                          +- Sort [coalesce(i_brand_id#17467, 0) ASC NULLS FIRST, isnull(i_brand_id#17467) ASC NULLS FIRST, coalesce(i_class_id#17469, 0) ASC NULLS FIRST, isnull(i_class_id#17469) ASC NULLS FIRST, coalesce(i_category_id#17471, 0) ASC NULLS FIRST, isnull(i_category_id#17471) ASC NULLS FIRST], false, 0
         :                    :                             +- Exchange hashpartitioning(coalesce(i_brand_id#17467, 0), isnull(i_brand_id#17467), coalesce(i_class_id#17469, 0), isnull(i_class_id#17469), coalesce(i_category_id#17471, 0), isnull(i_category_id#17471), 200), ENSURE_REQUIREMENTS, [plan_id=48285]
         :                    :                                +- Project [i_brand_id#17467, i_class_id#17469, i_category_id#17471]
         :                    :                                   +- BroadcastHashJoin [ws_sold_date_sk#427], [d_date_sk#17482], Inner, BuildRight, false
         :                    :                                      :- Project [ws_sold_date_sk#427, i_brand_id#17467, i_class_id#17469, i_category_id#17471]
         :                    :                                      :  +- BroadcastHashJoin [ws_item_sk#430], [i_item_sk#17460], Inner, BuildRight, false
         :                    :                                      :     :- Filter (isnotnull(ws_item_sk#430) AND isnotnull(ws_sold_date_sk#427))
         :                    :                                      :     :  +- FileScan parquet spark_catalog.m.web_sales[ws_sold_date_sk#427,ws_item_sk#430] Batched: true, DataFilters: [isnotnull(ws_item_sk#430), isnotnull(ws_sold_date_sk#427)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/web_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                    :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48275]
         :                    :                                      :        +- Filter isnotnull(i_item_sk#17460)
         :                    :                                      :           +- FileScan parquet spark_catalog.m.item[i_item_sk#17460,i_brand_id#17467,i_class_id#17469,i_category_id#17471] Batched: true, DataFilters: [isnotnull(i_item_sk#17460)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48279]
         :                    :                                         +- Project [d_date_sk#17482]
         :                    :                                            +- Filter (((isnotnull(d_year#17488) AND (d_year#17488 >= 1998)) AND (d_year#17488 <= 2000)) AND isnotnull(d_date_sk#17482))
         :                    :                                               +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17482,d_year#17488] Batched: true, DataFilters: [isnotnull(d_year#17488), (d_year#17488 >= 1998), (d_year#17488 <= 2000), isnotnull(d_date_sk#174..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48305]
         :                       +- Project [d_date_sk#17730]
         :                          +- Filter ((isnotnull(d_week_seq#17734) AND (d_week_seq#17734 = Subquery subquery#17355, [id=#48083])) AND isnotnull(d_date_sk#17730))
         :                             :  +- Subquery subquery#17355, [id=#48083]
         :                             :     +- AdaptiveSparkPlan isFinalPlan=false
         :                             :        +- Project [d_week_seq#17846]
         :                             :           +- Filter (((((isnotnull(d_year#17848) AND isnotnull(d_moy#17850)) AND isnotnull(d_dom#17851)) AND (d_year#17848 = 1999)) AND (d_moy#17850 = 12)) AND (d_dom#17851 = 20))
         :                             :              +- FileScan parquet spark_catalog.m.date_dim[d_week_seq#17846,d_year#17848,d_moy#17850,d_dom#17851] Batched: true, DataFilters: [isnotnull(d_year#17848), isnotnull(d_moy#17850), isnotnull(d_dom#17851), (d_year#17848 = 1999), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
         :                             +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17730,d_week_seq#17734] Batched: true, DataFilters: [isnotnull(d_week_seq#17734), isnotnull(d_date_sk#17730)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
         +- Sort [i_brand_id#17788 ASC NULLS FIRST, i_class_id#17790 ASC NULLS FIRST, i_category_id#17792 ASC NULLS FIRST], false, 0
            +- Filter (isnotnull(sales#17358) AND (sales#17358 > Subquery subquery#17362, [id=#48091]))
               :  +- Subquery subquery#17362, [id=#48091]
               :     +- AdaptiveSparkPlan isFinalPlan=false
               :        +- HashAggregate(keys=[], functions=[avg((cast(quantity#17379 as double) * list_price#17380))], output=[average_sales#17385])
               :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=48074]
               :              +- HashAggregate(keys=[], functions=[partial_avg((cast(quantity#17379 as double) * list_price#17380))], output=[sum#19729, count#19730L])
               :                 +- Union
               :                    :- Project [ss_quantity#17520 AS quantity#17379, ss_list_price#17522 AS list_price#17380]
               :                    :  +- BroadcastHashJoin [ss_sold_date_sk#17510], [d_date_sk#17533], Inner, BuildRight, false
               :                    :     :- Filter isnotnull(ss_sold_date_sk#17510)
               :                    :     :  +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#17510,ss_quantity#17520,ss_list_price#17522] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#17510)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:double>
               :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48062]
               :                    :        +- Project [d_date_sk#17533]
               :                    :           +- Filter (((isnotnull(d_year#17539) AND (d_year#17539 >= 1998)) AND (d_year#17539 <= 2000)) AND isnotnull(d_date_sk#17533))
               :                    :              +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17533,d_year#17539] Batched: true, DataFilters: [isnotnull(d_year#17539), (d_year#17539 >= 1998), (d_year#17539 <= 2000), isnotnull(d_date_sk#175..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :- Project [cs_quantity#17579 AS quantity#17381, cs_list_price#17581 AS list_price#17382]
               :                    :  +- BroadcastHashJoin [cs_sold_date_sk#17561], [d_date_sk#17595], Inner, BuildRight, false
               :                    :     :- Filter isnotnull(cs_sold_date_sk#17561)
               :                    :     :  +- FileScan parquet spark_catalog.m.catalog_sales[cs_sold_date_sk#17561,cs_quantity#17579,cs_list_price#17581] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#17561)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:double>
               :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48065]
               :                    :        +- Project [d_date_sk#17595]
               :                    :           +- Filter (((isnotnull(d_year#17601) AND (d_year#17601 >= 1998)) AND (d_year#17601 <= 2000)) AND isnotnull(d_date_sk#17595))
               :                    :              +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17595,d_year#17601] Batched: true, DataFilters: [isnotnull(d_year#17601), (d_year#17601 >= 1998), (d_year#17601 <= 2000), isnotnull(d_date_sk#175..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    +- Project [ws_quantity#17641 AS quantity#17383, ws_list_price#17643 AS list_price#17384]
               :                       +- BroadcastHashJoin [ws_sold_date_sk#17623], [d_date_sk#17657], Inner, BuildRight, false
               :                          :- Filter isnotnull(ws_sold_date_sk#17623)
               :                          :  +- FileScan parquet spark_catalog.m.web_sales[ws_sold_date_sk#17623,ws_quantity#17641,ws_list_price#17643] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#17623)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/web_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:double>
               :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48068]
               :                             +- Project [d_date_sk#17657]
               :                                +- Filter (((isnotnull(d_year#17663) AND (d_year#17663 >= 1998)) AND (d_year#17663 <= 2000)) AND isnotnull(d_date_sk#17657))
               :                                   +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17657,d_year#17663] Batched: true, DataFilters: [isnotnull(d_year#17663), (d_year#17663 >= 1998), (d_year#17663 <= 2000), isnotnull(d_date_sk#176..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               +- HashAggregate(keys=[i_brand_id#17788, i_class_id#17790, i_category_id#17792], functions=[sum((cast(ss_quantity#17768 as double) * ss_list_price#17770)), count(1)], output=[i_brand_id#17788, i_class_id#17790, i_category_id#17792, sales#17358, number_sales#17359L])
                  +- Exchange hashpartitioning(i_brand_id#17788, i_class_id#17790, i_category_id#17792, 200), ENSURE_REQUIREMENTS, [plan_id=48425]
                     +- HashAggregate(keys=[i_brand_id#17788, i_class_id#17790, i_category_id#17792], functions=[partial_sum((cast(ss_quantity#17768 as double) * ss_list_price#17770)), partial_count(1)], output=[i_brand_id#17788, i_class_id#17790, i_category_id#17792, sum#19725, count#19726L])
                        +- Project [ss_quantity#17768, ss_list_price#17770, i_brand_id#17788, i_class_id#17790, i_category_id#17792]
                           +- BroadcastHashJoin [ss_sold_date_sk#17758], [d_date_sk#17803], Inner, BuildRight, false
                              :- Project [ss_sold_date_sk#17758, ss_quantity#17768, ss_list_price#17770, i_brand_id#17788, i_class_id#17790, i_category_id#17792]
                              :  +- BroadcastHashJoin [ss_item_sk#17760], [i_item_sk#17781], Inner, BuildRight, false
                              :     :- SortMergeJoin [ss_item_sk#17760], [ss_item_sk#17870], LeftSemi
                              :     :  :- Sort [ss_item_sk#17760 ASC NULLS FIRST], false, 0
                              :     :  :  +- Exchange hashpartitioning(ss_item_sk#17760, 200), ENSURE_REQUIREMENTS, [plan_id=48359]
                              :     :  :     +- Filter (isnotnull(ss_item_sk#17760) AND isnotnull(ss_sold_date_sk#17758))
                              :     :  :        +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#17758,ss_item_sk#17760,ss_quantity#17768,ss_list_price#17770] Batched: true, DataFilters: [isnotnull(ss_item_sk#17760), isnotnull(ss_sold_date_sk#17758)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:double>
                              :     :  +- Sort [ss_item_sk#17870 ASC NULLS FIRST], false, 0
                              :     :     +- Exchange hashpartitioning(ss_item_sk#17870, 200), ENSURE_REQUIREMENTS, [plan_id=48360]
                              :     :        +- Project [i_item_sk#19784 AS ss_item_sk#17870]
                              :     :           +- BroadcastHashJoin [i_brand_id#19791, i_class_id#19793, i_category_id#19795], [brand_id#17375, class_id#17376, category_id#17377], Inner, BuildLeft, false
                              :     :              :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [plan_id=48354]
                              :     :              :  +- Filter ((isnotnull(i_brand_id#19791) AND isnotnull(i_class_id#19793)) AND isnotnull(i_category_id#19795))
                              :     :              :     +- FileScan parquet spark_catalog.m.item[i_item_sk#19784,i_brand_id#19791,i_class_id#19793,i_category_id#19795] Batched: true, DataFilters: [isnotnull(i_brand_id#19791), isnotnull(i_class_id#19793), isnotnull(i_category_id#19795)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :     :              +- SortMergeJoin [coalesce(brand_id#17375, 0), isnull(brand_id#17375), coalesce(class_id#17376, 0), isnull(class_id#17376), coalesce(category_id#17377, 0), isnull(category_id#17377)], [coalesce(i_brand_id#20004, 0), isnull(i_brand_id#20004), coalesce(i_class_id#20006, 0), isnull(i_class_id#20006), coalesce(i_category_id#20008, 0), isnull(i_category_id#20008)], LeftSemi
                              :     :                 :- Sort [coalesce(brand_id#17375, 0) ASC NULLS FIRST, isnull(brand_id#17375) ASC NULLS FIRST, coalesce(class_id#17376, 0) ASC NULLS FIRST, isnull(class_id#17376) ASC NULLS FIRST, coalesce(category_id#17377, 0) ASC NULLS FIRST, isnull(category_id#17377) ASC NULLS FIRST], false, 0
                              :     :                 :  +- Exchange hashpartitioning(coalesce(brand_id#17375, 0), isnull(brand_id#17375), coalesce(class_id#17376, 0), isnull(class_id#17376), coalesce(category_id#17377, 0), isnull(category_id#17377), 200), ENSURE_REQUIREMENTS, [plan_id=48348]
                              :     :                 :     +- HashAggregate(keys=[brand_id#17375, class_id#17376, category_id#17377], functions=[], output=[brand_id#17375, class_id#17376, category_id#17377])
                              :     :                 :        +- Exchange hashpartitioning(brand_id#17375, class_id#17376, category_id#17377, 200), ENSURE_REQUIREMENTS, [plan_id=48337]
                              :     :                 :           +- HashAggregate(keys=[brand_id#17375, class_id#17376, category_id#17377], functions=[], output=[brand_id#17375, class_id#17376, category_id#17377])
                              :     :                 :              +- Project [i_brand_id#19836 AS brand_id#17375, i_class_id#19838 AS class_id#17376, i_category_id#19840 AS category_id#17377]
                              :     :                 :                 +- BroadcastHashJoin [ss_sold_date_sk#19806], [d_date_sk#19851], Inner, BuildRight, false
                              :     :                 :                    :- Project [ss_sold_date_sk#19806, i_brand_id#19836, i_class_id#19838, i_category_id#19840]
                              :     :                 :                    :  +- BroadcastHashJoin [ss_item_sk#19808], [i_item_sk#19829], Inner, BuildRight, false
                              :     :                 :                    :     :- Filter (isnotnull(ss_item_sk#19808) AND isnotnull(ss_sold_date_sk#19806))
                              :     :                 :                    :     :  +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#19806,ss_item_sk#19808] Batched: true, DataFilters: [isnotnull(ss_item_sk#19808), isnotnull(ss_sold_date_sk#19806)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                              :     :                 :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48328]
                              :     :                 :                    :        +- SortMergeJoin [coalesce(i_brand_id#19836, 0), isnull(i_brand_id#19836), coalesce(i_class_id#19838, 0), isnull(i_class_id#19838), coalesce(i_category_id#19840, 0), isnull(i_category_id#19840)], [coalesce(i_brand_id#19920, 0), isnull(i_brand_id#19920), coalesce(i_class_id#19922, 0), isnull(i_class_id#19922), coalesce(i_category_id#19924, 0), isnull(i_category_id#19924)], LeftSemi
                              :     :                 :                    :           :- Sort [coalesce(i_brand_id#19836, 0) ASC NULLS FIRST, isnull(i_brand_id#19836) ASC NULLS FIRST, coalesce(i_class_id#19838, 0) ASC NULLS FIRST, isnull(i_class_id#19838) ASC NULLS FIRST, coalesce(i_category_id#19840, 0) ASC NULLS FIRST, isnull(i_category_id#19840) ASC NULLS FIRST], false, 0
                              :     :                 :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#19836, 0), isnull(i_brand_id#19836), coalesce(i_class_id#19838, 0), isnull(i_class_id#19838), coalesce(i_category_id#19840, 0), isnull(i_category_id#19840), 200), ENSURE_REQUIREMENTS, [plan_id=48322]
                              :     :                 :                    :           :     +- Filter (((isnotnull(i_item_sk#19829) AND isnotnull(i_brand_id#19836)) AND isnotnull(i_class_id#19838)) AND isnotnull(i_category_id#19840))
                              :     :                 :                    :           :        +- FileScan parquet spark_catalog.m.item[i_item_sk#19829,i_brand_id#19836,i_class_id#19838,i_category_id#19840] Batched: true, DataFilters: [isnotnull(i_item_sk#19829), isnotnull(i_brand_id#19836), isnotnull(i_class_id#19838), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :     :                 :                    :           +- Sort [coalesce(i_brand_id#19920, 0) ASC NULLS FIRST, isnull(i_brand_id#19920) ASC NULLS FIRST, coalesce(i_class_id#19922, 0) ASC NULLS FIRST, isnull(i_class_id#19922) ASC NULLS FIRST, coalesce(i_category_id#19924, 0) ASC NULLS FIRST, isnull(i_category_id#19924) ASC NULLS FIRST], false, 0
                              :     :                 :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#19920, 0), isnull(i_brand_id#19920), coalesce(i_class_id#19922, 0), isnull(i_class_id#19922), coalesce(i_category_id#19924, 0), isnull(i_category_id#19924), 200), ENSURE_REQUIREMENTS, [plan_id=48323]
                              :     :                 :                    :                 +- Project [i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                              :     :                 :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#19879], [d_date_sk#19935], Inner, BuildRight, false
                              :     :                 :                    :                       :- Project [cs_sold_date_sk#19879, i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                              :     :                 :                    :                       :  +- BroadcastHashJoin [cs_item_sk#19894], [i_item_sk#19913], Inner, BuildRight, false
                              :     :                 :                    :                       :     :- Filter (isnotnull(cs_item_sk#19894) AND isnotnull(cs_sold_date_sk#19879))
                              :     :                 :                    :                       :     :  +- FileScan parquet spark_catalog.m.catalog_sales[cs_sold_date_sk#19879,cs_item_sk#19894] Batched: true, DataFilters: [isnotnull(cs_item_sk#19894), isnotnull(cs_sold_date_sk#19879)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                              :     :                 :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48313]
                              :     :                 :                    :                       :        +- Filter isnotnull(i_item_sk#19913)
                              :     :                 :                    :                       :           +- FileScan parquet spark_catalog.m.item[i_item_sk#19913,i_brand_id#19920,i_class_id#19922,i_category_id#19924] Batched: true, DataFilters: [isnotnull(i_item_sk#19913)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :     :                 :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48317]
                              :     :                 :                    :                          +- Project [d_date_sk#19935]
                              :     :                 :                    :                             +- Filter (((isnotnull(d_year#19941) AND (d_year#19941 >= 1998)) AND (d_year#19941 <= 2000)) AND isnotnull(d_date_sk#19935))
                              :     :                 :                    :                                +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#19935,d_year#19941] Batched: true, DataFilters: [isnotnull(d_year#19941), (d_year#19941 >= 1998), (d_year#19941 <= 2000), isnotnull(d_date_sk#199..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     :                 :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48332]
                              :     :                 :                       +- Project [d_date_sk#19851]
                              :     :                 :                          +- Filter (((isnotnull(d_year#19857) AND (d_year#19857 >= 1998)) AND (d_year#19857 <= 2000)) AND isnotnull(d_date_sk#19851))
                              :     :                 :                             +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#19851,d_year#19857] Batched: true, DataFilters: [isnotnull(d_year#19857), (d_year#19857 >= 1998), (d_year#19857 <= 2000), isnotnull(d_date_sk#198..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     :                 +- Sort [coalesce(i_brand_id#20004, 0) ASC NULLS FIRST, isnull(i_brand_id#20004) ASC NULLS FIRST, coalesce(i_class_id#20006, 0) ASC NULLS FIRST, isnull(i_class_id#20006) ASC NULLS FIRST, coalesce(i_category_id#20008, 0) ASC NULLS FIRST, isnull(i_category_id#20008) ASC NULLS FIRST], false, 0
                              :     :                    +- Exchange hashpartitioning(coalesce(i_brand_id#20004, 0), isnull(i_brand_id#20004), coalesce(i_class_id#20006, 0), isnull(i_class_id#20006), coalesce(i_category_id#20008, 0), isnull(i_category_id#20008), 200), ENSURE_REQUIREMENTS, [plan_id=48349]
                              :     :                       +- Project [i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                              :     :                          +- BroadcastHashJoin [ws_sold_date_sk#19963], [d_date_sk#20019], Inner, BuildRight, false
                              :     :                             :- Project [ws_sold_date_sk#19963, i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                              :     :                             :  +- BroadcastHashJoin [ws_item_sk#19966], [i_item_sk#19997], Inner, BuildRight, false
                              :     :                             :     :- Filter (isnotnull(ws_item_sk#19966) AND isnotnull(ws_sold_date_sk#19963))
                              :     :                             :     :  +- FileScan parquet spark_catalog.m.web_sales[ws_sold_date_sk#19963,ws_item_sk#19966] Batched: true, DataFilters: [isnotnull(ws_item_sk#19966), isnotnull(ws_sold_date_sk#19963)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/web_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                              :     :                             :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48339]
                              :     :                             :        +- Filter isnotnull(i_item_sk#19997)
                              :     :                             :           +- FileScan parquet spark_catalog.m.item[i_item_sk#19997,i_brand_id#20004,i_class_id#20006,i_category_id#20008] Batched: true, DataFilters: [isnotnull(i_item_sk#19997)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48343]
                              :     :                                +- Project [d_date_sk#20019]
                              :     :                                   +- Filter (((isnotnull(d_year#20025) AND (d_year#20025 >= 1998)) AND (d_year#20025 <= 2000)) AND isnotnull(d_date_sk#20019))
                              :     :                                      +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#20019,d_year#20025] Batched: true, DataFilters: [isnotnull(d_year#20025), (d_year#20025 >= 1998), (d_year#20025 <= 2000), isnotnull(d_date_sk#200..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48416]
                              :        +- SortMergeJoin [i_item_sk#17781], [ss_item_sk#17870], LeftSemi
                              :           :- Sort [i_item_sk#17781 ASC NULLS FIRST], false, 0
                              :           :  +- Exchange hashpartitioning(i_item_sk#17781, 200), ENSURE_REQUIREMENTS, [plan_id=48410]
                              :           :     +- Filter (((isnotnull(i_item_sk#17781) AND isnotnull(i_brand_id#17788)) AND isnotnull(i_class_id#17790)) AND isnotnull(i_category_id#17792))
                              :           :        +- FileScan parquet spark_catalog.m.item[i_item_sk#17781,i_brand_id#17788,i_class_id#17790,i_category_id#17792] Batched: true, DataFilters: [isnotnull(i_item_sk#17781), isnotnull(i_brand_id#17788), isnotnull(i_class_id#17790), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           +- Sort [ss_item_sk#17870 ASC NULLS FIRST], false, 0
                              :              +- Exchange hashpartitioning(ss_item_sk#17870, 200), ENSURE_REQUIREMENTS, [plan_id=48411]
                              :                 +- Project [i_item_sk#19784 AS ss_item_sk#17870]
                              :                    +- BroadcastHashJoin [i_brand_id#19791, i_class_id#19793, i_category_id#19795], [brand_id#17375, class_id#17376, category_id#17377], Inner, BuildLeft, false
                              :                       :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [plan_id=48405]
                              :                       :  +- Filter ((isnotnull(i_brand_id#19791) AND isnotnull(i_class_id#19793)) AND isnotnull(i_category_id#19795))
                              :                       :     +- FileScan parquet spark_catalog.m.item[i_item_sk#19784,i_brand_id#19791,i_class_id#19793,i_category_id#19795] Batched: true, DataFilters: [isnotnull(i_brand_id#19791), isnotnull(i_class_id#19793), isnotnull(i_category_id#19795)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                       +- SortMergeJoin [coalesce(brand_id#17375, 0), isnull(brand_id#17375), coalesce(class_id#17376, 0), isnull(class_id#17376), coalesce(category_id#17377, 0), isnull(category_id#17377)], [coalesce(i_brand_id#20004, 0), isnull(i_brand_id#20004), coalesce(i_class_id#20006, 0), isnull(i_class_id#20006), coalesce(i_category_id#20008, 0), isnull(i_category_id#20008)], LeftSemi
                              :                          :- Sort [coalesce(brand_id#17375, 0) ASC NULLS FIRST, isnull(brand_id#17375) ASC NULLS FIRST, coalesce(class_id#17376, 0) ASC NULLS FIRST, isnull(class_id#17376) ASC NULLS FIRST, coalesce(category_id#17377, 0) ASC NULLS FIRST, isnull(category_id#17377) ASC NULLS FIRST], false, 0
                              :                          :  +- Exchange hashpartitioning(coalesce(brand_id#17375, 0), isnull(brand_id#17375), coalesce(class_id#17376, 0), isnull(class_id#17376), coalesce(category_id#17377, 0), isnull(category_id#17377), 200), ENSURE_REQUIREMENTS, [plan_id=48399]
                              :                          :     +- HashAggregate(keys=[brand_id#17375, class_id#17376, category_id#17377], functions=[], output=[brand_id#17375, class_id#17376, category_id#17377])
                              :                          :        +- Exchange hashpartitioning(brand_id#17375, class_id#17376, category_id#17377, 200), ENSURE_REQUIREMENTS, [plan_id=48388]
                              :                          :           +- HashAggregate(keys=[brand_id#17375, class_id#17376, category_id#17377], functions=[], output=[brand_id#17375, class_id#17376, category_id#17377])
                              :                          :              +- Project [i_brand_id#19836 AS brand_id#17375, i_class_id#19838 AS class_id#17376, i_category_id#19840 AS category_id#17377]
                              :                          :                 +- BroadcastHashJoin [ss_sold_date_sk#19806], [d_date_sk#19851], Inner, BuildRight, false
                              :                          :                    :- Project [ss_sold_date_sk#19806, i_brand_id#19836, i_class_id#19838, i_category_id#19840]
                              :                          :                    :  +- BroadcastHashJoin [ss_item_sk#19808], [i_item_sk#19829], Inner, BuildRight, false
                              :                          :                    :     :- Filter (isnotnull(ss_item_sk#19808) AND isnotnull(ss_sold_date_sk#19806))
                              :                          :                    :     :  +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#19806,ss_item_sk#19808] Batched: true, DataFilters: [isnotnull(ss_item_sk#19808), isnotnull(ss_sold_date_sk#19806)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                              :                          :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48379]
                              :                          :                    :        +- SortMergeJoin [coalesce(i_brand_id#19836, 0), isnull(i_brand_id#19836), coalesce(i_class_id#19838, 0), isnull(i_class_id#19838), coalesce(i_category_id#19840, 0), isnull(i_category_id#19840)], [coalesce(i_brand_id#19920, 0), isnull(i_brand_id#19920), coalesce(i_class_id#19922, 0), isnull(i_class_id#19922), coalesce(i_category_id#19924, 0), isnull(i_category_id#19924)], LeftSemi
                              :                          :                    :           :- Sort [coalesce(i_brand_id#19836, 0) ASC NULLS FIRST, isnull(i_brand_id#19836) ASC NULLS FIRST, coalesce(i_class_id#19838, 0) ASC NULLS FIRST, isnull(i_class_id#19838) ASC NULLS FIRST, coalesce(i_category_id#19840, 0) ASC NULLS FIRST, isnull(i_category_id#19840) ASC NULLS FIRST], false, 0
                              :                          :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#19836, 0), isnull(i_brand_id#19836), coalesce(i_class_id#19838, 0), isnull(i_class_id#19838), coalesce(i_category_id#19840, 0), isnull(i_category_id#19840), 200), ENSURE_REQUIREMENTS, [plan_id=48373]
                              :                          :                    :           :     +- Filter (((isnotnull(i_item_sk#19829) AND isnotnull(i_brand_id#19836)) AND isnotnull(i_class_id#19838)) AND isnotnull(i_category_id#19840))
                              :                          :                    :           :        +- FileScan parquet spark_catalog.m.item[i_item_sk#19829,i_brand_id#19836,i_class_id#19838,i_category_id#19840] Batched: true, DataFilters: [isnotnull(i_item_sk#19829), isnotnull(i_brand_id#19836), isnotnull(i_class_id#19838), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                          :                    :           +- Sort [coalesce(i_brand_id#19920, 0) ASC NULLS FIRST, isnull(i_brand_id#19920) ASC NULLS FIRST, coalesce(i_class_id#19922, 0) ASC NULLS FIRST, isnull(i_class_id#19922) ASC NULLS FIRST, coalesce(i_category_id#19924, 0) ASC NULLS FIRST, isnull(i_category_id#19924) ASC NULLS FIRST], false, 0
                              :                          :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#19920, 0), isnull(i_brand_id#19920), coalesce(i_class_id#19922, 0), isnull(i_class_id#19922), coalesce(i_category_id#19924, 0), isnull(i_category_id#19924), 200), ENSURE_REQUIREMENTS, [plan_id=48374]
                              :                          :                    :                 +- Project [i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                              :                          :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#19879], [d_date_sk#19935], Inner, BuildRight, false
                              :                          :                    :                       :- Project [cs_sold_date_sk#19879, i_brand_id#19920, i_class_id#19922, i_category_id#19924]
                              :                          :                    :                       :  +- BroadcastHashJoin [cs_item_sk#19894], [i_item_sk#19913], Inner, BuildRight, false
                              :                          :                    :                       :     :- Filter (isnotnull(cs_item_sk#19894) AND isnotnull(cs_sold_date_sk#19879))
                              :                          :                    :                       :     :  +- FileScan parquet spark_catalog.m.catalog_sales[cs_sold_date_sk#19879,cs_item_sk#19894] Batched: true, DataFilters: [isnotnull(cs_item_sk#19894), isnotnull(cs_sold_date_sk#19879)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                              :                          :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48364]
                              :                          :                    :                       :        +- Filter isnotnull(i_item_sk#19913)
                              :                          :                    :                       :           +- FileScan parquet spark_catalog.m.item[i_item_sk#19913,i_brand_id#19920,i_class_id#19922,i_category_id#19924] Batched: true, DataFilters: [isnotnull(i_item_sk#19913)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                          :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48368]
                              :                          :                    :                          +- Project [d_date_sk#19935]
                              :                          :                    :                             +- Filter (((isnotnull(d_year#19941) AND (d_year#19941 >= 1998)) AND (d_year#19941 <= 2000)) AND isnotnull(d_date_sk#19935))
                              :                          :                    :                                +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#19935,d_year#19941] Batched: true, DataFilters: [isnotnull(d_year#19941), (d_year#19941 >= 1998), (d_year#19941 <= 2000), isnotnull(d_date_sk#199..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :                          :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48383]
                              :                          :                       +- Project [d_date_sk#19851]
                              :                          :                          +- Filter (((isnotnull(d_year#19857) AND (d_year#19857 >= 1998)) AND (d_year#19857 <= 2000)) AND isnotnull(d_date_sk#19851))
                              :                          :                             +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#19851,d_year#19857] Batched: true, DataFilters: [isnotnull(d_year#19857), (d_year#19857 >= 1998), (d_year#19857 <= 2000), isnotnull(d_date_sk#198..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :                          +- Sort [coalesce(i_brand_id#20004, 0) ASC NULLS FIRST, isnull(i_brand_id#20004) ASC NULLS FIRST, coalesce(i_class_id#20006, 0) ASC NULLS FIRST, isnull(i_class_id#20006) ASC NULLS FIRST, coalesce(i_category_id#20008, 0) ASC NULLS FIRST, isnull(i_category_id#20008) ASC NULLS FIRST], false, 0
                              :                             +- Exchange hashpartitioning(coalesce(i_brand_id#20004, 0), isnull(i_brand_id#20004), coalesce(i_class_id#20006, 0), isnull(i_class_id#20006), coalesce(i_category_id#20008, 0), isnull(i_category_id#20008), 200), ENSURE_REQUIREMENTS, [plan_id=48400]
                              :                                +- Project [i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                              :                                   +- BroadcastHashJoin [ws_sold_date_sk#19963], [d_date_sk#20019], Inner, BuildRight, false
                              :                                      :- Project [ws_sold_date_sk#19963, i_brand_id#20004, i_class_id#20006, i_category_id#20008]
                              :                                      :  +- BroadcastHashJoin [ws_item_sk#19966], [i_item_sk#19997], Inner, BuildRight, false
                              :                                      :     :- Filter (isnotnull(ws_item_sk#19966) AND isnotnull(ws_sold_date_sk#19963))
                              :                                      :     :  +- FileScan parquet spark_catalog.m.web_sales[ws_sold_date_sk#19963,ws_item_sk#19966] Batched: true, DataFilters: [isnotnull(ws_item_sk#19966), isnotnull(ws_sold_date_sk#19963)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/web_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                              :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=48390]
                              :                                      :        +- Filter isnotnull(i_item_sk#19997)
                              :                                      :           +- FileScan parquet spark_catalog.m.item[i_item_sk#19997,i_brand_id#20004,i_class_id#20006,i_category_id#20008] Batched: true, DataFilters: [isnotnull(i_item_sk#19997)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48394]
                              :                                         +- Project [d_date_sk#20019]
                              :                                            +- Filter (((isnotnull(d_year#20025) AND (d_year#20025 >= 1998)) AND (d_year#20025 <= 2000)) AND isnotnull(d_date_sk#20019))
                              :                                               +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#20019,d_year#20025] Batched: true, DataFilters: [isnotnull(d_year#20025), (d_year#20025 >= 1998), (d_year#20025 <= 2000), isnotnull(d_date_sk#200..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1998), LessThanOrEqual(d_year,2000), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=48420]
                                 +- Project [d_date_sk#17803]
                                    +- Filter ((isnotnull(d_week_seq#17807) AND (d_week_seq#17807 = Subquery subquery#17361, [id=#48093])) AND isnotnull(d_date_sk#17803))
                                       :  +- Subquery subquery#17361, [id=#48093]
                                       :     +- AdaptiveSparkPlan isFinalPlan=false
                                       :        +- Project [d_week_seq#17875]
                                       :           +- Filter (((((isnotnull(d_year#17877) AND isnotnull(d_moy#17879)) AND isnotnull(d_dom#17880)) AND (d_year#17877 = 1998)) AND (d_moy#17879 = 12)) AND (d_dom#17880 = 20))
                                       :              +- FileScan parquet spark_catalog.m.date_dim[d_week_seq#17875,d_year#17877,d_moy#17879,d_dom#17880] Batched: true, DataFilters: [isnotnull(d_year#17877), isnotnull(d_moy#17879), isnotnull(d_dom#17880), (d_year#17877 = 1998), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1998), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                       +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#17803,d_week_seq#17807] Batched: true, DataFilters: [isnotnull(d_week_seq#17807), isnotnull(d_date_sk#17803)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
