== Parsed Logical Plan ==
CTE [cs_ui, cross_sales]
:  :- 'SubqueryAlias cs_ui
:  :  +- 'UnresolvedHaving ('sum('cs_ext_list_price) > (2 * 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit))))
:  :     +- 'Aggregate ['cs_item_sk], ['cs_item_sk, 'sum('cs_ext_list_price) AS sale#37231, 'sum((('cr_refunded_cash + 'cr_reversed_charge) + 'cr_store_credit)) AS refund#37232]
:  :        +- 'Filter (('cs_item_sk = 'cr_item_sk) AND ('cs_order_number = 'cr_order_number))
:  :           +- 'Join Inner
:  :              :- 'UnresolvedRelation [catalog_sales], [], false
:  :              +- 'UnresolvedRelation [catalog_returns], [], false
:  +- 'SubqueryAlias cross_sales
:     +- 'Aggregate ['i_product_name, 'i_item_sk, 's_store_name, 's_zip, 'ad1.ca_street_number, 'ad1.ca_street_name, 'ad1.ca_city, 'ad1.ca_zip, 'ad2.ca_street_number, 'ad2.ca_street_name, 'ad2.ca_city, 'ad2.ca_zip, 'd1.d_year, 'd2.d_year, 'd3.d_year], ['i_product_name AS product_name#37233, 'i_item_sk AS item_sk#37234, 's_store_name AS store_name#37235, 's_zip AS store_zip#37236, 'ad1.ca_street_number AS b_street_number#37237, 'ad1.ca_street_name AS b_street_name#37238, 'ad1.ca_city AS b_city#37239, 'ad1.ca_zip AS b_zip#37240, 'ad2.ca_street_number AS c_street_number#37241, 'ad2.ca_street_name AS c_street_name#37242, 'ad2.ca_city AS c_city#37243, 'ad2.ca_zip AS c_zip#37244, 'd1.d_year AS syear#37245, 'd2.d_year AS fsyear#37246, 'd3.d_year AS s2year#37247, 'count(1) AS cnt#37248, 'sum('ss_wholesale_cost) AS s1#37249, 'sum('ss_list_price) AS s2#37250, 'sum('ss_coupon_amt) AS s3#37251]
:        +- 'Filter (((((('ss_store_sk = 's_store_sk) AND ('ss_sold_date_sk = 'd1.d_date_sk)) AND ('ss_customer_sk = 'c_customer_sk)) AND ((('ss_cdemo_sk = 'cd1.cd_demo_sk) AND ('ss_hdemo_sk = 'hd1.hd_demo_sk)) AND ('ss_addr_sk = 'ad1.ca_address_sk))) AND (((('ss_item_sk = 'i_item_sk) AND ('ss_item_sk = 'sr_item_sk)) AND ('ss_ticket_number = 'sr_ticket_number)) AND (('ss_item_sk = 'cs_ui.cs_item_sk) AND ('c_current_cdemo_sk = 'cd2.cd_demo_sk)))) AND ((((('c_current_hdemo_sk = 'hd2.hd_demo_sk) AND ('c_current_addr_sk = 'ad2.ca_address_sk)) AND ('c_first_sales_date_sk = 'd2.d_date_sk)) AND ((('c_first_shipto_date_sk = 'd3.d_date_sk) AND ('ss_promo_sk = 'p_promo_sk)) AND ('hd1.hd_income_band_sk = 'ib1.ib_income_band_sk))) AND (((('hd2.hd_income_band_sk = 'ib2.ib_income_band_sk) AND NOT ('cd1.cd_marital_status = 'cd2.cd_marital_status)) AND 'i_color IN (brown,deep,tomato,cornsilk,gainsboro,dodger)) AND ((('i_current_price >= 22) AND ('i_current_price <= (22 + 10))) AND (('i_current_price >= (22 + 1)) AND ('i_current_price <= (22 + 15)))))))
:           +- 'Join Inner
:              :- 'Join Inner
:              :  :- 'Join Inner
:              :  :  :- 'Join Inner
:              :  :  :  :- 'Join Inner
:              :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'UnresolvedRelation [store_sales], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [store_returns], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [cs_ui], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d1
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d2
:              :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim], [], false
:              :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias d3
:              :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [date_dim], [], false
:              :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [store], [], false
:              :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation [customer], [], false
:              :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias cd1
:              :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics], [], false
:              :  :  :  :  :  :  :  :  +- 'SubqueryAlias cd2
:              :  :  :  :  :  :  :  :     +- 'UnresolvedRelation [customer_demographics], [], false
:              :  :  :  :  :  :  :  +- 'UnresolvedRelation [promotion], [], false
:              :  :  :  :  :  :  +- 'SubqueryAlias hd1
:              :  :  :  :  :  :     +- 'UnresolvedRelation [household_demographics], [], false
:              :  :  :  :  :  +- 'SubqueryAlias hd2
:              :  :  :  :  :     +- 'UnresolvedRelation [household_demographics], [], false
:              :  :  :  :  +- 'SubqueryAlias ad1
:              :  :  :  :     +- 'UnresolvedRelation [customer_address], [], false
:              :  :  :  +- 'SubqueryAlias ad2
:              :  :  :     +- 'UnresolvedRelation [customer_address], [], false
:              :  :  +- 'SubqueryAlias ib1
:              :  :     +- 'UnresolvedRelation [income_band], [], false
:              :  +- 'SubqueryAlias ib2
:              :     +- 'UnresolvedRelation [income_band], [], false
:              +- 'UnresolvedRelation [item], [], false
+- 'Sort ['cs1.product_name ASC NULLS FIRST, 'cs1.store_name ASC NULLS FIRST, 'cs2.cnt ASC NULLS FIRST, 'cs1.s1 ASC NULLS FIRST, 'cs2.s1 ASC NULLS FIRST], true
   +- 'Project ['cs1.product_name, 'cs1.store_name, 'cs1.store_zip, 'cs1.b_street_number, 'cs1.b_street_name, 'cs1.b_city, 'cs1.b_zip, 'cs1.c_street_number, 'cs1.c_street_name, 'cs1.c_city, 'cs1.c_zip, 'cs1.syear, 'cs1.cnt, 'cs1.s1 AS s11#37225, 'cs1.s2 AS s21#37226, 'cs1.s3 AS s31#37227, 'cs2.s1 AS s12#37228, 'cs2.s2 AS s22#37229, 'cs2.s3 AS s32#37230, 'cs2.syear, 'cs2.cnt]
      +- 'Filter (((('cs1.item_sk = 'cs2.item_sk) AND ('cs1.syear = 2000)) AND ('cs2.syear = (2000 + 1))) AND ((('cs2.cnt <= 'cs1.cnt) AND ('cs1.store_name = 'cs2.store_name)) AND ('cs1.store_zip = 'cs2.store_zip)))
         +- 'Join Inner
            :- 'SubqueryAlias cs1
            :  +- 'UnresolvedRelation [cross_sales], [], false
            +- 'SubqueryAlias cs2
               +- 'UnresolvedRelation [cross_sales], [], false

== Analyzed Logical Plan ==
product_name: string, store_name: string, store_zip: string, b_street_number: string, b_street_name: string, b_city: string, b_zip: string, c_street_number: string, c_street_name: string, c_city: string, c_zip: string, syear: int, cnt: bigint, s11: double, s21: double, s31: double, s12: double, s22: double, s32: double, syear: int, cnt: bigint
WithCTE
:- CTERelationDef 57, false
:  +- SubqueryAlias cs_ui
:     +- Filter (sale#37231 > (cast(2 as double) * refund#37232))
:        +- Aggregate [cs_item_sk#476], [cs_item_sk#476, sum(cs_ext_list_price#486) AS sale#37231, sum(((cr_refunded_cash#7834 + cr_reversed_charge#7835) + cr_store_credit#7836)) AS refund#37232]
:           +- Filter ((cs_item_sk#476 = cr_item_sk#7813) AND (cs_order_number#478 = cr_order_number#7827))
:              +- Join Inner
:                 :- SubqueryAlias spark_catalog.m.catalog_sales
:                 :  +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#461,cs_sold_time_sk#462,cs_ship_date_sk#463,cs_bill_customer_sk#464,cs_bill_cdemo_sk#465,cs_bill_hdemo_sk#466,cs_bill_addr_sk#467,cs_ship_customer_sk#468,cs_ship_cdemo_sk#469,cs_ship_hdemo_sk#470,cs_ship_addr_sk#471,cs_call_center_sk#472,cs_catalog_page_sk#473,cs_ship_mode_sk#474,cs_warehouse_sk#475,cs_item_sk#476,cs_promo_sk#477,cs_order_number#478,cs_quantity#479,cs_wholesale_cost#480,cs_list_price#481,cs_sales_price#482,cs_ext_discount_amt#483,cs_ext_sales_price#484,... 10 more fields] parquet
:                 +- SubqueryAlias spark_catalog.m.catalog_returns
:                    +- Relation spark_catalog.m.catalog_returns[cr_returned_date_sk#7811,cr_returned_time_sk#7812,cr_item_sk#7813,cr_refunded_customer_sk#7814,cr_refunded_cdemo_sk#7815,cr_refunded_hdemo_sk#7816,cr_refunded_addr_sk#7817,cr_returning_customer_sk#7818,cr_returning_cdemo_sk#7819,cr_returning_hdemo_sk#7820,cr_returning_addr_sk#7821,cr_call_center_sk#7822,cr_catalog_page_sk#7823,cr_ship_mode_sk#7824,cr_warehouse_sk#7825,cr_reason_sk#7826,cr_order_number#7827,cr_return_quantity#7828,cr_return_amount#7829,cr_return_tax#7830,cr_return_amt_inc_tax#7831,cr_fee#7832,cr_return_ship_cost#7833,cr_refunded_cash#7834,... 3 more fields] parquet
:- CTERelationDef 58, false
:  +- SubqueryAlias cross_sales
:     +- Aggregate [i_product_name#1292, i_item_sk#1271, s_store_name#57, s_zip#77, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335, d_year#30, d_year#37262, d_year#37290], [i_product_name#1292 AS product_name#37233, i_item_sk#1271 AS item_sk#37234, s_store_name#57 AS store_name#37235, s_zip#77 AS store_zip#37236, ca_street_number#8173 AS b_street_number#37237, ca_street_name#8174 AS b_street_name#37238, ca_city#8177 AS b_city#37239, ca_zip#8180 AS b_zip#37240, ca_street_number#37328 AS c_street_number#37241, ca_street_name#37329 AS c_street_name#37242, ca_city#37332 AS c_city#37243, ca_zip#37335 AS c_zip#37244, d_year#30 AS syear#37245, d_year#37262 AS fsyear#37246, d_year#37290 AS s2year#37247, count(1) AS cnt#37248L, sum(ss_wholesale_cost#1259) AS s1#37249, sum(ss_list_price#1260) AS s2#37250, sum(ss_coupon_amt#1267) AS s3#37251]
:        +- Filter ((((((ss_store_sk#1255 = s_store_sk#52) AND (ss_sold_date_sk#1248 = d_date_sk#24)) AND (ss_customer_sk#1251 = c_customer_sk#81)) AND (((ss_cdemo_sk#1252 = cd_demo_sk#8266) AND (ss_hdemo_sk#1253 = hd_demo_sk#12110)) AND (ss_addr_sk#1254 = ca_address_sk#8171))) AND ((((ss_item_sk#1250 = i_item_sk#1271) AND (ss_item_sk#1250 = sr_item_sk#6)) AND (ss_ticket_number#1257 = sr_ticket_number#13)) AND ((ss_item_sk#1250 = cs_item_sk#476) AND (c_current_cdemo_sk#83 = cd_demo_sk#37312)))) AND (((((c_current_hdemo_sk#84 = hd_demo_sk#37321) AND (c_current_addr_sk#85 = ca_address_sk#37326)) AND (c_first_sales_date_sk#87 = d_date_sk#37256)) AND (((c_first_shipto_date_sk#86 = d_date_sk#37284) AND (ss_promo_sk#1256 = p_promo_sk#8275)) AND (hd_income_band_sk#12111 = ib_income_band_sk#37253))) AND ((((hd_income_band_sk#37322 = ib_income_band_sk#37339) AND NOT (cd_marital_status#8268 = cd_marital_status#37314)) AND i_color#1288 IN (brown,deep,tomato,cornsilk,gainsboro,dodger)) AND (((i_current_price#1276 >= cast(22 as double)) AND (i_current_price#1276 <= cast((22 + 10) as double))) AND ((i_current_price#1276 >= cast((22 + 1) as double)) AND (i_current_price#1276 <= cast((22 + 15) as double)))))))
:           +- Join Inner
:              :- Join Inner
:              :  :- Join Inner
:              :  :  :- Join Inner
:              :  :  :  :- Join Inner
:              :  :  :  :  :- Join Inner
:              :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias spark_catalog.m.store_sales
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#1248,ss_sold_time_sk#1249,ss_item_sk#1250,ss_customer_sk#1251,ss_cdemo_sk#1252,ss_hdemo_sk#1253,ss_addr_sk#1254,ss_store_sk#1255,ss_promo_sk#1256,ss_ticket_number#1257,ss_quantity#1258,ss_wholesale_cost#1259,ss_list_price#1260,ss_sales_price#1261,ss_ext_discount_amt#1262,ss_ext_sales_price#1263,ss_ext_wholesale_cost#1264,ss_ext_list_price#1265,ss_ext_tax#1266,ss_coupon_amt#1267,ss_net_paid#1268,ss_net_paid_inc_tax#1269,ss_net_profit#1270] parquet
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.m.store_returns
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation spark_catalog.m.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias cs_ui
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- CTERelationRef 57, true, [cs_item_sk#476, sale#37231, refund#37232], false
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d1
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.m.date_dim
:              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation spark_catalog.m.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
:              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d2
:              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.m.date_dim
:              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation spark_catalog.m.date_dim[d_date_sk#37256,d_date_id#37257,d_date#37258,d_month_seq#37259,d_week_seq#37260,d_quarter_seq#37261,d_year#37262,d_dow#37263,d_moy#37264,d_dom#37265,d_qoy#37266,d_fy_year#37267,d_fy_quarter_seq#37268,d_fy_week_seq#37269,d_day_name#37270,d_quarter_name#37271,d_holiday#37272,d_weekend#37273,d_following_holiday#37274,d_first_dom#37275,d_last_dom#37276,d_same_day_ly#37277,d_same_day_lq#37278,d_current_day#37279,... 4 more fields] parquet
:              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias d3
:              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.m.date_dim
:              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation spark_catalog.m.date_dim[d_date_sk#37284,d_date_id#37285,d_date#37286,d_month_seq#37287,d_week_seq#37288,d_quarter_seq#37289,d_year#37290,d_dow#37291,d_moy#37292,d_dom#37293,d_qoy#37294,d_fy_year#37295,d_fy_quarter_seq#37296,d_fy_week_seq#37297,d_day_name#37298,d_quarter_name#37299,d_holiday#37300,d_weekend#37301,d_following_holiday#37302,d_first_dom#37303,d_last_dom#37304,d_same_day_ly#37305,d_same_day_lq#37306,d_current_day#37307,... 4 more fields] parquet
:              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.m.store
:              :  :  :  :  :  :  :  :  :  :  :     +- Relation spark_catalog.m.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,... 5 more fields] parquet
:              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.m.customer
:              :  :  :  :  :  :  :  :  :  :     +- Relation spark_catalog.m.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet
:              :  :  :  :  :  :  :  :  :  +- SubqueryAlias cd1
:              :  :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.m.customer_demographics
:              :  :  :  :  :  :  :  :  :        +- Relation spark_catalog.m.customer_demographics[cd_demo_sk#8266,cd_gender#8267,cd_marital_status#8268,cd_education_status#8269,cd_purchase_estimate#8270,cd_credit_rating#8271,cd_dep_count#8272,cd_dep_employed_count#8273,cd_dep_college_count#8274] parquet
:              :  :  :  :  :  :  :  :  +- SubqueryAlias cd2
:              :  :  :  :  :  :  :  :     +- SubqueryAlias spark_catalog.m.customer_demographics
:              :  :  :  :  :  :  :  :        +- Relation spark_catalog.m.customer_demographics[cd_demo_sk#37312,cd_gender#37313,cd_marital_status#37314,cd_education_status#37315,cd_purchase_estimate#37316,cd_credit_rating#37317,cd_dep_count#37318,cd_dep_employed_count#37319,cd_dep_college_count#37320] parquet
:              :  :  :  :  :  :  :  +- SubqueryAlias spark_catalog.m.promotion
:              :  :  :  :  :  :  :     +- Relation spark_catalog.m.promotion[p_promo_sk#8275,p_promo_id#8276,p_start_date_sk#8277,p_end_date_sk#8278,p_item_sk#8279,p_cost#8280,p_response_target#8281,p_promo_name#8282,p_channel_dmail#8283,p_channel_email#8284,p_channel_catalog#8285,p_channel_tv#8286,p_channel_radio#8287,p_channel_press#8288,p_channel_event#8289,p_channel_demo#8290,p_channel_details#8291,p_purpose#8292,p_discount_active#8293] parquet
:              :  :  :  :  :  :  +- SubqueryAlias hd1
:              :  :  :  :  :  :     +- SubqueryAlias spark_catalog.m.household_demographics
:              :  :  :  :  :  :        +- Relation spark_catalog.m.household_demographics[hd_demo_sk#12110,hd_income_band_sk#12111,hd_buy_potential#12112,hd_dep_count#12113,hd_vehicle_count#12114] parquet
:              :  :  :  :  :  +- SubqueryAlias hd2
:              :  :  :  :  :     +- SubqueryAlias spark_catalog.m.household_demographics
:              :  :  :  :  :        +- Relation spark_catalog.m.household_demographics[hd_demo_sk#37321,hd_income_band_sk#37322,hd_buy_potential#37323,hd_dep_count#37324,hd_vehicle_count#37325] parquet
:              :  :  :  :  +- SubqueryAlias ad1
:              :  :  :  :     +- SubqueryAlias spark_catalog.m.customer_address
:              :  :  :  :        +- Relation spark_catalog.m.customer_address[ca_address_sk#8171,ca_address_id#8172,ca_street_number#8173,ca_street_name#8174,ca_street_type#8175,ca_suite_number#8176,ca_city#8177,ca_county#8178,ca_state#8179,ca_zip#8180,ca_country#8181,ca_gmt_offset#8182,ca_location_type#8183] parquet
:              :  :  :  +- SubqueryAlias ad2
:              :  :  :     +- SubqueryAlias spark_catalog.m.customer_address
:              :  :  :        +- Relation spark_catalog.m.customer_address[ca_address_sk#37326,ca_address_id#37327,ca_street_number#37328,ca_street_name#37329,ca_street_type#37330,ca_suite_number#37331,ca_city#37332,ca_county#37333,ca_state#37334,ca_zip#37335,ca_country#37336,ca_gmt_offset#37337,ca_location_type#37338] parquet
:              :  :  +- SubqueryAlias ib1
:              :  :     +- SubqueryAlias spark_catalog.m.income_band
:              :  :        +- Relation spark_catalog.m.income_band[ib_income_band_sk#37253,ib_lower_bound#37254,ib_upper_bound#37255] parquet
:              :  +- SubqueryAlias ib2
:              :     +- SubqueryAlias spark_catalog.m.income_band
:              :        +- Relation spark_catalog.m.income_band[ib_income_band_sk#37339,ib_lower_bound#37340,ib_upper_bound#37341] parquet
:              +- SubqueryAlias spark_catalog.m.item
:                 +- Relation spark_catalog.m.item[i_item_sk#1271,i_item_id#1272,i_rec_start_date#1273,i_rec_end_date#1274,i_item_desc#1275,i_current_price#1276,i_wholesale_cost#1277,i_brand_id#1278,i_brand#1279,i_class_id#1280,i_class#1281,i_category_id#1282,i_category#1283,i_manufact_id#1284,i_manufact#1285,i_size#1286,i_formulation#1287,i_color#1288,i_units#1289,i_container#1290,i_manager_id#1291,i_product_name#1292] parquet
+- Project [product_name#37233, store_name#37235, store_zip#37236, b_street_number#37237, b_street_name#37238, b_city#37239, b_zip#37240, c_street_number#37241, c_street_name#37242, c_city#37243, c_zip#37244, syear#37245, cnt#37248L, s11#37225, s21#37226, s31#37227, s12#37228, s22#37229, s32#37230, syear#37368, cnt#37371L]
   +- Sort [product_name#37233 ASC NULLS FIRST, store_name#37235 ASC NULLS FIRST, cnt#37371L ASC NULLS FIRST, s1#37249 ASC NULLS FIRST, s1#37372 ASC NULLS FIRST], true
      +- Project [product_name#37233, store_name#37235, store_zip#37236, b_street_number#37237, b_street_name#37238, b_city#37239, b_zip#37240, c_street_number#37241, c_street_name#37242, c_city#37243, c_zip#37244, syear#37245, cnt#37248L, s1#37249 AS s11#37225, s2#37250 AS s21#37226, s3#37251 AS s31#37227, s1#37372 AS s12#37228, s2#37373 AS s22#37229, s3#37374 AS s32#37230, syear#37368, cnt#37371L, s1#37249, s1#37372]
         +- Filter ((((item_sk#37234 = item_sk#37357) AND (syear#37245 = 2000)) AND (syear#37368 = (2000 + 1))) AND (((cnt#37371L <= cnt#37248L) AND (store_name#37235 = store_name#37358)) AND (store_zip#37236 = store_zip#37359)))
            +- Join Inner
               :- SubqueryAlias cs1
               :  +- SubqueryAlias cross_sales
               :     +- CTERelationRef 58, true, [product_name#37233, item_sk#37234, store_name#37235, store_zip#37236, b_street_number#37237, b_street_name#37238, b_city#37239, b_zip#37240, c_street_number#37241, c_street_name#37242, c_city#37243, c_zip#37244, syear#37245, fsyear#37246, s2year#37247, cnt#37248L, s1#37249, s2#37250, s3#37251], false
               +- SubqueryAlias cs2
                  +- SubqueryAlias cross_sales
                     +- CTERelationRef 58, true, [product_name#37356, item_sk#37357, store_name#37358, store_zip#37359, b_street_number#37360, b_street_name#37361, b_city#37362, b_zip#37363, c_street_number#37364, c_street_name#37365, c_city#37366, c_zip#37367, syear#37368, fsyear#37369, s2year#37370, cnt#37371L, s1#37372, s2#37373, s3#37374], false

== Optimized Logical Plan ==
Project [product_name#37233, store_name#37235, store_zip#37236, b_street_number#37237, b_street_name#37238, b_city#37239, b_zip#37240, c_street_number#37241, c_street_name#37242, c_city#37243, c_zip#37244, syear#37245, cnt#37248L, s11#37225, s21#37226, s31#37227, s12#37228, s22#37229, s32#37230, syear#37368, cnt#37371L]
+- Sort [product_name#37233 ASC NULLS FIRST, store_name#37235 ASC NULLS FIRST, cnt#37371L ASC NULLS FIRST, s1#37249 ASC NULLS FIRST, s1#37372 ASC NULLS FIRST], true
   +- Project [product_name#37233, store_name#37235, store_zip#37236, b_street_number#37237, b_street_name#37238, b_city#37239, b_zip#37240, c_street_number#37241, c_street_name#37242, c_city#37243, c_zip#37244, syear#37245, cnt#37248L, s1#37249 AS s11#37225, s2#37250 AS s21#37226, s3#37251 AS s31#37227, s1#37372 AS s12#37228, s2#37373 AS s22#37229, s3#37374 AS s32#37230, syear#37368, cnt#37371L, s1#37249, s1#37372]
      +- Join Inner, ((((item_sk#37234 = item_sk#37357) AND (cnt#37371L <= cnt#37248L)) AND (store_name#37235 = store_name#37358)) AND (store_zip#37236 = store_zip#37359))
         :- Aggregate [i_product_name#1292, i_item_sk#1271, s_store_name#57, s_zip#77, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335, d_year#30, d_year#37262, d_year#37290], [i_product_name#1292 AS product_name#37233, i_item_sk#1271 AS item_sk#37234, s_store_name#57 AS store_name#37235, s_zip#77 AS store_zip#37236, ca_street_number#8173 AS b_street_number#37237, ca_street_name#8174 AS b_street_name#37238, ca_city#8177 AS b_city#37239, ca_zip#8180 AS b_zip#37240, ca_street_number#37328 AS c_street_number#37241, ca_street_name#37329 AS c_street_name#37242, ca_city#37332 AS c_city#37243, ca_zip#37335 AS c_zip#37244, d_year#30 AS syear#37245, count(1) AS cnt#37248L, sum(ss_wholesale_cost#1259) AS s1#37249, sum(ss_list_price#1260) AS s2#37250, sum(ss_coupon_amt#1267) AS s3#37251]
         :  +- Project [ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, d_year#37262, d_year#37290, s_store_name#57, s_zip#77, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335, i_item_sk#1271, i_product_name#1292]
         :     +- Join Inner, (ss_item_sk#1250 = i_item_sk#1271)
         :        :- Project [ss_item_sk#1250, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, d_year#37262, d_year#37290, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335]
         :        :  +- Join Inner, (hd_income_band_sk#37322 = ib_income_band_sk#37339)
         :        :     :- Project [ss_item_sk#1250, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, d_year#37262, d_year#37290, hd_income_band_sk#37322, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335]
         :        :     :  +- Join Inner, (hd_income_band_sk#12111 = ib_income_band_sk#37253)
         :        :     :     :- Project [ss_item_sk#1250, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, d_year#37262, d_year#37290, hd_income_band_sk#12111, hd_income_band_sk#37322, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335]
         :        :     :     :  +- Join Inner, (c_current_addr_sk#85 = ca_address_sk#37326)
         :        :     :     :     :- Project [ss_item_sk#1250, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_addr_sk#85, d_year#37262, d_year#37290, hd_income_band_sk#12111, hd_income_band_sk#37322, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180]
         :        :     :     :     :  +- Join Inner, (ss_addr_sk#1254 = ca_address_sk#8171)
         :        :     :     :     :     :- Project [ss_item_sk#1250, ss_addr_sk#1254, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_addr_sk#85, d_year#37262, d_year#37290, hd_income_band_sk#12111, hd_income_band_sk#37322]
         :        :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#84 = hd_demo_sk#37321)
         :        :     :     :     :     :     :- Project [ss_item_sk#1250, ss_addr_sk#1254, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290, hd_income_band_sk#12111]
         :        :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#1253 = hd_demo_sk#12110)
         :        :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290]
         :        :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#1256 = p_promo_sk#8275)
         :        :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290]
         :        :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#83 = cd_demo_sk#37312) AND NOT (cd_marital_status#8268 = cd_marital_status#37314))
         :        :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290, cd_marital_status#8268]
         :        :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#1252 = cd_demo_sk#8266)
         :        :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290]
         :        :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#86 = d_date_sk#37284)
         :        :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, c_first_shipto_date_sk#86, d_year#37262]
         :        :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#87 = d_date_sk#37256)
         :        :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, c_first_shipto_date_sk#86, c_first_sales_date_sk#87]
         :        :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#1251 = c_customer_sk#81)
         :        :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#1255 = s_store_sk#52)
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_store_sk#1255, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#1248 = d_date_sk#24)
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#1248, ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_store_sk#1255, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#1250 = cs_item_sk#476)
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#1248, ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_store_sk#1255, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((ss_item_sk#1250 = sr_item_sk#6) AND (ss_ticket_number#1257 = sr_ticket_number#13))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#1248, ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_store_sk#1255, ss_promo_sk#1256, ss_ticket_number#1257, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((isnotnull(ss_item_sk#1250) AND isnotnull(ss_ticket_number#1257)) AND isnotnull(ss_sold_date_sk#1248)) AND (isnotnull(ss_store_sk#1255) AND isnotnull(ss_customer_sk#1251))) AND isnotnull(ss_cdemo_sk#1252)) AND ((isnotnull(ss_promo_sk#1256) AND isnotnull(ss_hdemo_sk#1253)) AND isnotnull(ss_addr_sk#1254)))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#1248,ss_sold_time_sk#1249,ss_item_sk#1250,ss_customer_sk#1251,ss_cdemo_sk#1252,ss_hdemo_sk#1253,ss_addr_sk#1254,ss_store_sk#1255,ss_promo_sk#1256,ss_ticket_number#1257,ss_quantity#1258,ss_wholesale_cost#1259,ss_list_price#1260,ss_sales_price#1261,ss_ext_discount_amt#1262,ss_ext_sales_price#1263,ss_ext_wholesale_cost#1264,ss_ext_list_price#1265,ss_ext_tax#1266,ss_coupon_amt#1267,ss_net_paid#1268,ss_net_paid_inc_tax#1269,ss_net_profit#1270] parquet
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#6, sr_ticket_number#13]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#6) AND isnotnull(sr_ticket_number#13))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.store_returns[sr_returned_date_sk#4,sr_return_time_sk#5,sr_item_sk#6,sr_customer_sk#7,sr_cdemo_sk#8,sr_hdemo_sk#9,sr_addr_sk#10,sr_store_sk#11,sr_reason_sk#12,sr_ticket_number#13,sr_return_quantity#14,sr_return_amt#15,sr_return_tax#16,sr_return_amt_inc_tax#17,sr_fee#18,sr_return_ship_cost#19,sr_refunded_cash#20,sr_reversed_charge#21,sr_store_credit#22,sr_net_loss#23] parquet
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#476]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(sale#37231) AND isnotnull(refund#37232)) AND (sale#37231 > (2.0 * refund#37232)))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#476], [cs_item_sk#476, sum(cs_ext_list_price#486) AS sale#37231, sum(((cr_refunded_cash#7834 + cr_reversed_charge#7835) + cr_store_credit#7836)) AS refund#37232]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#476, cs_ext_list_price#486, cr_refunded_cash#7834, cr_reversed_charge#7835, cr_store_credit#7836]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#476 = cr_item_sk#7813) AND (cs_order_number#478 = cr_order_number#7827))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#476, cs_order_number#478, cs_ext_list_price#486]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#476) AND isnotnull(cs_order_number#478))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#461,cs_sold_time_sk#462,cs_ship_date_sk#463,cs_bill_customer_sk#464,cs_bill_cdemo_sk#465,cs_bill_hdemo_sk#466,cs_bill_addr_sk#467,cs_ship_customer_sk#468,cs_ship_cdemo_sk#469,cs_ship_hdemo_sk#470,cs_ship_addr_sk#471,cs_call_center_sk#472,cs_catalog_page_sk#473,cs_ship_mode_sk#474,cs_warehouse_sk#475,cs_item_sk#476,cs_promo_sk#477,cs_order_number#478,cs_quantity#479,cs_wholesale_cost#480,cs_list_price#481,cs_sales_price#482,cs_ext_discount_amt#483,cs_ext_sales_price#484,... 10 more fields] parquet
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#7813, cr_order_number#7827, cr_refunded_cash#7834, cr_reversed_charge#7835, cr_store_credit#7836]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#7813) AND isnotnull(cr_order_number#7827))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation spark_catalog.m.catalog_returns[cr_returned_date_sk#7811,cr_returned_time_sk#7812,cr_item_sk#7813,cr_refunded_customer_sk#7814,cr_refunded_cdemo_sk#7815,cr_refunded_hdemo_sk#7816,cr_refunded_addr_sk#7817,cr_returning_customer_sk#7818,cr_returning_cdemo_sk#7819,cr_returning_hdemo_sk#7820,cr_returning_addr_sk#7821,cr_call_center_sk#7822,cr_catalog_page_sk#7823,cr_ship_mode_sk#7824,cr_warehouse_sk#7825,cr_reason_sk#7826,cr_order_number#7827,cr_return_quantity#7828,cr_return_amount#7829,cr_return_tax#7830,cr_return_amt_inc_tax#7831,cr_fee#7832,cr_return_ship_cost#7833,cr_refunded_cash#7834,... 3 more fields] parquet
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#24, d_year#30]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.date_dim[d_date_sk#24,d_date_id#25,d_date#26,d_month_seq#27,d_week_seq#28,d_quarter_seq#29,d_year#30,d_dow#31,d_moy#32,d_dom#33,d_qoy#34,d_fy_year#35,d_fy_quarter_seq#36,d_fy_week_seq#37,d_day_name#38,d_quarter_name#39,d_holiday#40,d_weekend#41,d_following_holiday#42,d_first_dom#43,d_last_dom#44,d_same_day_ly#45,d_same_day_lq#46,d_current_day#47,... 4 more fields] parquet
         :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#52, s_store_name#57, s_zip#77]
         :        :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(s_store_sk#52) AND (isnotnull(s_store_name#57) AND isnotnull(s_zip#77)))
         :        :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.store[s_store_sk#52,s_store_id#53,s_rec_start_date#54,s_rec_end_date#55,s_closed_date_sk#56,s_store_name#57,s_number_employees#58,s_floor_space#59,s_hours#60,s_manager#61,s_market_id#62,s_geography_class#63,s_market_desc#64,s_market_manager#65,s_division_id#66,s_division_name#67,s_company_id#68,s_company_name#69,s_street_number#70,s_street_name#71,s_street_type#72,s_suite_number#73,s_city#74,s_county#75,... 5 more fields] parquet
         :        :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#81, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, c_first_shipto_date_sk#86, c_first_sales_date_sk#87]
         :        :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(c_customer_sk#81) AND ((isnotnull(c_first_sales_date_sk#87) AND isnotnull(c_first_shipto_date_sk#86)) AND isnotnull(c_current_cdemo_sk#83))) AND (isnotnull(c_current_hdemo_sk#84) AND isnotnull(c_current_addr_sk#85)))
         :        :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.customer[c_customer_sk#81,c_customer_id#82,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87,c_salutation#88,c_first_name#89,c_last_name#90,c_preferred_cust_flag#91,c_birth_day#92,c_birth_month#93,c_birth_year#94,c_birth_country#95,c_login#96,c_email_address#97,c_last_review_date#98] parquet
         :        :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#37256, d_year#37262]
         :        :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#37256)
         :        :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.date_dim[d_date_sk#37256,d_date_id#37257,d_date#37258,d_month_seq#37259,d_week_seq#37260,d_quarter_seq#37261,d_year#37262,d_dow#37263,d_moy#37264,d_dom#37265,d_qoy#37266,d_fy_year#37267,d_fy_quarter_seq#37268,d_fy_week_seq#37269,d_day_name#37270,d_quarter_name#37271,d_holiday#37272,d_weekend#37273,d_following_holiday#37274,d_first_dom#37275,d_last_dom#37276,d_same_day_ly#37277,d_same_day_lq#37278,d_current_day#37279,... 4 more fields] parquet
         :        :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#37284, d_year#37290]
         :        :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#37284)
         :        :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.date_dim[d_date_sk#37284,d_date_id#37285,d_date#37286,d_month_seq#37287,d_week_seq#37288,d_quarter_seq#37289,d_year#37290,d_dow#37291,d_moy#37292,d_dom#37293,d_qoy#37294,d_fy_year#37295,d_fy_quarter_seq#37296,d_fy_week_seq#37297,d_day_name#37298,d_quarter_name#37299,d_holiday#37300,d_weekend#37301,d_following_holiday#37302,d_first_dom#37303,d_last_dom#37304,d_same_day_ly#37305,d_same_day_lq#37306,d_current_day#37307,... 4 more fields] parquet
         :        :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#8266, cd_marital_status#8268]
         :        :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#8266) AND isnotnull(cd_marital_status#8268))
         :        :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.customer_demographics[cd_demo_sk#8266,cd_gender#8267,cd_marital_status#8268,cd_education_status#8269,cd_purchase_estimate#8270,cd_credit_rating#8271,cd_dep_count#8272,cd_dep_employed_count#8273,cd_dep_college_count#8274] parquet
         :        :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#37312, cd_marital_status#37314]
         :        :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#37312) AND isnotnull(cd_marital_status#37314))
         :        :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.customer_demographics[cd_demo_sk#37312,cd_gender#37313,cd_marital_status#37314,cd_education_status#37315,cd_purchase_estimate#37316,cd_credit_rating#37317,cd_dep_count#37318,cd_dep_employed_count#37319,cd_dep_college_count#37320] parquet
         :        :     :     :     :     :     :     :     +- Project [p_promo_sk#8275]
         :        :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#8275)
         :        :     :     :     :     :     :     :           +- Relation spark_catalog.m.promotion[p_promo_sk#8275,p_promo_id#8276,p_start_date_sk#8277,p_end_date_sk#8278,p_item_sk#8279,p_cost#8280,p_response_target#8281,p_promo_name#8282,p_channel_dmail#8283,p_channel_email#8284,p_channel_catalog#8285,p_channel_tv#8286,p_channel_radio#8287,p_channel_press#8288,p_channel_event#8289,p_channel_demo#8290,p_channel_details#8291,p_purpose#8292,p_discount_active#8293] parquet
         :        :     :     :     :     :     :     +- Project [hd_demo_sk#12110, hd_income_band_sk#12111]
         :        :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#12110) AND isnotnull(hd_income_band_sk#12111))
         :        :     :     :     :     :     :           +- Relation spark_catalog.m.household_demographics[hd_demo_sk#12110,hd_income_band_sk#12111,hd_buy_potential#12112,hd_dep_count#12113,hd_vehicle_count#12114] parquet
         :        :     :     :     :     :     +- Project [hd_demo_sk#37321, hd_income_band_sk#37322]
         :        :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#37321) AND isnotnull(hd_income_band_sk#37322))
         :        :     :     :     :     :           +- Relation spark_catalog.m.household_demographics[hd_demo_sk#37321,hd_income_band_sk#37322,hd_buy_potential#37323,hd_dep_count#37324,hd_vehicle_count#37325] parquet
         :        :     :     :     :     +- Project [ca_address_sk#8171, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180]
         :        :     :     :     :        +- Filter isnotnull(ca_address_sk#8171)
         :        :     :     :     :           +- Relation spark_catalog.m.customer_address[ca_address_sk#8171,ca_address_id#8172,ca_street_number#8173,ca_street_name#8174,ca_street_type#8175,ca_suite_number#8176,ca_city#8177,ca_county#8178,ca_state#8179,ca_zip#8180,ca_country#8181,ca_gmt_offset#8182,ca_location_type#8183] parquet
         :        :     :     :     +- Project [ca_address_sk#37326, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335]
         :        :     :     :        +- Filter isnotnull(ca_address_sk#37326)
         :        :     :     :           +- Relation spark_catalog.m.customer_address[ca_address_sk#37326,ca_address_id#37327,ca_street_number#37328,ca_street_name#37329,ca_street_type#37330,ca_suite_number#37331,ca_city#37332,ca_county#37333,ca_state#37334,ca_zip#37335,ca_country#37336,ca_gmt_offset#37337,ca_location_type#37338] parquet
         :        :     :     +- Project [ib_income_band_sk#37253]
         :        :     :        +- Filter isnotnull(ib_income_band_sk#37253)
         :        :     :           +- Relation spark_catalog.m.income_band[ib_income_band_sk#37253,ib_lower_bound#37254,ib_upper_bound#37255] parquet
         :        :     +- Project [ib_income_band_sk#37339]
         :        :        +- Filter isnotnull(ib_income_band_sk#37339)
         :        :           +- Relation spark_catalog.m.income_band[ib_income_band_sk#37339,ib_lower_bound#37340,ib_upper_bound#37341] parquet
         :        +- Project [i_item_sk#1271, i_product_name#1292]
         :           +- Filter ((isnotnull(i_current_price#1276) AND ((((i_color#1288 IN (brown,deep,tomato,cornsilk,gainsboro,dodger) AND (i_current_price#1276 >= 22.0)) AND (i_current_price#1276 <= 32.0)) AND (i_current_price#1276 >= 23.0)) AND (i_current_price#1276 <= 37.0))) AND isnotnull(i_item_sk#1271))
         :              +- Relation spark_catalog.m.item[i_item_sk#1271,i_item_id#1272,i_rec_start_date#1273,i_rec_end_date#1274,i_item_desc#1275,i_current_price#1276,i_wholesale_cost#1277,i_brand_id#1278,i_brand#1279,i_class_id#1280,i_class#1281,i_category_id#1282,i_category#1283,i_manufact_id#1284,i_manufact#1285,i_size#1286,i_formulation#1287,i_color#1288,i_units#1289,i_container#1290,i_manager_id#1291,i_product_name#1292] parquet
         +- Aggregate [i_product_name#39338, i_item_sk#39317, s_store_name#39196, s_zip#39216, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307, d_year#39113, d_year#39141, d_year#39169], [i_item_sk#39317 AS item_sk#37357, s_store_name#39196 AS store_name#37358, s_zip#39216 AS store_zip#37359, d_year#39113 AS syear#37368, count(1) AS cnt#37371L, sum(ss_wholesale_cost#39014) AS s1#37372, sum(ss_list_price#39015) AS s2#37373, sum(ss_coupon_amt#39022) AS s3#37374]
            +- Project [ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, d_year#39141, d_year#39169, s_store_name#39196, s_zip#39216, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307, i_item_sk#39317, i_product_name#39338]
               +- Join Inner, (ss_item_sk#39005 = i_item_sk#39317)
                  :- Project [ss_item_sk#39005, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, d_year#39141, d_year#39169, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307]
                  :  +- Join Inner, (hd_income_band_sk#39281 = ib_income_band_sk#39314)
                  :     :- Project [ss_item_sk#39005, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, d_year#39141, d_year#39169, hd_income_band_sk#39281, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307]
                  :     :  +- Join Inner, (hd_income_band_sk#39276 = ib_income_band_sk#39311)
                  :     :     :- Project [ss_item_sk#39005, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, d_year#39141, d_year#39169, hd_income_band_sk#39276, hd_income_band_sk#39281, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307]
                  :     :     :  +- Join Inner, (c_current_addr_sk#39224 = ca_address_sk#39298)
                  :     :     :     :- Project [ss_item_sk#39005, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_addr_sk#39224, d_year#39141, d_year#39169, hd_income_band_sk#39276, hd_income_band_sk#39281, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294]
                  :     :     :     :  +- Join Inner, (ss_addr_sk#39009 = ca_address_sk#39285)
                  :     :     :     :     :- Project [ss_item_sk#39005, ss_addr_sk#39009, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_addr_sk#39224, d_year#39141, d_year#39169, hd_income_band_sk#39276, hd_income_band_sk#39281]
                  :     :     :     :     :  +- Join Inner, (c_current_hdemo_sk#39223 = hd_demo_sk#39280)
                  :     :     :     :     :     :- Project [ss_item_sk#39005, ss_addr_sk#39009, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169, hd_income_band_sk#39276]
                  :     :     :     :     :     :  +- Join Inner, (ss_hdemo_sk#39008 = hd_demo_sk#39275)
                  :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169]
                  :     :     :     :     :     :     :  +- Join Inner, (ss_promo_sk#39011 = p_promo_sk#39256)
                  :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169]
                  :     :     :     :     :     :     :     :  +- Join Inner, ((c_current_cdemo_sk#39222 = cd_demo_sk#39247) AND NOT (cd_marital_status#39240 = cd_marital_status#39249))
                  :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169, cd_marital_status#39240]
                  :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_cdemo_sk#39007 = cd_demo_sk#39238)
                  :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169]
                  :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_shipto_date_sk#39225 = d_date_sk#39163)
                  :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, c_first_shipto_date_sk#39225, d_year#39141]
                  :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (c_first_sales_date_sk#39226 = d_date_sk#39135)
                  :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, c_first_shipto_date_sk#39225, c_first_sales_date_sk#39226]
                  :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_customer_sk#39006 = c_customer_sk#39220)
                  :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216]
                  :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_store_sk#39010 = s_store_sk#39191)
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_store_sk#39010, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_sold_date_sk#39003 = d_date_sk#39107)
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#39003, ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_store_sk#39010, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, (ss_item_sk#39005 = cs_item_sk#39061)
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#39003, ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_store_sk#39010, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Join Inner, ((ss_item_sk#39005 = sr_item_sk#39028) AND (ss_ticket_number#39012 = sr_ticket_number#39035))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#39003, ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_store_sk#39010, ss_promo_sk#39011, ss_ticket_number#39012, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((isnotnull(ss_item_sk#39005) AND isnotnull(ss_ticket_number#39012)) AND isnotnull(ss_sold_date_sk#39003)) AND (isnotnull(ss_store_sk#39010) AND isnotnull(ss_customer_sk#39006))) AND isnotnull(ss_cdemo_sk#39007)) AND ((isnotnull(ss_promo_sk#39011) AND isnotnull(ss_hdemo_sk#39008)) AND isnotnull(ss_addr_sk#39009)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation spark_catalog.m.store_sales[ss_sold_date_sk#39003,ss_sold_time_sk#39004,ss_item_sk#39005,ss_customer_sk#39006,ss_cdemo_sk#39007,ss_hdemo_sk#39008,ss_addr_sk#39009,ss_store_sk#39010,ss_promo_sk#39011,ss_ticket_number#39012,ss_quantity#39013,ss_wholesale_cost#39014,ss_list_price#39015,ss_sales_price#39016,ss_ext_discount_amt#39017,ss_ext_sales_price#39018,ss_ext_wholesale_cost#39019,ss_ext_list_price#39020,ss_ext_tax#39021,ss_coupon_amt#39022,ss_net_paid#39023,ss_net_paid_inc_tax#39024,ss_net_profit#39025] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [sr_item_sk#39028, sr_ticket_number#39035]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(sr_item_sk#39028) AND isnotnull(sr_ticket_number#39035))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.store_returns[sr_returned_date_sk#39026,sr_return_time_sk#39027,sr_item_sk#39028,sr_customer_sk#39029,sr_cdemo_sk#39030,sr_hdemo_sk#39031,sr_addr_sk#39032,sr_store_sk#39033,sr_reason_sk#39034,sr_ticket_number#39035,sr_return_quantity#39036,sr_return_amt#39037,sr_return_tax#39038,sr_return_amt_inc_tax#39039,sr_fee#39040,sr_return_ship_cost#39041,sr_refunded_cash#39042,sr_reversed_charge#39043,sr_store_credit#39044,sr_net_loss#39045] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [cs_item_sk#39061]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(sale#37231) AND isnotnull(refund#37232)) AND (sale#37231 > (2.0 * refund#37232)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Aggregate [cs_item_sk#39061], [cs_item_sk#39061, sum(cs_ext_list_price#39071) AS sale#37231, sum(((cr_refunded_cash#39103 + cr_reversed_charge#39104) + cr_store_credit#39105)) AS refund#37232]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Project [cs_item_sk#39061, cs_ext_list_price#39071, cr_refunded_cash#39103, cr_reversed_charge#39104, cr_store_credit#39105]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Join Inner, ((cs_item_sk#39061 = cr_item_sk#39082) AND (cs_order_number#39063 = cr_order_number#39096))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :- Project [cs_item_sk#39061, cs_order_number#39063, cs_ext_list_price#39071]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :  +- Filter (isnotnull(cs_item_sk#39061) AND isnotnull(cs_order_number#39063))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    :     +- Relation spark_catalog.m.catalog_sales[cs_sold_date_sk#39046,cs_sold_time_sk#39047,cs_ship_date_sk#39048,cs_bill_customer_sk#39049,cs_bill_cdemo_sk#39050,cs_bill_hdemo_sk#39051,cs_bill_addr_sk#39052,cs_ship_customer_sk#39053,cs_ship_cdemo_sk#39054,cs_ship_hdemo_sk#39055,cs_ship_addr_sk#39056,cs_call_center_sk#39057,cs_catalog_page_sk#39058,cs_ship_mode_sk#39059,cs_warehouse_sk#39060,cs_item_sk#39061,cs_promo_sk#39062,cs_order_number#39063,cs_quantity#39064,cs_wholesale_cost#39065,cs_list_price#39066,cs_sales_price#39067,cs_ext_discount_amt#39068,cs_ext_sales_price#39069,... 10 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- Project [cr_item_sk#39082, cr_order_number#39096, cr_refunded_cash#39103, cr_reversed_charge#39104, cr_store_credit#39105]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Filter (isnotnull(cr_item_sk#39082) AND isnotnull(cr_order_number#39096))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- Relation spark_catalog.m.catalog_returns[cr_returned_date_sk#39080,cr_returned_time_sk#39081,cr_item_sk#39082,cr_refunded_customer_sk#39083,cr_refunded_cdemo_sk#39084,cr_refunded_hdemo_sk#39085,cr_refunded_addr_sk#39086,cr_returning_customer_sk#39087,cr_returning_cdemo_sk#39088,cr_returning_hdemo_sk#39089,cr_returning_addr_sk#39090,cr_call_center_sk#39091,cr_catalog_page_sk#39092,cr_ship_mode_sk#39093,cr_warehouse_sk#39094,cr_reason_sk#39095,cr_order_number#39096,cr_return_quantity#39097,cr_return_amount#39098,cr_return_tax#39099,cr_return_amt_inc_tax#39100,cr_fee#39101,cr_return_ship_cost#39102,cr_refunded_cash#39103,... 3 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#39107, d_year#39113]
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#39113) AND (d_year#39113 = 2001)) AND isnotnull(d_date_sk#39107))
                  :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.date_dim[d_date_sk#39107,d_date_id#39108,d_date#39109,d_month_seq#39110,d_week_seq#39111,d_quarter_seq#39112,d_year#39113,d_dow#39114,d_moy#39115,d_dom#39116,d_qoy#39117,d_fy_year#39118,d_fy_quarter_seq#39119,d_fy_week_seq#39120,d_day_name#39121,d_quarter_name#39122,d_holiday#39123,d_weekend#39124,d_following_holiday#39125,d_first_dom#39126,d_last_dom#39127,d_same_day_ly#39128,d_same_day_lq#39129,d_current_day#39130,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [s_store_sk#39191, s_store_name#39196, s_zip#39216]
                  :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(s_store_sk#39191) AND (isnotnull(s_store_name#39196) AND isnotnull(s_zip#39216)))
                  :     :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.store[s_store_sk#39191,s_store_id#39192,s_rec_start_date#39193,s_rec_end_date#39194,s_closed_date_sk#39195,s_store_name#39196,s_number_employees#39197,s_floor_space#39198,s_hours#39199,s_manager#39200,s_market_id#39201,s_geography_class#39202,s_market_desc#39203,s_market_manager#39204,s_division_id#39205,s_division_name#39206,s_company_id#39207,s_company_name#39208,s_street_number#39209,s_street_name#39210,s_street_type#39211,s_suite_number#39212,s_city#39213,s_county#39214,... 5 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     :     :     +- Project [c_customer_sk#39220, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, c_first_shipto_date_sk#39225, c_first_sales_date_sk#39226]
                  :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(c_customer_sk#39220) AND ((isnotnull(c_first_sales_date_sk#39226) AND isnotnull(c_first_shipto_date_sk#39225)) AND isnotnull(c_current_cdemo_sk#39222))) AND (isnotnull(c_current_hdemo_sk#39223) AND isnotnull(c_current_addr_sk#39224)))
                  :     :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.customer[c_customer_sk#39220,c_customer_id#39221,c_current_cdemo_sk#39222,c_current_hdemo_sk#39223,c_current_addr_sk#39224,c_first_shipto_date_sk#39225,c_first_sales_date_sk#39226,c_salutation#39227,c_first_name#39228,c_last_name#39229,c_preferred_cust_flag#39230,c_birth_day#39231,c_birth_month#39232,c_birth_year#39233,c_birth_country#39234,c_login#39235,c_email_address#39236,c_last_review_date#39237] parquet
                  :     :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#39135, d_year#39141]
                  :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#39135)
                  :     :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.date_dim[d_date_sk#39135,d_date_id#39136,d_date#39137,d_month_seq#39138,d_week_seq#39139,d_quarter_seq#39140,d_year#39141,d_dow#39142,d_moy#39143,d_dom#39144,d_qoy#39145,d_fy_year#39146,d_fy_quarter_seq#39147,d_fy_week_seq#39148,d_day_name#39149,d_quarter_name#39150,d_holiday#39151,d_weekend#39152,d_following_holiday#39153,d_first_dom#39154,d_last_dom#39155,d_same_day_ly#39156,d_same_day_lq#39157,d_current_day#39158,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     :     +- Project [d_date_sk#39163, d_year#39169]
                  :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#39163)
                  :     :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.date_dim[d_date_sk#39163,d_date_id#39164,d_date#39165,d_month_seq#39166,d_week_seq#39167,d_quarter_seq#39168,d_year#39169,d_dow#39170,d_moy#39171,d_dom#39172,d_qoy#39173,d_fy_year#39174,d_fy_quarter_seq#39175,d_fy_week_seq#39176,d_day_name#39177,d_quarter_name#39178,d_holiday#39179,d_weekend#39180,d_following_holiday#39181,d_first_dom#39182,d_last_dom#39183,d_same_day_ly#39184,d_same_day_lq#39185,d_current_day#39186,... 4 more fields] parquet
                  :     :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#39238, cd_marital_status#39240]
                  :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#39238) AND isnotnull(cd_marital_status#39240))
                  :     :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.customer_demographics[cd_demo_sk#39238,cd_gender#39239,cd_marital_status#39240,cd_education_status#39241,cd_purchase_estimate#39242,cd_credit_rating#39243,cd_dep_count#39244,cd_dep_employed_count#39245,cd_dep_college_count#39246] parquet
                  :     :     :     :     :     :     :     :     +- Project [cd_demo_sk#39247, cd_marital_status#39249]
                  :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#39247) AND isnotnull(cd_marital_status#39249))
                  :     :     :     :     :     :     :     :           +- Relation spark_catalog.m.customer_demographics[cd_demo_sk#39247,cd_gender#39248,cd_marital_status#39249,cd_education_status#39250,cd_purchase_estimate#39251,cd_credit_rating#39252,cd_dep_count#39253,cd_dep_employed_count#39254,cd_dep_college_count#39255] parquet
                  :     :     :     :     :     :     :     +- Project [p_promo_sk#39256]
                  :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#39256)
                  :     :     :     :     :     :     :           +- Relation spark_catalog.m.promotion[p_promo_sk#39256,p_promo_id#39257,p_start_date_sk#39258,p_end_date_sk#39259,p_item_sk#39260,p_cost#39261,p_response_target#39262,p_promo_name#39263,p_channel_dmail#39264,p_channel_email#39265,p_channel_catalog#39266,p_channel_tv#39267,p_channel_radio#39268,p_channel_press#39269,p_channel_event#39270,p_channel_demo#39271,p_channel_details#39272,p_purpose#39273,p_discount_active#39274] parquet
                  :     :     :     :     :     :     +- Project [hd_demo_sk#39275, hd_income_band_sk#39276]
                  :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#39275) AND isnotnull(hd_income_band_sk#39276))
                  :     :     :     :     :     :           +- Relation spark_catalog.m.household_demographics[hd_demo_sk#39275,hd_income_band_sk#39276,hd_buy_potential#39277,hd_dep_count#39278,hd_vehicle_count#39279] parquet
                  :     :     :     :     :     +- Project [hd_demo_sk#39280, hd_income_band_sk#39281]
                  :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#39280) AND isnotnull(hd_income_band_sk#39281))
                  :     :     :     :     :           +- Relation spark_catalog.m.household_demographics[hd_demo_sk#39280,hd_income_band_sk#39281,hd_buy_potential#39282,hd_dep_count#39283,hd_vehicle_count#39284] parquet
                  :     :     :     :     +- Project [ca_address_sk#39285, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294]
                  :     :     :     :        +- Filter isnotnull(ca_address_sk#39285)
                  :     :     :     :           +- Relation spark_catalog.m.customer_address[ca_address_sk#39285,ca_address_id#39286,ca_street_number#39287,ca_street_name#39288,ca_street_type#39289,ca_suite_number#39290,ca_city#39291,ca_county#39292,ca_state#39293,ca_zip#39294,ca_country#39295,ca_gmt_offset#39296,ca_location_type#39297] parquet
                  :     :     :     +- Project [ca_address_sk#39298, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307]
                  :     :     :        +- Filter isnotnull(ca_address_sk#39298)
                  :     :     :           +- Relation spark_catalog.m.customer_address[ca_address_sk#39298,ca_address_id#39299,ca_street_number#39300,ca_street_name#39301,ca_street_type#39302,ca_suite_number#39303,ca_city#39304,ca_county#39305,ca_state#39306,ca_zip#39307,ca_country#39308,ca_gmt_offset#39309,ca_location_type#39310] parquet
                  :     :     +- Project [ib_income_band_sk#39311]
                  :     :        +- Filter isnotnull(ib_income_band_sk#39311)
                  :     :           +- Relation spark_catalog.m.income_band[ib_income_band_sk#39311,ib_lower_bound#39312,ib_upper_bound#39313] parquet
                  :     +- Project [ib_income_band_sk#39314]
                  :        +- Filter isnotnull(ib_income_band_sk#39314)
                  :           +- Relation spark_catalog.m.income_band[ib_income_band_sk#39314,ib_lower_bound#39315,ib_upper_bound#39316] parquet
                  +- Project [i_item_sk#39317, i_product_name#39338]
                     +- Filter ((isnotnull(i_current_price#39322) AND ((((i_color#39334 IN (brown,deep,tomato,cornsilk,gainsboro,dodger) AND (i_current_price#39322 >= 22.0)) AND (i_current_price#39322 <= 32.0)) AND (i_current_price#39322 >= 23.0)) AND (i_current_price#39322 <= 37.0))) AND isnotnull(i_item_sk#39317))
                        +- Relation spark_catalog.m.item[i_item_sk#39317,i_item_id#39318,i_rec_start_date#39319,i_rec_end_date#39320,i_item_desc#39321,i_current_price#39322,i_wholesale_cost#39323,i_brand_id#39324,i_brand#39325,i_class_id#39326,i_class#39327,i_category_id#39328,i_category#39329,i_manufact_id#39330,i_manufact#39331,i_size#39332,i_formulation#39333,i_color#39334,i_units#39335,i_container#39336,i_manager_id#39337,i_product_name#39338] parquet

== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Project [product_name#37233, store_name#37235, store_zip#37236, b_street_number#37237, b_street_name#37238, b_city#37239, b_zip#37240, c_street_number#37241, c_street_name#37242, c_city#37243, c_zip#37244, syear#37245, cnt#37248L, s11#37225, s21#37226, s31#37227, s12#37228, s22#37229, s32#37230, syear#37368, cnt#37371L]
   +- Sort [product_name#37233 ASC NULLS FIRST, store_name#37235 ASC NULLS FIRST, cnt#37371L ASC NULLS FIRST, s1#37249 ASC NULLS FIRST, s1#37372 ASC NULLS FIRST], true, 0
      +- Exchange rangepartitioning(product_name#37233 ASC NULLS FIRST, store_name#37235 ASC NULLS FIRST, cnt#37371L ASC NULLS FIRST, s1#37249 ASC NULLS FIRST, s1#37372 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [plan_id=130992]
         +- Project [product_name#37233, store_name#37235, store_zip#37236, b_street_number#37237, b_street_name#37238, b_city#37239, b_zip#37240, c_street_number#37241, c_street_name#37242, c_city#37243, c_zip#37244, syear#37245, cnt#37248L, s1#37249 AS s11#37225, s2#37250 AS s21#37226, s3#37251 AS s31#37227, s1#37372 AS s12#37228, s2#37373 AS s22#37229, s3#37374 AS s32#37230, syear#37368, cnt#37371L, s1#37249, s1#37372]
            +- SortMergeJoin [item_sk#37234, store_name#37235, store_zip#37236], [item_sk#37357, store_name#37358, store_zip#37359], Inner, (cnt#37371L <= cnt#37248L)
               :- Sort [item_sk#37234 ASC NULLS FIRST, store_name#37235 ASC NULLS FIRST, store_zip#37236 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(item_sk#37234, store_name#37235, store_zip#37236, 200), ENSURE_REQUIREMENTS, [plan_id=130985]
               :     +- HashAggregate(keys=[i_product_name#1292, i_item_sk#1271, s_store_name#57, s_zip#77, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335, d_year#30, d_year#37262, d_year#37290], functions=[count(1), sum(ss_wholesale_cost#1259), sum(ss_list_price#1260), sum(ss_coupon_amt#1267)], output=[product_name#37233, item_sk#37234, store_name#37235, store_zip#37236, b_street_number#37237, b_street_name#37238, b_city#37239, b_zip#37240, c_street_number#37241, c_street_name#37242, c_city#37243, c_zip#37244, syear#37245, cnt#37248L, s1#37249, s2#37250, s3#37251])
               :        +- HashAggregate(keys=[i_product_name#1292, i_item_sk#1271, s_store_name#57, s_zip#77, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335, d_year#30, d_year#37262, d_year#37290], functions=[partial_count(1), partial_sum(ss_wholesale_cost#1259), partial_sum(ss_list_price#1260), partial_sum(ss_coupon_amt#1267)], output=[i_product_name#1292, i_item_sk#1271, s_store_name#57, s_zip#77, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335, d_year#30, d_year#37262, d_year#37290, count#38883L, sum#38884, sum#38885, sum#38886])
               :           +- Project [ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, d_year#37262, d_year#37290, s_store_name#57, s_zip#77, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335, i_item_sk#1271, i_product_name#1292]
               :              +- BroadcastHashJoin [ss_item_sk#1250], [i_item_sk#1271], Inner, BuildRight, false
               :                 :- Project [ss_item_sk#1250, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, d_year#37262, d_year#37290, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335]
               :                 :  +- BroadcastHashJoin [hd_income_band_sk#37322], [ib_income_band_sk#37339], Inner, BuildRight, false
               :                 :     :- Project [ss_item_sk#1250, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, d_year#37262, d_year#37290, hd_income_band_sk#37322, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335]
               :                 :     :  +- BroadcastHashJoin [hd_income_band_sk#12111], [ib_income_band_sk#37253], Inner, BuildRight, false
               :                 :     :     :- Project [ss_item_sk#1250, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, d_year#37262, d_year#37290, hd_income_band_sk#12111, hd_income_band_sk#37322, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180, ca_street_number#37328, ca_street_name#37329, ca_city#37332, ca_zip#37335]
               :                 :     :     :  +- BroadcastHashJoin [c_current_addr_sk#85], [ca_address_sk#37326], Inner, BuildRight, false
               :                 :     :     :     :- Project [ss_item_sk#1250, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_addr_sk#85, d_year#37262, d_year#37290, hd_income_band_sk#12111, hd_income_band_sk#37322, ca_street_number#8173, ca_street_name#8174, ca_city#8177, ca_zip#8180]
               :                 :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#1254], [ca_address_sk#8171], Inner, BuildRight, false
               :                 :     :     :     :     :- Project [ss_item_sk#1250, ss_addr_sk#1254, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_addr_sk#85, d_year#37262, d_year#37290, hd_income_band_sk#12111, hd_income_band_sk#37322]
               :                 :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#84], [hd_demo_sk#37321], Inner, BuildRight, false
               :                 :     :     :     :     :     :- Project [ss_item_sk#1250, ss_addr_sk#1254, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290, hd_income_band_sk#12111]
               :                 :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#1253], [hd_demo_sk#12110], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290]
               :                 :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#1256], [p_promo_sk#8275], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290]
               :                 :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#83], [cd_demo_sk#37312], Inner, BuildRight, NOT (cd_marital_status#8268 = cd_marital_status#37314), false
               :                 :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290, cd_marital_status#8268]
               :                 :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#1252], [cd_demo_sk#8266], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, d_year#37262, d_year#37290]
               :                 :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#86], [d_date_sk#37284], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, c_first_shipto_date_sk#86, d_year#37262]
               :                 :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#87], [d_date_sk#37256], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77, c_current_cdemo_sk#83, c_current_hdemo_sk#84, c_current_addr_sk#85, c_first_shipto_date_sk#86, c_first_sales_date_sk#87]
               :                 :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#1251], [c_customer_sk#81], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30, s_store_name#57, s_zip#77]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#1255], [s_store_sk#52], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_store_sk#1255, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267, d_year#30]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#1248], [d_date_sk#24], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#1248, ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_store_sk#1255, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#1250], [cs_item_sk#476], Inner
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Sort [ss_item_sk#1250 ASC NULLS FIRST], false, 0
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_item_sk#1250, 200), ENSURE_REQUIREMENTS, [plan_id=130835]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [ss_sold_date_sk#1248, ss_item_sk#1250, ss_customer_sk#1251, ss_cdemo_sk#1252, ss_hdemo_sk#1253, ss_addr_sk#1254, ss_store_sk#1255, ss_promo_sk#1256, ss_wholesale_cost#1259, ss_list_price#1260, ss_coupon_amt#1267]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- BroadcastHashJoin [ss_item_sk#1250, ss_ticket_number#1257], [sr_item_sk#6, sr_ticket_number#13], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :- Filter ((((((((isnotnull(ss_item_sk#1250) AND isnotnull(ss_ticket_number#1257)) AND isnotnull(ss_sold_date_sk#1248)) AND isnotnull(ss_store_sk#1255)) AND isnotnull(ss_customer_sk#1251)) AND isnotnull(ss_cdemo_sk#1252)) AND isnotnull(ss_promo_sk#1256)) AND isnotnull(ss_hdemo_sk#1253)) AND isnotnull(ss_addr_sk#1254))
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#1248,ss_item_sk#1250,ss_customer_sk#1251,ss_cdemo_sk#1252,ss_hdemo_sk#1253,ss_addr_sk#1254,ss_store_sk#1255,ss_promo_sk#1256,ss_ticket_number#1257,ss_wholesale_cost#1259,ss_list_price#1260,ss_coupon_amt#1267] Batched: true, DataFilters: [isnotnull(ss_item_sk#1250), isnotnull(ss_ticket_number#1257), isnotnull(ss_sold_date_sk#1248), i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=130821]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter (isnotnull(sr_item_sk#6) AND isnotnull(sr_ticket_number#13))
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet spark_catalog.m.store_returns[sr_item_sk#6,sr_ticket_number#13] Batched: true, DataFilters: [isnotnull(sr_item_sk#6), isnotnull(sr_ticket_number#13)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int>
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Sort [cs_item_sk#476 ASC NULLS FIRST], false, 0
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Project [cs_item_sk#476]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Filter ((isnotnull(sale#37231) AND isnotnull(refund#37232)) AND (sale#37231 > (2.0 * refund#37232)))
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#476], functions=[sum(cs_ext_list_price#486), sum(((cr_refunded_cash#7834 + cr_reversed_charge#7835) + cr_store_credit#7836))], output=[cs_item_sk#476, sale#37231, refund#37232])
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Exchange hashpartitioning(cs_item_sk#476, 200), ENSURE_REQUIREMENTS, [plan_id=130829]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- HashAggregate(keys=[cs_item_sk#476], functions=[partial_sum(cs_ext_list_price#486), partial_sum(((cr_refunded_cash#7834 + cr_reversed_charge#7835) + cr_store_credit#7836))], output=[cs_item_sk#476, sum#38889, sum#38890])
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cs_item_sk#476, cs_ext_list_price#486, cr_refunded_cash#7834, cr_reversed_charge#7835, cr_store_credit#7836]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- BroadcastHashJoin [cs_item_sk#476, cs_order_number#478], [cr_item_sk#7813, cr_order_number#7827], Inner, BuildRight, false
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :- Filter (isnotnull(cs_item_sk#476) AND isnotnull(cs_order_number#478))
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :  +- FileScan parquet spark_catalog.m.catalog_sales[cs_item_sk#476,cs_order_number#478,cs_ext_list_price#486] Batched: true, DataFilters: [isnotnull(cs_item_sk#476), isnotnull(cs_order_number#478)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:double>
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=130824]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- Filter (isnotnull(cr_item_sk#7813) AND isnotnull(cr_order_number#7827))
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- FileScan parquet spark_catalog.m.catalog_returns[cr_item_sk#7813,cr_order_number#7827,cr_refunded_cash#7834,cr_reversed_charge#7835,cr_store_credit#7836] Batched: true, DataFilters: [isnotnull(cr_item_sk#7813), isnotnull(cr_order_number#7827)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:double,cr_reversed_charge:double,cr_st...
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130841]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#30) AND (d_year#30 = 2000)) AND isnotnull(d_date_sk#24))
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#24,d_year#30] Batched: true, DataFilters: [isnotnull(d_year#30), (d_year#30 = 2000), isnotnull(d_date_sk#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130845]
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#52) AND isnotnull(s_store_name#57)) AND isnotnull(s_zip#77))
               :                 :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.store[s_store_sk#52,s_store_name#57,s_zip#77] Batched: true, DataFilters: [isnotnull(s_store_sk#52), isnotnull(s_store_name#57), isnotnull(s_zip#77)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
               :                 :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130849]
               :                 :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#81) AND isnotnull(c_first_sales_date_sk#87)) AND isnotnull(c_first_shipto_date_sk#86)) AND isnotnull(c_current_cdemo_sk#83)) AND isnotnull(c_current_hdemo_sk#84)) AND isnotnull(c_current_addr_sk#85))
               :                 :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.customer[c_customer_sk#81,c_current_cdemo_sk#83,c_current_hdemo_sk#84,c_current_addr_sk#85,c_first_shipto_date_sk#86,c_first_sales_date_sk#87] Batched: true, DataFilters: [isnotnull(c_customer_sk#81), isnotnull(c_first_sales_date_sk#87), isnotnull(c_first_shipto_date_..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
               :                 :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130853]
               :                 :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#37256)
               :                 :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#37256,d_year#37262] Batched: true, DataFilters: [isnotnull(d_date_sk#37256)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130857]
               :                 :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#37284)
               :                 :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#37284,d_year#37290] Batched: true, DataFilters: [isnotnull(d_date_sk#37284)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130861]
               :                 :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#8266) AND isnotnull(cd_marital_status#8268))
               :                 :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.customer_demographics[cd_demo_sk#8266,cd_marital_status#8268] Batched: true, DataFilters: [isnotnull(cd_demo_sk#8266), isnotnull(cd_marital_status#8268)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer_demograph..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                 :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130865]
               :                 :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#37312) AND isnotnull(cd_marital_status#37314))
               :                 :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.customer_demographics[cd_demo_sk#37312,cd_marital_status#37314] Batched: true, DataFilters: [isnotnull(cd_demo_sk#37312), isnotnull(cd_marital_status#37314)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer_demograph..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                 :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130869]
               :                 :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#8275)
               :                 :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.promotion[p_promo_sk#8275] Batched: true, DataFilters: [isnotnull(p_promo_sk#8275)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
               :                 :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130873]
               :                 :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#12110) AND isnotnull(hd_income_band_sk#12111))
               :                 :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.household_demographics[hd_demo_sk#12110,hd_income_band_sk#12111] Batched: true, DataFilters: [isnotnull(hd_demo_sk#12110), isnotnull(hd_income_band_sk#12111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/household_demograp..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                 :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130877]
               :                 :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#37321) AND isnotnull(hd_income_band_sk#37322))
               :                 :     :     :     :     :           +- FileScan parquet spark_catalog.m.household_demographics[hd_demo_sk#37321,hd_income_band_sk#37322] Batched: true, DataFilters: [isnotnull(hd_demo_sk#37321), isnotnull(hd_income_band_sk#37322)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/household_demograp..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                 :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130881]
               :                 :     :     :     :        +- Filter isnotnull(ca_address_sk#8171)
               :                 :     :     :     :           +- FileScan parquet spark_catalog.m.customer_address[ca_address_sk#8171,ca_street_number#8173,ca_street_name#8174,ca_city#8177,ca_zip#8180] Batched: true, DataFilters: [isnotnull(ca_address_sk#8171)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                 :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130885]
               :                 :     :     :        +- Filter isnotnull(ca_address_sk#37326)
               :                 :     :     :           +- FileScan parquet spark_catalog.m.customer_address[ca_address_sk#37326,ca_street_number#37328,ca_street_name#37329,ca_city#37332,ca_zip#37335] Batched: true, DataFilters: [isnotnull(ca_address_sk#37326)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130889]
               :                 :     :        +- Filter isnotnull(ib_income_band_sk#37253)
               :                 :     :           +- FileScan parquet spark_catalog.m.income_band[ib_income_band_sk#37253] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#37253)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130893]
               :                 :        +- Filter isnotnull(ib_income_band_sk#37339)
               :                 :           +- FileScan parquet spark_catalog.m.income_band[ib_income_band_sk#37339] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#37339)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=130897]
               :                    +- Project [i_item_sk#1271, i_product_name#1292]
               :                       +- Filter ((((((isnotnull(i_current_price#1276) AND i_color#1288 IN (brown,deep,tomato,cornsilk,gainsboro,dodger)) AND (i_current_price#1276 >= 22.0)) AND (i_current_price#1276 <= 32.0)) AND (i_current_price#1276 >= 23.0)) AND (i_current_price#1276 <= 37.0)) AND isnotnull(i_item_sk#1271))
               :                          +- FileScan parquet spark_catalog.m.item[i_item_sk#1271,i_current_price#1276,i_color#1288,i_product_name#1292] Batched: true, DataFilters: [isnotnull(i_current_price#1276), i_color#1288 IN (brown,deep,tomato,cornsilk,gainsboro,dodger), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [brown,cornsilk,deep,dodger,gainsboro,tomato]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:double,i_color:string,i_product_name:string>
               +- Sort [item_sk#37357 ASC NULLS FIRST, store_name#37358 ASC NULLS FIRST, store_zip#37359 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(item_sk#37357, store_name#37358, store_zip#37359, 200), ENSURE_REQUIREMENTS, [plan_id=130986]
                     +- HashAggregate(keys=[i_product_name#39338, i_item_sk#39317, s_store_name#39196, s_zip#39216, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307, d_year#39113, d_year#39141, d_year#39169], functions=[count(1), sum(ss_wholesale_cost#39014), sum(ss_list_price#39015), sum(ss_coupon_amt#39022)], output=[item_sk#37357, store_name#37358, store_zip#37359, syear#37368, cnt#37371L, s1#37372, s2#37373, s3#37374])
                        +- HashAggregate(keys=[i_product_name#39338, i_item_sk#39317, s_store_name#39196, s_zip#39216, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307, d_year#39113, d_year#39141, d_year#39169], functions=[partial_count(1), partial_sum(ss_wholesale_cost#39014), partial_sum(ss_list_price#39015), partial_sum(ss_coupon_amt#39022)], output=[i_product_name#39338, i_item_sk#39317, s_store_name#39196, s_zip#39216, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307, d_year#39113, d_year#39141, d_year#39169, count#38883L, sum#39361, sum#39362, sum#39363])
                           +- Project [ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, d_year#39141, d_year#39169, s_store_name#39196, s_zip#39216, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307, i_item_sk#39317, i_product_name#39338]
                              +- BroadcastHashJoin [ss_item_sk#39005], [i_item_sk#39317], Inner, BuildRight, false
                                 :- Project [ss_item_sk#39005, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, d_year#39141, d_year#39169, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307]
                                 :  +- BroadcastHashJoin [hd_income_band_sk#39281], [ib_income_band_sk#39314], Inner, BuildRight, false
                                 :     :- Project [ss_item_sk#39005, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, d_year#39141, d_year#39169, hd_income_band_sk#39281, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307]
                                 :     :  +- BroadcastHashJoin [hd_income_band_sk#39276], [ib_income_band_sk#39311], Inner, BuildRight, false
                                 :     :     :- Project [ss_item_sk#39005, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, d_year#39141, d_year#39169, hd_income_band_sk#39276, hd_income_band_sk#39281, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294, ca_street_number#39300, ca_street_name#39301, ca_city#39304, ca_zip#39307]
                                 :     :     :  +- BroadcastHashJoin [c_current_addr_sk#39224], [ca_address_sk#39298], Inner, BuildRight, false
                                 :     :     :     :- Project [ss_item_sk#39005, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_addr_sk#39224, d_year#39141, d_year#39169, hd_income_band_sk#39276, hd_income_band_sk#39281, ca_street_number#39287, ca_street_name#39288, ca_city#39291, ca_zip#39294]
                                 :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#39009], [ca_address_sk#39285], Inner, BuildRight, false
                                 :     :     :     :     :- Project [ss_item_sk#39005, ss_addr_sk#39009, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_addr_sk#39224, d_year#39141, d_year#39169, hd_income_band_sk#39276, hd_income_band_sk#39281]
                                 :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#39223], [hd_demo_sk#39280], Inner, BuildRight, false
                                 :     :     :     :     :     :- Project [ss_item_sk#39005, ss_addr_sk#39009, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169, hd_income_band_sk#39276]
                                 :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#39008], [hd_demo_sk#39275], Inner, BuildRight, false
                                 :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169]
                                 :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#39011], [p_promo_sk#39256], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169]
                                 :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#39222], [cd_demo_sk#39247], Inner, BuildRight, NOT (cd_marital_status#39240 = cd_marital_status#39249), false
                                 :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169, cd_marital_status#39240]
                                 :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#39007], [cd_demo_sk#39238], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, d_year#39141, d_year#39169]
                                 :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#39225], [d_date_sk#39163], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, c_first_shipto_date_sk#39225, d_year#39141]
                                 :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#39226], [d_date_sk#39135], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216, c_current_cdemo_sk#39222, c_current_hdemo_sk#39223, c_current_addr_sk#39224, c_first_shipto_date_sk#39225, c_first_sales_date_sk#39226]
                                 :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_customer_sk#39006], [c_customer_sk#39220], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113, s_store_name#39196, s_zip#39216]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_store_sk#39010], [s_store_sk#39191], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_store_sk#39010, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022, d_year#39113]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_sold_date_sk#39003], [d_date_sk#39107], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_sold_date_sk#39003, ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_store_sk#39010, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_item_sk#39005], [cs_item_sk#39061], Inner
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Sort [ss_item_sk#39005 ASC NULLS FIRST], false, 0
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_item_sk#39005, 200), ENSURE_REQUIREMENTS, [plan_id=130916]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [ss_sold_date_sk#39003, ss_item_sk#39005, ss_customer_sk#39006, ss_cdemo_sk#39007, ss_hdemo_sk#39008, ss_addr_sk#39009, ss_store_sk#39010, ss_promo_sk#39011, ss_wholesale_cost#39014, ss_list_price#39015, ss_coupon_amt#39022]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- BroadcastHashJoin [ss_item_sk#39005, ss_ticket_number#39012], [sr_item_sk#39028, sr_ticket_number#39035], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :- Filter ((((((((isnotnull(ss_item_sk#39005) AND isnotnull(ss_ticket_number#39012)) AND isnotnull(ss_sold_date_sk#39003)) AND isnotnull(ss_store_sk#39010)) AND isnotnull(ss_customer_sk#39006)) AND isnotnull(ss_cdemo_sk#39007)) AND isnotnull(ss_promo_sk#39011)) AND isnotnull(ss_hdemo_sk#39008)) AND isnotnull(ss_addr_sk#39009))
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- FileScan parquet spark_catalog.m.store_sales[ss_sold_date_sk#39003,ss_item_sk#39005,ss_customer_sk#39006,ss_cdemo_sk#39007,ss_hdemo_sk#39008,ss_addr_sk#39009,ss_store_sk#39010,ss_promo_sk#39011,ss_ticket_number#39012,ss_wholesale_cost#39014,ss_list_price#39015,ss_coupon_amt#39022] Batched: true, DataFilters: [isnotnull(ss_item_sk#39005), isnotnull(ss_ticket_number#39012), isnotnull(ss_sold_date_sk#39003)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_sales], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=130902]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter (isnotnull(sr_item_sk#39028) AND isnotnull(sr_ticket_number#39035))
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet spark_catalog.m.store_returns[sr_item_sk#39028,sr_ticket_number#39035] Batched: true, DataFilters: [isnotnull(sr_item_sk#39028), isnotnull(sr_ticket_number#39035)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store_returns], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:int>
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Sort [cs_item_sk#39061 ASC NULLS FIRST], false, 0
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Project [cs_item_sk#39061]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Filter ((isnotnull(sale#37231) AND isnotnull(refund#37232)) AND (sale#37231 > (2.0 * refund#37232)))
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- HashAggregate(keys=[cs_item_sk#39061], functions=[sum(cs_ext_list_price#39071), sum(((cr_refunded_cash#39103 + cr_reversed_charge#39104) + cr_store_credit#39105))], output=[cs_item_sk#39061, sale#37231, refund#37232])
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- Exchange hashpartitioning(cs_item_sk#39061, 200), ENSURE_REQUIREMENTS, [plan_id=130910]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- HashAggregate(keys=[cs_item_sk#39061], functions=[partial_sum(cs_ext_list_price#39071), partial_sum(((cr_refunded_cash#39103 + cr_reversed_charge#39104) + cr_store_credit#39105))], output=[cs_item_sk#39061, sum#39366, sum#39367])
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- Project [cs_item_sk#39061, cs_ext_list_price#39071, cr_refunded_cash#39103, cr_reversed_charge#39104, cr_store_credit#39105]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- BroadcastHashJoin [cs_item_sk#39061, cs_order_number#39063], [cr_item_sk#39082, cr_order_number#39096], Inner, BuildRight, false
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :- Filter (isnotnull(cs_item_sk#39061) AND isnotnull(cs_order_number#39063))
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             :  +- FileScan parquet spark_catalog.m.catalog_sales[cs_item_sk#39061,cs_order_number#39063,cs_ext_list_price#39071] Batched: true, DataFilters: [isnotnull(cs_item_sk#39061), isnotnull(cs_order_number#39063)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_sales], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:int,cs_ext_list_price:double>
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=130905]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- Filter (isnotnull(cr_item_sk#39082) AND isnotnull(cr_order_number#39096))
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- FileScan parquet spark_catalog.m.catalog_returns[cr_item_sk#39082,cr_order_number#39096,cr_refunded_cash#39103,cr_reversed_charge#39104,cr_store_credit#39105] Batched: true, DataFilters: [isnotnull(cr_item_sk#39082), isnotnull(cr_order_number#39096)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/catalog_returns], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:int,cr_refunded_cash:double,cr_reversed_charge:double,cr_st...
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130922]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(d_year#39113) AND (d_year#39113 = 2001)) AND isnotnull(d_date_sk#39107))
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#39107,d_year#39113] Batched: true, DataFilters: [isnotnull(d_year#39113), (d_year#39113 = 2001), isnotnull(d_date_sk#39107)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130926]
                                 :     :     :     :     :     :     :     :     :     :     :     :     :        +- Filter ((isnotnull(s_store_sk#39191) AND isnotnull(s_store_name#39196)) AND isnotnull(s_zip#39216))
                                 :     :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.store[s_store_sk#39191,s_store_name#39196,s_zip#39216] Batched: true, DataFilters: [isnotnull(s_store_sk#39191), isnotnull(s_store_name#39196), isnotnull(s_zip#39216)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/store], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                                 :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130930]
                                 :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(c_customer_sk#39220) AND isnotnull(c_first_sales_date_sk#39226)) AND isnotnull(c_first_shipto_date_sk#39225)) AND isnotnull(c_current_cdemo_sk#39222)) AND isnotnull(c_current_hdemo_sk#39223)) AND isnotnull(c_current_addr_sk#39224))
                                 :     :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.customer[c_customer_sk#39220,c_current_cdemo_sk#39222,c_current_hdemo_sk#39223,c_current_addr_sk#39224,c_first_shipto_date_sk#39225,c_first_sales_date_sk#39226] Batched: true, DataFilters: [isnotnull(c_customer_sk#39220), isnotnull(c_first_sales_date_sk#39226), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                                 :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130934]
                                 :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#39135)
                                 :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#39135,d_year#39141] Batched: true, DataFilters: [isnotnull(d_date_sk#39135)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130938]
                                 :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#39163)
                                 :     :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.date_dim[d_date_sk#39163,d_year#39169] Batched: true, DataFilters: [isnotnull(d_date_sk#39163)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/date_dim], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130942]
                                 :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#39238) AND isnotnull(cd_marital_status#39240))
                                 :     :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.customer_demographics[cd_demo_sk#39238,cd_marital_status#39240] Batched: true, DataFilters: [isnotnull(cd_demo_sk#39238), isnotnull(cd_marital_status#39240)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer_demograph..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                 :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130946]
                                 :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#39247) AND isnotnull(cd_marital_status#39249))
                                 :     :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.customer_demographics[cd_demo_sk#39247,cd_marital_status#39249] Batched: true, DataFilters: [isnotnull(cd_demo_sk#39247), isnotnull(cd_marital_status#39249)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer_demograph..., PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                 :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130950]
                                 :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#39256)
                                 :     :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.promotion[p_promo_sk#39256] Batched: true, DataFilters: [isnotnull(p_promo_sk#39256)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/promotion], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                                 :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130954]
                                 :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#39275) AND isnotnull(hd_income_band_sk#39276))
                                 :     :     :     :     :     :           +- FileScan parquet spark_catalog.m.household_demographics[hd_demo_sk#39275,hd_income_band_sk#39276] Batched: true, DataFilters: [isnotnull(hd_demo_sk#39275), isnotnull(hd_income_band_sk#39276)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/household_demograp..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                 :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130958]
                                 :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#39280) AND isnotnull(hd_income_band_sk#39281))
                                 :     :     :     :     :           +- FileScan parquet spark_catalog.m.household_demographics[hd_demo_sk#39280,hd_income_band_sk#39281] Batched: true, DataFilters: [isnotnull(hd_demo_sk#39280), isnotnull(hd_income_band_sk#39281)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/household_demograp..., PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                 :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130962]
                                 :     :     :     :        +- Filter isnotnull(ca_address_sk#39285)
                                 :     :     :     :           +- FileScan parquet spark_catalog.m.customer_address[ca_address_sk#39285,ca_street_number#39287,ca_street_name#39288,ca_city#39291,ca_zip#39294] Batched: true, DataFilters: [isnotnull(ca_address_sk#39285)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                 :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130966]
                                 :     :     :        +- Filter isnotnull(ca_address_sk#39298)
                                 :     :     :           +- FileScan parquet spark_catalog.m.customer_address[ca_address_sk#39298,ca_street_number#39300,ca_street_name#39301,ca_city#39304,ca_zip#39307] Batched: true, DataFilters: [isnotnull(ca_address_sk#39298)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/customer_address], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                 :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130970]
                                 :     :        +- Filter isnotnull(ib_income_band_sk#39311)
                                 :     :           +- FileScan parquet spark_catalog.m.income_band[ib_income_band_sk#39311] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#39311)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=130974]
                                 :        +- Filter isnotnull(ib_income_band_sk#39314)
                                 :           +- FileScan parquet spark_catalog.m.income_band[ib_income_band_sk#39314] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#39314)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/income_band], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                 +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=130978]
                                    +- Project [i_item_sk#39317, i_product_name#39338]
                                       +- Filter ((((((isnotnull(i_current_price#39322) AND i_color#39334 IN (brown,deep,tomato,cornsilk,gainsboro,dodger)) AND (i_current_price#39322 >= 22.0)) AND (i_current_price#39322 <= 32.0)) AND (i_current_price#39322 >= 23.0)) AND (i_current_price#39322 <= 37.0)) AND isnotnull(i_item_sk#39317))
                                          +- FileScan parquet spark_catalog.m.item[i_item_sk#39317,i_current_price#39322,i_color#39334,i_product_name#39338] Batched: true, DataFilters: [isnotnull(i_current_price#39322), i_color#39334 IN (brown,deep,tomato,cornsilk,gainsboro,dodger)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[hdfs://gros-121:9000/usr/spark/spark-warehouse/m.db/item], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [brown,cornsilk,deep,dodger,gainsboro,tomato]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:double,i_color:string,i_product_name:string>
